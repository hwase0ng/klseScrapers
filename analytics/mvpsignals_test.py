
'''
Created on Nov 15, 2018

@author: hwase0ng
'''

from analytics.mvpsignals import scanSignals
import pytest
import settings as S
from common import loadCfg
from utils.fileutils import loadfromjson


def setup_module():
    loadCfg(S.DATA_DIR)


def loadjson(counter, cdate):
    sdict = loadfromjson('data', counter, cdate)
    return sdict


@pytest.mark.parametrize("counter,tdate,expected", [
    ("AXREIT", "2018-03-09", "AXREIT,BBS,1.6,0.0.0.0,(c0.m0.p0.v2),(3.3.3.0^9.8.7^0.0.4^1.0.0.o.1),(^),1.22"),
    ("CARLSBG", "2008-10-24", "CARLSBG,BBS,13.20,0.0.0.0,(c0.m2.p0.v2),(3.0.3.0^8.0.0^0.0.0^3.0.0),(0.0.2^0.1.0),3.44"),
    ("CARLSBG", "2014-10-03", "CARLSBG,TSS,-13.50,0.0.0.0,(c0.m2.p2.v2),(3.0.0.0^4.0.5^0.0.0^0.0.0),(0.0.0^0.1.0),11.80"),
    ("CARLSBG", "2014-11-04", "CARLSBG,BBS,13.50,0.0.0.0,(c0.m2.p2.v2),(3.0.0.0^4.0.7^0.0.0^0.0.0),(0.0.0^0.2.0),10.82"),
    # ("DANCO", "2018-03-08", "DANCO,TSS,-1.-2,0.0.0.0,(c0.m2.p2.v2),(3.4.0.0^4.5.7^0.0.9^0.1.0.r.0),(^),0.39"),
    # ("DANCO", "2018-03-22", "DANCO,TSS,-11.-2,0.0.0.0,(c0.m2.p2.v2),(3.4.0.0^4.5.7^0.0.9^0.1.0),(0.0.1^0.2.0),0.37"),
    ("DANCO", "2018-06-22", "DANCO,BBS,1.12,0.0.0.0,(c0.m2.p2.v2),(3.0.0.0^0.7.7^0.0.0^0.2.0.r.1),(^),0.37"),
    ("DUFU", "2014-03-07", "DUFU,BBS,10.1,0.0.0.0,(c0.m3.p2.v2),(3.0.0.0^9.7.0^0.0.0^6.0.0),(0.0.0^1.1.1),0.13"),
    ("F&N", "2014-09-18", "F&N,TSS,-14.1,0.0.0.0,(c0.m1.p0.v2),(3.0.3.2^0.6.8^0.0.0^0.0.0),(0.0.0^0.2.0),16.80"),
    ("F&N", "2014-09-26", "F&N,TSS,-13.1,0.0.0.0,(c0.m0.p0.v2),(3.3.3.2^0.6.8^0.0.0^0.2.0),(0.0.0^0.2.0),16.90"),
    ("F&N", "2014-10-02", "F&N,BBS,11.-1,0.0.0.0,(c0.m2.p0.v2),(3.4.3.2^8.6.8^0.0.0^0.3.0),(0.0.0^0.2.0),16.88"),
    ("F&N", "2014-10-16", "F&N,BBS,11.1,0.0.0.0,(c0.m2.p0.v3),(3.4.3.0^8.6.0^0.0.0^0.3.6),(0.0.0^0.2.0),15.68"),
    ("F&N", "2014-11-03", "F&N,BBS,14.1,0.0.0.0,(c0.m1.p0.v2),(3.0.3.0^6.6.0^0.5.0^0.3.6),(0.0.0^0.2.0),15.98"),
    ("F&N", "2014-11-04", "F&N,BBS,14.1,0.0.0.0,(c0.m2.p0.v2),(3.0.3.0^6.6.0^0.5.0^0.3.6),(0.0.0^0.2.0),15.98"),
    ("KESM", "2019-01-02", "KESM,BBS,11.5,0.0.0.0,(c0.m2.p2.v1),(3.0.4.2^0.1.0^0.0.0^0.0.7),(1.0.0^0.0.0),7.50"),
    ("KESM", "2019-01-03", "KESM,BBS,12.25,0.0.0.0,(c0.m2.p2.v1),(3.0.4.2^0.1.0^0.0.0^0.0.7),(1.0.0^0.0.0),7.50"),
    ("KLSE", "2008-10-06", "KLSE,TSS,-13.5,0.0.0.0,(c0.m0.p2.v2),(3.3.0.0^0.4.4^0.0.0^0.0.7),(1.0.0^0.0.0),996.84"),
    ("KLSE", "2009-03-18", "KLSE,BBS,1.8,0.0.0.0,(c0.m0.p2.v2),(3.3.0.0^0.0.0^0.0.0^0.0.0.l.2),(^),847.96"),
    ("KLSE", "2015-08-21", "KLSE,BBS,14.3,0.0.0.0,(c0.m1.p0.v4),(3.0.3.1^8.4.6^0.0.0^0.0.0),(0.0.0^0.2.0),1574.67"),
    ("KLSE", "2015-09-08", "KLSE,TSS,-14.-2,0.0.0.0,(c0.m2.p0.v3),(3.0.3.2^0.4.8^0.0.0^0.0.6),(0.0.0^0.2.0),1587.12"),
    ("N2N", "2009-04-01", "N2N,BBS,16.1,0.0.0.0,(c0.m2.p2.v4),(3.0.2.1^7.1.4^0.0.0^0.0.0),(0.0.0^0.0.1),0.21"),
])
@pytest.mark.lowC
def test_lowC_success(counter, tdate, expected):
    result = scanSignals("", 0, counter, loadjson(counter, tdate), 0)
    result, expected = matchpartial(result, expected, 2)
    assert result == expected, "*** Input = " + counter + "," + tdate


@pytest.mark.parametrize("counter,tdate,expected", [
    ("CARLSBG", "2014-02-25", "CARLSBG,BBS,20.-1,0.0.0.0,(c2.m2.p2.v2),(0.0.0.0^4.2.0^0.0.3^0.0.0),(0.2.0^0.0.0),13.18"),
    ("CARLSBG", "2014-03-27", "CARLSBG,BBS,-20.-1,0.0.0.0,(c2.m2.p2.v1),(0.0.0.0^4.2.0^0.0.3^0.0.0),(0.0.0^0.0.0),12.62"),
    ("CARLSBG", "2014-08-04", "CARLSBG,TSS,-26.1,0.0.0.0,(c1.m2.p2.v4),(0.0.0.1^0.0.4^0.0.0^0.0.0),(0.2.0^0.0.0),11.94"),
    ("CARLSBG", "2014-12-02", "CARLSBG,BBS,21.2,0.0.0.0,(c1.m4.p2.v2),(4.1.0.0^4.0.7^1.0.0^0.0.0),(0.0.0^0.2.1),11.44"),
    ("CARLSBG", "2014-12-11", "CARLSBG,BBS,2.3,0.0.0.0,(c1.m4.p2.v2),(4.1.0.0^4.0.7^1.0.0^0.0.0.l.6),(^),11.86"),
    ("CARLSBG", "2015-03-03", "CARLSBG,TSS,-2.-3,0.0.0.0,(c2.m4.p3.v4),(4.1.0.1^0.1.0^1.0.0^0.0.0.s.6),(^),13.16"),
    ("CARLSBG", "2015-04-16", "CARLSBG,TSS,-2.3,0.0.0.0,(c2.m4.p2.v2),(4.1.0.2^0.1.1^1.0.0^0.0.0.s.6),(^),14.40"),
    ("CARLSBG", "2015-05-06", "CARLSBG,TSS,-24.1,0.0.0.0,(c2.m2.p2.v0),(0.2.2.2^1.1.1^1.0.0^0.0.0),(0.0.0^0.1.0),13.14"),
    ("CARLSBG", "2009-07-31", "CARLSBG,TSS,-27.1,0.0.0.0,(c2.m2.p2.v4),(0.0.0.1^4.0.0^1.0.0^0.0.0),(0.0.0^0.1.2),4.64"),
    ("CARLSBG", "2009-07-01", "CARLSBG,BBS,28.3,0.0.0.0,(c2.m2.p2.v0),(0.0.0.3^4.0.0^1.0.0^0.0.0),(0.0.0^0.1.2),3.74"),
    ("DANCO", "2018-09-04", "DANCO,TSS,-2.-1,0.0.0.0,(c2.m2.p4.v2),(4.0.1.0^1.7.1^1.0.0^0.1.0.z.4),(^),0.48"),
    ("DUFU", "2011-12-09", "DUFU,TSS,-28.2,0.0.0.0,(c1.m2.p2.v0),(0.0.2.3^0.7.7^1.0.0^0.1.0),(0.0.2^0.1.1),0.23"),
    ("F&N", "2014-06-10", "F&N,TSS,-28.2,0.0.0.0,(c1.m2.p2.v0),(4.0.0.3^4.4.6^1.0.2^0.0.0),(0.0.0^0.1.0),18.12"),
    ("F&N", "2014-07-02", "F&N,TSS,-25.1,0.0.0.0,(c1.m2.p2.v4),(4.0.0.1^0.4.6^1.0.2^0.0.0),(0.0.0^0.1.0),18.18"),
    ("F&N", "2014-07-24", "F&N,TSS,-27.1,0.0.0.0,(c1.m2.p2.v0),(0.0.0.3^0.6.6^1.0.0^0.1.0),(0.0.0^0.2.0),17.86"),
    ("F&N", "2014-12-03", "F&N,BBS,23.1,0.0.0.0,(c1.m2.p4.v2),(4.4.1.0^8.6.0^0.0.0^0.2.0),(0.0.0^0.0.0),16.60"),
    ("KESM", "2013-05-13", "KESM,BBS,21.-5,0.0.0.0,(c1.m4.p2.v2),(4.1.0.0^0.2.0^1.6.0^0.0.0),(0.0.2^0.2.0),1.80"),
    ("KESM", "2013-09-04", "KESM,BBS,22.2,0.0.0.0,(c1.m0.p2.v1),(0.3.0.0^0.2.0^1.7.0^0.1.0),(0.0.2^0.1.1),1.73"),
    ("KLSE", "2009-04-22", "KLSE,BBS,21.1,0.0.0.0,(c1.m4.p4.v4),(0.1.1.1^0.0.0^0.0.0^0.1.0),(2.0.0^0.1.0),968.58"),
    ("KLSE", "2009-06-25", "KLSE,BBS,24.1,0.0.0.0,(c2.m2.p2.v2),(0.2.2.2^1.1.0^1.0.0^0.1.0),(0.0.0^0.1.0),1074.11"),
    ("KLSE", "2009-08-04", "KLSE,BBS,21.2,0.0.0.0,(c2.m4.p3.v2),(0.1.0.4^1.2.0^1.0.0^0.0.0),(0.0.0^0.1.0),1179.88"),
    ("KLSE", "2009-07-07", "KLSE,BBS,24.1,0.0.0.0,(c2.m2.p2.v0),(0.2.2.2^1.1.0^1.0.0^0.0.0),(0.0.0^0.1.0),1066.36"),
    ("KLSE", "2015-08-05", "KLSE,TSS,-26.2,0.0.0.0,(c1.m2.p2.v0),(4.0.0.3^8.0.4^0.0.0^0.0.0),(0.0.0^0.2.0),1725.56"),
    ("KLSE", "2015-10-07", "KLSE,TSS,-23.2,0.0.0.0,(c1.m2.p4.v2),(4.0.1.2^4.6.8^0.0.0^0.0.0),(0.0.0^0.0.0),1689.25"),
    ("KLSE", "2017-01-03", "KLSE,BBS,28.3,0.0.0.0,(c1.m2.p2.v0),(0.0.0.3^0.4.0^1.0.3^0.0.0),(0.0.0^0.1.0),1635.53"),
    ("KLSE", "2017-01-04", "KLSE,BBS,28.2,0.0.0.0,(c1.m2.p2.v0),(0.0.0.3^0.4.0^1.0.3^0.0.0),(0.0.0^0.1.0),1647.47"),
    ("KLSE", "2017-01-18", "KLSE,BBS,21.7,0.0.0.0,(c1.m4.p2.v2),(0.1.0.0^0.4.0^1.0.3^0.0.0),(0.0.0^0.1.0),1665.02"),
    ("KLSE", "2017-02-02", "KLSE,BBS,24.99,0.0.0.0,(c1.m3.p2.v4),(0.2.0.1^0.0.0^1.0.3^0.0.0),(0.0.0^0.1.0),1673.48"),
    ("PADINI", "2009-05-06", "PADINI,BBS,24.-1,0.0.0.0,(c2.m2.p2.v0),(0.2.0.3^1.0.0^0.0.0^0.0.0),(0.0.0^0.0.0),0.52"),
    ("PADINI", "2014-03-14", "PADINI,TSS,-23.-1,0.0.0.0,(c2.m3.p4.v4),(0.4.1.1^4.0.7^2.0.0^0.2.0),(0.0.0^0.0.1),1.93"),
    ("PADINI", "2015-04-02", "PADINI,BBS,2.-1,0.0.0.0,(c1.m4.p2.v2),(4.1.0.0^6.0.0^0.0.1^0.0.0.m.5),(^),1.44"),
    ("PADINI", "2015-08-04", "PADINI,BBS,28.2,0.0.0.0,(c1.m2.p2.v0),(4.0.0.3^0.0.1^0.0.4^0.1.0),(0.0.0^0.2.1),1.34"),
    ("PADINI", "2015-09-17", "PADINI,BBS,21.-2,0.0.0.0,(c1.m4.p2.v2),(4.1.0.0^0.0.1^0.0.4^0.1.0),(0.0.0^0.0.2),1.41"),
    ("PADINI", "2015-10-01", "PADINI,BBS,24.1,0.0.0.0,(c1.m2.p2.v2),(4.2.0.0^1.0.1^0.0.4^0.1.0),(0.0.0^0.0.2),1.40"),
])
@pytest.mark.bottomC
def test_bottomC_success(counter, tdate, expected):
    result = scanSignals("", 0, counter, loadjson(counter, tdate), 0)
    result, expected = matchpartial(result, expected, 2)
    assert result == expected, "*** Input = " + counter + "," + tdate


@pytest.mark.parametrize("counter,tdate,expected", [
    ("CARLSBG", "2011-08-02", "CARLSBG,TSS,-39.1,0.0.0.0,(c3.m2.p2.v0),(0.0.0.3^4.6.8^0.0.0^0.0.0),(0.0.0^0.2.0),7.45"),
    ("CARLSBG", "2011-08-12", "CARLSBG,TSS,-35.3,0.0.0.0,(c3.m2.p0.v3),(0.0.3.0^4.6.0^0.0.0^0.0.0),(0.0.0^0.2.1),6.88"),
    ("CARLSBG", "2011-10-03", "CARLSBG,BBS,35.3,0.0.0.0,(c2.m2.p0.v1),(0.0.3.0^4.6.0^0.0.0^1.0.0),(0.1.0^0.0.1),6.38"),
    ("CARLSBG", "2013-09-04", "CARLSBG,TSS,-33.4,0.0.0.0,(c2.m0.p0.v4),(2.3.3.1^0.4.0^0.0.0^1.0.0),(0.1.0^0.2.0),12.62"),
    ("CARLSBG", "2013-10-02", "CARLSBG,TSS,-31.7,0.0.0.0,(c2.m1.p2.v0),(0.4.4.2^0.6.0^0.0.0^1.0.7),(0.1.0^0.0.0),12.92"),
    ("CARLSBG", "2016-03-02", "CARLSBG,BBS,34.1,0.0.0.0,(c2.m3.p4.v2),(0.0.1.0^4.7.0^2.6.9^0.0.0),(0.0.0^0.2.2),12.62"),
    ("CARLSBG", "2016-04-04", "CARLSBG,BBS,3.-16,0.0.0.0,(c3.m2.p3.v0),(0.0.2.3^0.2.7^2.0.0^0.0.0.s.4),(^),13.94"),
    ("CARLSBG", "2016-05-06", "CARLSBG,BBS,3.3,0.0.0.0,(c2.m1.p0.v2),(0.0.2.0^0.2.7^0.0.0^0.0.0.s.1),(^),12.64"),
    ("CARLSBG", "2016-05-16", "CARLSBG,BBS,3.16,0.0.0.0,(c2.m1.p2.v2),(0.0.2.0^0.2.7^0.0.0^0.0.0.s.1),(^),12.94"),
    ("CARLSBG", "2016-07-05", "CARLSBG,BBS,32.2,0.0.0.0,(c3.m4.p2.v2),(0.1.0.0^8.0.0^0.0.0^0.0.0),(0.0.0^0.0.0),13.72"),
    ("CARLSBG", "2016-12-28", "CARLSBG,BBS,3.9,0.0.0.0,(c3.m2.p2.v2),(0.4.0.0^3.4.1^0.0.0^0.0.6.z.2),(^),13.96"),
    ("CARLSBG", "2018-10-17", "CARLSBG,BBS,3.4,0.0.0.0,(c3.m2.p0.v2),(0.0.3.0^6.4.0^0.0.0^0.0.6.l.1),(^),17.76"),
    ("CARLSBG", "2019-01-02", "CARLSBG,BBS,39.2,0.0.0.0,(c3.m2.p2.v0),(0.0.0.3^0.8.1^0.0.0^0.3.1),(0.0.0^0.0.0),19.62"),
    ("DUFU", "2013-12-24", "DUFU,TSS,-32.1,0.0.0.0,(c1.m4.p2.v2),(0.1.2.2^7.0.0^1.0.1^5.0.0),(0.0.0^0.1.2),0.13"),
    ("DUFU", "2014-11-06", "DUFU,BBS,30.1,0.0.0.0,(c2.m2.p2.v1),(2.0.0.0^9.0.0^0.0.0^7.0.0),(0.0.0^0.1.2),0.16"),
    ("DUFU", "2014-11-20", "DUFU,TSS,-31.-1,0.0.0.0,(c2.m2.p2.v3),(2.0.4.0^9.1.8^0.0.0^6.0.0),(0.0.0^0.1.0),0.19"),
    ("DUFU", "2014-12-18", "DUFU,BBS,30.2,0.0.0.0,(c3.m1.p2.v2),(0.0.0.0^9.0.8^0.0.0^6.0.0),(0.0.0^0.1.0),0.16"),
    ("DUFU", "2015-03-02", "DUFU,BBS,35.2,0.0.0.0,(c2.m2.p0.v2),(2.0.2.0^9.0.0^0.0.0^6.0.0),(0.0.0^0.1.1),0.19"),
    ("DUFU", "2015-08-06", "DUFU,BBS,31.2,0.0.0.0,(c2.m2.p2.v0),(2.4.4.3^8.8.6^0.0.0^0.0.3),(0.0.1^0.2.2),0.20"),
    ("DUFU", "2015-08-18", "DUFU,BBS,30.3,0.0.0.0,(c2.m2.p2.v2),(2.0.0.0^8.6.6^0.0.0^0.0.3),(0.0.1^0.2.0),0.18"),
    ("DUFU", "2017-10-06", "DUFU,TSS,-33.-1,0.0.0.0,(c3.m0.p0.v2),(0.3.3.0^1.6.0^0.5.0^0.0.0),(0.0.0^0.2.0),0.93"),
    ("DUFU", "2017-10-20", "DUFU,TSS,-35.1,0.0.0.0,(c3.m1.p0.v2),(0.4.3.0^3.6.0^0.0.0^0.0.0),(0.0.0^0.2.0),0.96"),
    ("DUFU", "2017-11-01", "DUFU,TSS,-36.2,0.0.0.0,(c3.m2.p2.v2),(0.4.0.0^3.4.7^0.0.0^0.0.0),(0.0.1^0.0.0),0.95"),
    ("DUFU", "2017-12-05", "DUFU,TSS,-33.-2,0.0.0.0,(c2.m0.p0.v4),(0.3.3.1^8.4.7^0.0.0^1.0.0),(0.1.1^0.0.0),0.71"),
    ("DUFU", "2018-05-03", "DUFU,BBS,39.-4,0.0.0.0,(c2.m2.p2.v0),(0.0.0.3^0.0.0^0.0.0^0.0.0),(0.2.1^0.0.0),0.71"),
    ("DUFU", "2018-07-17", "DUFU,BBS,39.4,0.0.0.0,(c2.m2.p2.v4),(0.0.0.1^7.0.0^0.0.0^0.3.0),(0.0.1^0.0.0),0.71"),
    ("DUFU", "2018-08-02", "DUFU,BBS,30.1,0.0.0.0,(c3.m4.p4.v4),(0.1.1.1^7.7.0^2.0.9^0.0.0),(0.0.1^0.0.0),0.91"),
    ("F&N", "2009-02-03", "F&N,TSS,-38.1,0.0.0.0,(c3.m2.p2.v0),(0.2.0.3^9.0.0^0.0.2^6.3.1),(0.0.0^0.1.1),8.85"),
    ("F&N", "2009-02-24", "F&N,BBS,35.-2,0.0.0.0,(c3.m2.p0.v2),(0.2.3.4^9.0.0^0.0.0^5.0.0),(0.0.0^0.1.2),7.75"),
    ("F&N", "2009-03-02", "F&N,BBS,35.2,0.0.0.0,(c1.m2.p0.v3),(0.2.3.4^9.0.0^0.0.2^5.0.0),(0.0.0^0.1.2),7.55"),
    ("F&N", "2009-03-18", "F&N,BBS,35.5,0.0.0.0,(c2.m2.p0.v2),(0.0.3.0^9.0.0^0.0.2^5.0.0),(0.0.0^1.1.2),7.90"),
    ("F&N", "2010-04-02", "F&N,BBS,33.5,0.0.0.0,(c3.m0.p2.v4),(0.3.0.1^0.8.0^0.0.0^4.0.0),(0.0.0^0.1.0),10.60"),
    ("F&N", "2010-05-04", "F&N,BBS,36.3,0.0.0.0,(c3.m2.p2.v2),(0.4.0.0^0.6.0^0.0.0^4.0.0),(0.0.0^0.1.0),10.78"),
    ("F&N", "2012-02-03", "F&N,BBS,39.51,0.0.0.0,(c3.m1.p1.v3),(0.0.0.4^0.8.8^0.0.0^0.0.0),(0.0.0^0.2.0),17.60"),
    ("F&N", "2012-04-03", "F&N,TSS,-32.3,0.0.0.0,(c3.m4.p2.v2),(0.1.0.4^0.0.8^0.0.0^0.0.0),(0.0.0^0.0.0),19.18"),
    ("F&N", "2012-06-26", "F&N,TSS,-39.-1,0.0.0.0,(c3.m2.p2.v4),(0.0.0.1^7.5.0^0.0.9^0.0.0),(0.0.0^0.0.0),18.20"),
    ("F&N", "2012-08-01", "F&N,TSS,-39.1,0.0.0.0,(c3.m2.p2.v0),(0.0.0.2^7.5.0^0.0.9^0.0.0),(0.0.0^0.0.0),19.12"),
    ("F&N", "2015-11-02", "F&N,BBS,39.6,0.0.0.0,(c3.m2.p2.v4),(0.0.0.1^3.1.3^0.0.4^3.0.0),(0.0.0^0.1.0),18.06"),
    ("F&N", "2015-12-02", "F&N,BBS,33.3,0.0.0.0,(c3.m1.p2.v2),(0.0.0.0^3.1.8^0.0.1^3.0.0),(0.0.0^0.1.0),18.06"),
    ("F&N", "2017-11-01", "F&N,BBS,3.10,0.0.0.0,(c3.m4.p2.v2),(0.1.0.0^7.6.0^0.0.0^0.0.0.r.5),(^),25.34"),
    ("F&N", "2018-12-04", "F&N,BBS,31.5,0.0.0.0,(c2.m2.p1.v2),(2.0.4.0^4.8.8^0.0.0^0.0.0),(1.0.0^0.2.0),33.20"),
    ("KESM", "2013-12-03", "KESM,BBS,33.-4,0.0.0.0,(c3.m0.p2.v2),(0.3.2.0^0.2.0^0.8.0^0.0.0),(0.0.2^0.1.2),2.00"),
    ("KESM", "2015-01-19", "KESM,BBS,31.1,0.0.0.0,(c2.m1.p1.v2),(2.4.4.0^6.6.0^0.0.0^1.0.3),(0.1.1^0.2.0),2.41"),
    ("KESM", "2016-03-16", "KESM,BBS,31.-2,0.0.0.0,(c2.m1.p1.v2),(2.0.4.4^0.4.3^0.0.0^0.0.0),(0.0.0^0.2.0),4.52"),
    ("KESM", "2016-04-25", "KESM,BBS,3.7,0.0.0.0,(c2.m2.p2.v0),(2.0.4.3^8.4.8^0.5.0^0.0.0.r.1),(^),4.36"),
    ("KESM", "2018-03-16", "KESM,TSS,-30.5,0.0.0.0,(c3.m2.p2.v2),(0.0.0.0^4.4.4^0.0.0^0.0.0),(0.0.0^0.2.0),19.88"),
    ("KESM", "2018-11-02", "KESM,TSS,-35.7,0.0.0.0,(c1.m1.p0.v2),(0.0.3.2^0.1.0^0.0.0^0.0.7),(0.0.0^0.0.0),12.34"),
    ("KESM", "2018-11-26", "KESM,TSS,-31.8,0.0.0.0,(c1.m2.p1.v2),(0.0.4.2^0.1.0^0.0.0^0.0.7),(0.0.0^0.0.0),8.88"),
    ("KLSE", "2017-10-03", "KLSE,TSS,-33.5,0.0.0.0,(c3.m0.p2.v2),(0.3.0.0^0.4.8^0.0.0^4.0.0),(0.0.0^0.1.0),1759.67"),
    ("KLSE", "2017-11-02", "KLSE,BBS,33.-5,0.0.0.0,(c2.m0.p2.v2),(0.3.0.0^0.6.8^0.0.0^5.0.0),(0.0.0^0.1.0),1741.05"),
    ("KLSE", "2017-12-04", "KLSE,BBS,36.4,0.0.0.0,(c2.m1.p1.v4),(0.4.0.1^8.6.0^0.0.0^5.0.0),(0.0.0^0.1.0),1713.13"),
    ("KESM", "2018-05-07", "KESM,TSS,-31.-8,0.0.0.0,(c2.m2.p1.v0),(2.4.4.2^4.6.0^0.0.0^0.0.0),(0.0.0^0.0.0),15.74"),
    ("KESM", "2018-08-07", "KESM,TSS,-32.2,0.0.0.0,(c3.m4.p2.v2),(0.1.0.0^4.0.0^0.0.0^0.0.0),(0.0.0^0.2.0),17.86"),
    ("KESM", "2018-10-02", "KESM,TSS,-39.1,0.0.0.0,(c2.m2.p1.v4),(0.0.0.1^0.1.0^0.0.0^0.0.0),(0.0.0^0.2.0),15.02"),
    ("KLSE", "2008-06-02", "KLSE,TSS,-30.2,0.0.0.0,(c2.m2.p2.v2),(0.0.0.0^0.4.6^0.0.0^0.0.7),(0.0.0^0.2.0),1262.49"),
    ("KLSE", "2008-08-29", "KLSE,TSS,-30.3,0.0.0.0,(c2.m2.p2.v2),(0.0.0.0^0.4.6^0.0.0^0.0.7),(1.0.0^0.0.0),1100.50"),
    ("KLSE", "2011-05-05", "KLSE,BBS,30.3,0.0.0.0,(c3.m2.p2.v1),(0.0.0.0^6.4.4^0.0.0^0.0.0),(0.0.1^0.2.0),1521.18"),
    ("KLSE", "2011-09-26", "KLSE,BBS,33.3,0.0.0.0,(c2.m0.p0.v1),(2.3.3.2^6.4.0^0.0.0^0.0.0),(0.0.0^0.1.0),1331.80"),
    ("KLSE", "2011-10-10", "KLSE,BBS,31.7,0.0.0.0,(c2.m2.p1.v0),(2.4.4.2^6.4.0^0.0.0^0.0.0),(0.0.0^0.2.0),1397.04"),
    ("KLSE", "2014-11-04", "KLSE,TSS,-39.51,0.0.0.0,(c3.m3.p2.v2),(0.0.0.0^8.4.0^0.5.2^0.0.3),(0.0.0^0.2.0),1847.36"),
    ("KLSE", "2014-12-02", "KLSE,TSS,-39.6,0.0.0.0,(c2.m2.p1.v4),(0.0.0.1^6.0.0^0.5.2^0.0.6),(0.0.0^0.2.0),1785.97"),
    ("KLSE", "2014-12-04", "KLSE,TSS,-35.9,0.0.0.0,(c2.m2.p0.v4),(0.0.3.1^6.0.0^0.5.2^0.0.6),(0.0.0^0.2.0),1745.69"),
    ("KLSE", "2014-12-26", "KLSE,BBS,35.-9,0.0.0.0,(c2.m2.p0.v2),(0.0.3.0^6.0.0^0.5.2^0.0.6),(0.0.0^0.2.0),1764.44"),
    ("KLSE", "2015-01-07", "KLSE,BBS,31.6,0.0.0.0,(c2.m2.p1.v2),(0.0.4.0^4.8.0^0.6.0^0.0.6),(0.0.0^0.0.0),1709.18"),
    ("KLSE", "2015-02-04", "KLSE,BBS,31.-9,0.0.0.0,(c2.m2.p3.v4),(0.0.4.1^4.8.0^0.6.0^0.0.0),(0.0.0^0.0.0),1803.02"),
    ("KLSE", "2015-05-05", "KLSE,TSS,-39.6,0.0.0.0,(c2.m1.p2.v4),(0.0.0.1^0.0.0^0.7.0^0.0.0),(0.0.0^0.1.0),1827.42"),
    ("KLSE", "2015-05-11", "KLSE,TSS,-33.5,0.0.0.0,(c2.m0.p2.v2),(0.3.0.0^0.0.0^0.7.0^0.0.0),(0.0.0^0.1.0),1805.49"),
    ("KLSE", "2017-12-04", "KLSE,BBS,36.4,0.0.0.0,(c2.m1.p1.v4),(0.4.0.1^8.6.0^0.0.0^5.0.0),(0.0.0^0.1.0),1713.13"),
    ("KLSE", "2018-07-02", "KLSE,BBS,30.98,0.0.0.0,(c1.m0.p0.v0),(2.3.2.2^0.8.8^0.0.0^5.0.0),(0.0.0^0.1.0),1685.05"),
    ("KLSE", "2018-07-04", "KLSE,BBS,31.1,0.0.0.0,(c1.m0.p1.v0),(2.3.4.2^0.8.8^0.0.0^0.0.0),(0.0.0^0.2.0),1688.45"),
    ("KLSE", "2018-10-22", "KLSE,TSS,-33.5,0.0.0.0,(c2.m0.p1.v2),(0.2.0.0^0.8.8^0.0.0^0.0.0),(0.0.0^0.2.0),1722.47"),
    ("PADINI", "2009-12-04", "PADINI,BBS,32.1,0.0.0.0,(c3.m4.p2.v4),(0.1.0.1^9.7.1^0.0.0^0.0.0),(0.0.0^0.1.0),0.65"),
    ("PADINI", "2011-06-10", "PADINI,TSS,-30.2,0.0.0.0,(c3.m1.p2.v2),(0.0.0.0^8.8.0^0.0.0^0.0.0),(0.0.0^0.2.2),1.09"),
    ("PADINI", "2011-08-19", "PADINI,TSS,-35.4,0.0.0.0,(c2.m2.p0.v2),(0.0.3.0^0.4.0^0.0.0^0.0.0),(0.0.0^0.1.0),0.94"),
    ("PADINI", "2011-10-04", "PADINI,BBS,31.5,0.0.0.0,(c2.m2.p1.v0),(0.0.4.3^0.4.4^0.0.0^0.0.0),(0.0.0^0.2.0),0.85"),
    ("PADINI", "2011-11-01", "PADINI,BBS,31.3,0.0.0.0,(c2.m2.p4.v2),(0.0.1.0^4.4.4^0.0.0^0.0.0),(0.0.0^0.2.0),1.02"),
    ("PADINI", "2013-05-02", "PADINI,TSS,-30.-3,0.0.0.0,(c2.m0.p1.v2),(0.2.0.0^8.1.0^0.0.1^0.0.0),(0.0.0^0.1.0),1.78"),
    ("PADINI", "2013-06-03", "PADINI,TSS,-34.1,0.0.0.0,(c3.m2.p4.v0),(0.0.1.3^0.2.0^0.0.3^0.0.1),(0.0.0^0.1.0),2.11"),
    ("PADINI", "2013-12-10", "PADINI,TSS,-39.1,0.0.0.0,(c2.m2.p2.v4),(0.0.0.1^7.0.0^2.0.0^0.0.0),(0.0.0^0.0.0),1.81"),
    ("PADINI", "2014-02-04", "PADINI,BBS,33.2,0.0.0.0,(c1.m0.p0.v2),(0.3.3.0^5.0.7^2.9.0^0.0.0),(0.0.0^0.0.1),1.59"),
    ("PADINI", "2014-10-02", "PADINI,TSS,-39.5,0.0.0.0,(c2.m2.p2.v0),(0.0.0.3^0.0.6^0.0.0^0.0.0),(0.0.1^0.0.0),1.88"),
    ("PADINI", "2017-02-02", "PADINI,BBS,39.1,0.0.0.0,(c2.m2.p1.v4),(2.0.0.1^4.6.0^0.6.0^2.0.3),(0.1.0^0.0.1),2.38"),
    ("PADINI", "2018-12-04", "PADINI,TSS,-33.1,0.0.0.0,(c2.m0.p0.v4),(2.2.3.1^0.0.5^0.0.0^1.0.0),(0.1.1^0.0.0),4.30"),
    ("PARAMON", "2018-07-10", "PARAMON,BBS,39.52,0.0.0.0,(c3.m1.p1.v1),(0.0.0.4^9.4.8^0.0.0^3.0.6),(0.0.0^0.1.0),1.86"),
])
@pytest.mark.retrace
def test_retrace_success(counter, tdate, expected):
    result = scanSignals("", 0, counter, loadjson(counter, tdate), 0)
    result, expected = matchpartial(result, expected, 2)
    assert result == expected, "*** Input = " + counter + "," + tdate


@pytest.mark.parametrize("counter,tdate,expected", [
    ("CARLSBG", "2009-08-03", "CARLSBG,TSS,-41.3,0.0.0.0,(c3.m4.p4.v4),(0.1.1.1^5.7.0^1.9.9^0.0.0),(0.0.0^0.1.0),4.50"),
    ("CARLSBG", "2009-08-04", "CARLSBG,BBS,42.-1,0.0.0.0,(c3.m3.p4.v3),(0.0.1.2^5.7.0^1.9.9^0.0.0),(0.0.0^0.1.2),4.50"),
    ("CARLSBG", "2010-04-13", "CARLSBG,TSS,-40.-6,0.0.0.0,(c4.m2.p2.v2),(1.0.0.0^8.0.7^0.0.0^5.0.4),(0.0.0^0.1.0),5.13"),
    ("CARLSBG", "2011-03-01", "CARLSBG,BBS,40.1,0.0.0.0,(c4.m2.p2.v2),(1.0.0.0^7.0.0^0.0.0^0.0.0),(0.0.0^0.1.0),6.75"),
    ("CARLSBG", "2011-04-04", "CARLSBG,TSS,-41.-3,0.0.0.0,(c4.m4.p2.v0),(1.1.0.3^7.0.0^0.0.0^0.0.0),(0.0.0^0.1.0),7.43"),
    ("CARLSBG", "2011-04-20", "CARLSBG,TSS,-40.2,0.0.0.0,(c4.m3.p3.v2),(1.0.0.0^7.0.0^0.0.0^0.0.0),(0.0.0^0.1.0),7.81"),
    ("CARLSBG", "2012-03-05", "CARLSBG,BBS,42.2,0.0.0.0,(c4.m2.p4.v2),(1.0.1.0^0.0.8^0.0.0^0.0.0),(0.0.0^0.1.0),10.46"),
    ("CARLSBG", "2012-03-23", "CARLSBG,BBS,-47.-2,0.0.0.0,(c4.m2.p3.v0),(1.0.0.3^0.0.8^0.0.0^0.0.0),(0.0.0^0.1.0),10.46"),
    ("CARLSBG", "2013-05-09", "CARLSBG,BBS,40.4,0.0.0.0,(c4.m2.p2.v2),(1.4.0.0^0.8.0^0.0.0^0.0.4),(0.0.0^0.0.0),15.36"),
    ("CARLSBG", "2013-06-04", "CARLSBG,TSS,-40.5,0.0.0.0,(c4.m2.p3.v2),(1.0.0.0^0.0.0^2.0.0^0.0.0),(0.0.0^0.1.0),16.82"),
    ("CARLSBG", "2016-08-02", "CARLSBG,BBS,4.-3,0.0.0.0,(c4.m2.p2.v2),(1.2.0.0^3.0.0^0.0.0^0.0.0.z.4),(^),14.50"),
    ("CARLSBG", "2017-04-03", "CARLSBG,BBS,4.-2,0.0.0.0,(c4.m4.p2.v0),(1.1.0.3^3.4.2^0.0.0^0.0.0.z.6),(^),15.08"),
    ("CARLSBG", "2017-05-02", "CARLSBG,BBS,44.2,0.0.0.0,(c4.m2.p2.v3),(1.2.0.0^3.0.1^0.0.0^0.0.0),(0.0.0^0.0.0),15.22"),
    ("CARLSBG", "2018-03-01", "CARLSBG,TSS,-4.-2,0.0.0.0,(c4.m4.p4.v2),(1.1.1.0^0.7.0^0.0.9^3.0.0.s.1),(^),18.78"),
    ("CARLSBG", "2019-02-07", "CARLSBG,BBS,48.-1,0.0.0.0,(c4.m2.p3.v4),(1.0.0.1^7.0.3^0.0.0^0.0.0),(0.0.0^0.1.0),21.34"),
    ("CARLSBG", "2019-02-11", "CARLSBG,BBS,40.4,0.0.0.0,(c4.m2.p3.v3),(1.0.0.0^7.0.3^0.0.0^0.0.1),(0.0.0^0.1.0),20.90"),
    ("DUFU", "2014-12-08", "DUFU,BBS,42.-1,0.0.0.0,(c4.m2.p4.v4),(1.0.1.1^9.1.8^0.0.0^6.0.0),(0.0.0^0.1.0),0.18"),
    ("DUFU", "2015-01-13", "DUFU,BBS,40.3,0.0.0.0,(c4.m2.p2.v1),(1.0.0.0^9.0.8^0.0.0^6.0.0),(0.0.0^0.1.2),0.19"),
    ("DUFU", "2015-02-05", "DUFU,TSS,-42.2,0.0.0.0,(c4.m2.p4.v2),(1.0.1.0^9.0.0^0.0.0^6.0.0),(0.0.0^0.1.1),0.27"),
    ("DUFU", "2015-12-28", "DUFU,BBS,42.2,0.0.0.0,(c4.m2.p4.v3),(1.0.1.0^2.7.4^0.0.9^0.0.0),(0.0.1^0.1.2),0.35"),
    ("DUFU", "2016-01-05", "DUFU,TSS,-40.-4,0.0.0.0,(c4.m2.p2.v2),(1.0.0.0^7.2.0^0.0.0^0.0.0),(0.0.2^0.1.0),0.34"),
    ("DUFU", "2017-04-13", "DUFU,BBS,47.1,0.0.0.0,(c4.m2.p2.v0),(1.0.0.3^5.2.0^0.9.0^3.0.0),(0.0.0^0.1.0),0.75"),
    ("DUFU", "2017-05-03", "DUFU,TSS,-49.-1,0.0.0.0,(c4.m2.p2.v2),(1.0.0.4^7.1.8^0.0.0^4.0.0),(0.0.0^0.1.0),0.87"),
    ("DUFU", "2018-10-01", "DUFU,BBS,40.-1,0.0.0.0,(c4.m2.p2.v1),(1.0.2.2^2.7.0^0.0.3^0.1.0),(0.0.2^0.0.0),1.75"),
    ("DUFU", "2018-11-16", "DUFU,TSS,-40.1,0.0.0.0,(c4.m2.p2.v2),(1.0.0.0^2.7.7^0.0.0^0.1.0),(0.0.2^0.1.0),2.63"),
    ("F&N", "2008-10-03", "F&N,TSS,-48.1,0.0.0.0,(c4.m2.p2.v4),(1.0.0.1^9.0.8^0.0.2^5.0.0),(0.0.0^1.1.0),9.10"),
    ("F&N", "2009-06-16", "F&N,BBS,40.3,0.0.0.0,(c4.m2.p2.v2),(1.0.0.0^9.3.0^0.0.0^0.0.0),(0.0.0^1.2.0),9.10"),
    ("F&N", "2010-06-03", "F&N,BBS,43.1,0.0.0.0,(c4.m0.p2.v2),(1.3.0.0^0.8.0^0.0.0^4.0.0),(0.0.0^0.1.0),11.30"),
    ("F&N", "2010-07-13", "F&N,TSS,-42.-6,0.0.0.0,(c4.m2.p4.v2),(1.0.1.0^0.8.0^0.0.0^4.0.0),(0.0.0^0.1.0),13.36"),
    ("F&N", "2010-08-02", "F&N,BBS,45.-3,0.0.0.0,(c4.m2.p3.v2),(1.0.2.0^1.8.0^0.0.0^4.0.0),(0.0.0^0.1.0),14.40"),
    ("F&N", "2010-10-29", "F&N,BBS,45.3,0.0.0.0,(c4.m2.p2.v2),(1.0.2.0^1.8.0^0.0.0^4.0.0),(0.0.0^0.1.0),14.48"),
    ("F&N", "2015-02-05", "F&N,BBS,-42.1,0.0.0.0,(c4.m2.p4.v2),(1.2.1.0^8.6.4^0.0.0^0.2.0),(0.0.0^0.0.0),18.94"),
    ("F&N", "2016-03-11", "F&N,BBS,4.4,0.0.0.0,(c4.m0.p3.v2),(1.3.0.0^8.1.0^0.0.0^0.0.0.s.4),(^),19.90"),
    ("F&N", "2016-03-23", "F&N,BBS,4.3,0.0.0.0,(c4.m0.p2.v2),(1.3.0.0^8.1.0^0.0.0^0.0.0.s.4),(^),19.76"),
    ("F&N", "2016-06-01", "F&N,BBS,43.1,0.0.0.0,(c4.m0.p2.v0),(1.3.2.3^8.1.7^0.0.0^5.0.0),(0.0.0^0.1.0),23.80"),
    ("F&N", "2016-08-03", "F&N,TSS,-4.7,0.0.0.0,(c4.m1.p2.v2),(1.0.2.0^4.1.7^0.0.0^5.0.0.m.8),(^),26.10"),
    ("F&N", "2018-06-01", "F&N,TSS,-45.-3,0.0.0.0,(c4.m2.p2.v2),(1.0.2.0^0.1.0^0.0.0^0.0.0),(0.0.0^0.1.1),36.60"),
    ("KESM", "2015-05-15", "KESM,BBS,42.2,0.0.0.0,(c4.m2.p4.v3),(1.0.1.0^1.0.0^0.0.0^0.0.0),(0.2.2^0.1.0),3.48"),
    ("KESM", "2015-08-03", "KESM,BBS,41.-3,0.0.0.0,(c4.m4.p3.v2),(1.1.0.0^1.2.2^0.0.0^0.0.0),(0.2.2^0.1.0),4.25"),
    ("KESM", "2016-01-05", "KESM,TSS,-40.3,0.0.0.0,(c4.m2.p2.v2),(1.0.0.0^0.0.8^0.0.0^0.0.0),(0.2.0^0.2.0),5.32"),
    ("KESM", "2016-07-04", "KESM,BBS,42.1,0.0.0.0,(c4.m2.p4.v2),(1.0.1.2^4.4.0^0.6.1^0.0.0),(0.0.2^0.1.0),5.54"),
    ("KESM", "2016-07-08", "KESM,BBS,41.3,0.0.0.0,(c4.m4.p4.v2),(1.1.1.2^4.4.0^0.6.1^0.0.0),(0.0.2^0.1.0),5.72"),
    ("KESM", "2016-09-30", "KESM,BBS,44.2,0.0.0.0,(c4.m2.p2.v2),(1.2.2.2^0.0.0^0.6.1^0.0.0),(0.0.2^0.1.0),7.90"),
    ("KESM", "2016-10-07", "KESM,BBS,4.1,0.0.0.0,(c4.m4.p2.v2),(1.1.2.0^7.0.7^0.7.0^0.0.0.r.6),(^),7.92"),
    ("KESM", "2016-11-10", "KESM,BBS,44.3,0.0.0.0,(c4.m2.p2.v2),(1.2.0.0^2.0.7^0.0.0^0.0.0.z.6),(^),9.15"),
    ("KESM", "2018-01-02", "KESM,TSS,-40.3,0.0.0.0,(c4.m2.p2.v2),(1.0.0.0^0.4.0^0.0.0^0.0.0),(0.0.0^0.2.0),19.62"),
    # ("KLSE", "2007-06-26", "KLSE,TSS,-40.6,0.0.0.0,(c4.m2.p2.v2),(1.0.0.0^9.0.4^0.0.0^4.0.0),(0.0.1^0.1.0),1366.99"),
    ("KLSE", "2008-01-04", "KLSE,TSS,-40.-4,0.0.0.0,(c4.m1.p2.v2),(1.0.0.0^8.4.0^0.0.0^0.0.0),(0.0.0^0.1.0),1466.67"),
    ("KLSE", "2010-11-02", "KLSE,TSS,-40.-3,0.0.0.0,(c4.m2.p2.v2),(1.0.0.0^0.1.6^0.7.0^6.0.3),(0.0.0^0.1.0),1506.57"),
    ("KLSE", "2011-06-06", "KLSE,BBS,40.6,0.0.0.0,(c4.m2.p2.v2),(1.4.0.0^8.4.4^0.0.0^0.0.0),(0.0.0^0.1.0),1552.14"),
    ("KLSE", "2011-07-04", "KLSE,TSS,-41.6,0.0.0.0,(c4.m4.p2.v1),(1.1.0.0^4.4.4^0.0.0^0.0.0),(0.0.0^0.1.0),1582.35"),
    ("KLSE", "2011-07-29", "KLSE,TSS,-40.6,0.0.0.0,(c4.m2.p2.v2),(1.0.0.0^6.4.4^0.0.0^0.0.0),(0.0.0^0.1.0),1548.81"),
    ("KLSE", "2013-05-09", "KLSE,TSS,-42.6,0.0.0.0,(c4.m2.p4.v3),(1.0.1.0^0.6.4^0.0.0^0.0.7),(0.0.0^0.2.2),1766.07"),
    ("KLSE", "2014-01-02", "KLSE,TSS,-47.5,0.0.0.0,(c4.m2.p2.v0),(1.0.0.3^1.0.6^0.0.0^3.0.0),(0.0.0^0.1.0),1852.95"),
    ("KLSE", "2018-01-03", "KLSE,BBS,41.1,0.0.0.0,(c4.m4.p4.v2),(1.1.1.0^8.6.1^0.0.0^5.0.0),(0.0.0^0.1.0),1792.79"),
    ("KLSE", "2018-01-02", "KLSE,BBS,42.1,0.0.0.0,(c4.m3.p4.v0),(1.4.1.3^8.6.1^0.0.0^5.0.0),(0.0.0^0.1.0),1782.70"),
    ("KLSE", "2018-01-19", "KLSE,TSS,-42.-1,0.0.0.0,(c4.m3.p4.v2),(1.4.1.0^8.6.1^0.0.0^5.0.0),(0.0.0^0.1.0),1828.83"),
    ("KLSE", "2018-02-02", "KLSE,TSS,-45.3,0.0.0.0,(c4.m2.p3.v4),(1.0.2.1^3.8.1^0.0.0^5.0.0),(0.0.0^0.1.0),1870.48"),
    ("N2N", "2012-02-27", "N2N,BBS,42.2,0.0.0.0,(c4.m2.p4.v4),(1.0.1.1^2.2.0^0.0.0^4.0.0),(0.0.0^0.1.0),0.47"),
    ("N2N", "2012-03-02", "N2N,BBS,42.-2,0.0.0.0,(c4.m2.p4.v4),(1.0.1.1^2.2.0^0.0.0^4.0.0),(0.0.0^0.1.0),0.45"),
    ("N2N", "2012-04-03", "N2N,BBS,43.-1,0.0.0.0,(c4.m0.p2.v0),(1.3.2.2^7.2.0^0.0.0^5.0.0),(0.0.0^0.1.0),0.46"),
    ("N2N", "2012-08-01", "N2N,BBS,48.-2,0.0.0.0,(c4.m2.p2.v4),(1.0.0.1^4.0.0^0.0.2^5.0.0),(0.0.0^0.1.0),0.59"),
    ("PADINI", "2012-02-03", "PADINI,BBS,42.4,0.0.0.0,(c4.m2.p4.v2),(1.0.1.0^4.0.1^0.0.0^0.0.0),(0.0.0^0.1.0),1.28"),
    ("PADINI", "2012-03-12", "PADINI,BBS,42.-4,0.0.0.0,(c4.m2.p4.v2),(1.0.1.0^5.0.1^0.9.0^0.0.0),(0.0.0^0.1.0),1.58"),
    ("PADINI", "2012-05-03", "PADINI,BBS,42.-5,0.0.0.0,(c4.m2.p4.v2),(1.0.1.0^0.1.2^0.0.0^0.0.0),(0.0.0^0.1.0),1.67"),
    ("PADINI", "2012-05-17", "PADINI,BBS,42.5,0.0.0.0,(c4.m2.p4.v2),(1.0.1.0^0.1.2^0.0.0^0.0.0),(0.0.0^0.1.0),1.66"),
    ("PADINI", "2014-08-05", "PADINI,TSS,-47.3,0.0.0.0,(c2.m2.p2.v0),(0.0.0.3^7.0.0^0.0.0^0.0.0),(0.0.0^0.0.2),1.98"),
    ("PADINI", "2016-02-04", "PADINI,BBS,40.-1,0.0.0.0,(c4.m2.p3.v3),(1.0.0.0^2.7.1^0.0.0^0.1.0),(0.0.0^0.1.1),2.10"),
    ("PADINI", "2017-04-03", "PADINI,BBS,47.1,0.0.0.0,(c4.m2.p2.v0),(1.0.0.2^0.8.1^0.6.0^0.0.0),(0.2.0^0.0.1),3.02"),
    ("PADINI", "2017-10-02", "PADINI,BBS,47.4,0.0.0.0,(c4.m2.p2.v0),(1.0.0.3^7.4.0^0.6.0^0.0.0),(0.0.0^0.1.0),4.50"),
    ("PADINI", "2017-12-05", "PADINI,TSS,-43.-1,0.0.0.0,(c4.m0.p2.v2),(1.3.0.0^7.4.0^0.5.0^3.0.0),(0.0.0^0.1.0),5.12"),
    ("PARAMON", "2018-09-04", "PARAMON,TSS,-42.15,0.0.0.0,(c4.m2.p4.v4),(1.0.1.1^9.6.8^0.0.0^4.0.0),(0.0.0^0.1.0),2.18"),
])
@pytest.mark.highC
def test_highC_success(counter, tdate, expected):
    result = scanSignals("", 0, counter, loadjson(counter, tdate), 0)
    result, expected = matchpartial(result, expected, 2)
    assert result == expected, "*** Input = " + counter + "," + tdate


@pytest.mark.parametrize("counter,tdate,expected", [
    ("CARLSBG", "2009-10-01", "CARLSBG,BBS,51.1,0.0.0.0,(c3.m0.p2.v2),(0.3.2.0^4.7.8^0.0.0^0.0.0),(0.0.0^0.1.0),4.19"),
    ("CARLSBG", "2009-10-19", "CARLSBG,BBS,53.3,0.0.0.0,(c3.m1.p2.v2),(0.0.2.0^4.7.8^0.0.0^0.0.0),(0.0.0^0.1.0),4.24"),
    ("CARLSBG", "2010-02-02", "CARLSBG,BBS,58.5,0.0.0.0,(c3.m2.p2.v0),(2.0.0.3^4.4.0^0.0.0^4.0.0),(0.0.0^0.1.0),4.52"),
    ("CARLSBG", "2010-05-03", "CARLSBG,TSS,-50.8,0.0.0.0,(c3.m2.p2.v2),(2.0.0.0^0.0.7^0.0.0^5.0.3),(0.0.0^0.1.0),5.12"),
    ("CARLSBG", "2010-06-02", "CARLSBG,BBS,51.4,0.0.0.0,(c3.m0.p1.v1),(2.3.0.0^8.0.7^0.0.0^5.0.3),(0.0.0^0.1.0),4.80"),
    ("CARLSBG", "2010-11-03", "CARLSBG,BBS,59.2,0.0.0.0,(c4.m4.p2.v2),(1.1.0.0^0.0.4^0.0.0^0.0.4),(0.0.0^0.1.0),5.55"),
    ("CARLSBG", "2012-06-01", "CARLSBG,BBS,55.3,0.0.0.0,(c3.m2.p0.v0),(2.0.3.3^6.0.0^0.0.0^0.0.0),(0.0.0^0.1.0),10.30"),
    ("CARLSBG", "2012-08-06", "CARLSBG,BBS,57.-3,0.0.0.0,(c4.m2.p2.v4),(1.0.0.1^4.4.0^0.0.0^0.0.0),(0.0.0^0.2.0),12.50"),
    ("CARLSBG", "2012-09-03", "CARLSBG,BBS,51.-4,0.0.0.0,(c3.m0.p2.v0),(2.3.0.3^4.4.0^0.0.0^0.0.0),(0.0.0^0.2.0),12.20"),
    ("CARLSBG", "2012-09-27", "CARLSBG,BBS,51.4,0.0.0.0,(c3.m0.p1.v2),(2.3.0.0^4.4.0^0.0.0^0.0.0),(0.0.0^0.2.0),11.24"),
    ("CARLSBG", "2012-12-14", "CARLSBG,BBS,58.-4,0.0.0.0,(c4.m2.p2.v0),(1.0.0.3^0.6.0^0.5.0^0.0.4),(0.0.0^0.0.0),12.82"),
    ("CARLSBG", "2013-01-03", "CARLSBG,BBS,51.-3,0.0.0.0,(c3.m0.p2.v0),(2.3.0.3^0.6.0^0.6.0^0.0.3),(0.0.0^0.0.0),12.58"),
    ("CARLSBG", "2013-01-21", "CARLSBG,BBS,51.3,0.0.0.0,(c3.m0.p2.v2),(2.3.0.0^0.6.0^0.6.0^0.0.3),(0.0.0^0.0.0),12.10"),
    ("CARLSBG", "2013-02-18", "CARLSBG,BBS,52.4,0.0.0.0,(c3.m1.p1.v4),(2.4.0.1^0.6.0^0.0.0^0.0.3),(0.0.0^0.0.0),12.34"),
    ("CARLSBG", "2013-04-01", "CARLSBG,BBS,50.3,0.0.0.0,(c4.m2.p2.v2),(1.0.0.0^0.8.0^0.0.0^0.0.4),(0.0.0^0.0.0),14.12"),
    ("CARLSBG", "2013-08-01", "CARLSBG,TSS,-56.2,0.0.0.0,(c3.m2.p2.v0),(0.0.4.3^0.0.0^0.0.0^0.0.0),(0.0.0^0.2.0),14.86"),
    ("CARLSBG", "2015-07-22", "CARLSBG,TSS,-50.2,0.0.0.0,(c2.m2.p2.v2),(0.0.0.0^1.1.3^0.0.0^0.0.0),(0.0.0^0.2.0),12.66"),
    ("CARLSBG", "2017-06-01", "CARLSBG,BBS,59.51,0.0.0.0,(c3.m2.p2.v1),(2.2.0.0^3.0.0^0.0.0^0.0.0),(0.0.0^0.0.0),14.60"),
    ("CARLSBG", "2017-07-05", "CARLSBG,BBS,59.-3,0.0.0.0,(c4.m4.p2.v1),(1.1.0.0^1.0.4^0.0.0^0.0.1),(0.0.1^0.0.0),15.12"),
    ("CARLSBG", "2017-10-03", "CARLSBG,BBS,58.3,0.0.0.0,(c3.m2.p2.v0),(0.0.0.2^4.5.0^0.0.9^0.0.1),(0.0.2^0.1.0),14.88"),
    ("CARLSBG", "2017-11-01", "CARLSBG,BBS,58.-3,0.0.0.0,(c4.m2.p2.v0),(1.0.0.2^0.7.0^0.0.0^0.0.1),(0.0.2^0.1.0),15.94"),
    ("CARLSBG", "2018-01-02", "CARLSBG,BBS,58.8,0.0.0.0,(c3.m2.p2.v0),(2.0.0.3^0.5.8^0.0.9^0.0.1),(0.0.0^0.1.0),15.18"),
    ("CARLSBG", "2018-01-05", "CARLSBG,BBS,57.2,0.0.0.0,(c3.m2.p2.v4),(2.0.0.1^0.5.8^0.0.9^0.0.1),(0.0.2^0.1.0),15.40"),
    ("CARLSBG", "2018-05-15", "CARLSBG,TSS,-53.-3,0.0.0.0,(c3.m2.p1.v2),(2.0.2.4^1.2.4^0.0.3^0.0.3),(0.0.0^0.1.2),19.46"),
    ("CARLSBG", "2018-08-01", "CARLSBG,TSS,-52.-6,0.0.0.0,(c3.m2.p2.v2),(0.4.4.0^8.0.4^0.0.0^0.0.0),(0.0.0^0.2.0),19.30"),
    ("CARLSBG", "2018-09-28", "CARLSBG,TSS,-52.8,0.0.0.0,(c3.m2.p2.v2),(0.4.0.0^8.4.0^0.0.0^0.0.0),(0.0.0^0.2.0),20.00"),
    ("DAYANG", "2012-04-06", "DAYANG,TSS,-55.4,0.0.0.0,(c2.m2.p0.v0),(2.0.3.2^7.4.1^0.0.0^0.0.0),(0.0.0^0.1.0),1.38"),
    ("DUFU", "2014-09-05", "DUFU,TSS,-53.-1,0.0.0.0,(c2.m1.p0.v2),(2.0.2.0^9.2.2^0.0.1^6.0.0),(0.0.0^2.1.1),0.17"),
    ("DUFU", "2015-04-02", "DUFU,BBS,-51.-2,0.0.0.0,(c4.m0.p2.v2),(1.3.0.0^9.0.0^0.0.0^7.0.0),(0.0.0^0.1.2),0.25"),
    ("DUFU", "2015-05-22", "DUFU,TSS,-52.2,0.0.0.0,(c3.m2.p0.v1),(2.4.3.0^9.0.4^0.0.0^7.0.3),(0.0.0^0.1.2),0.24"),
    ("DUFU", "2015-07-01", "DUFU,BBS,52.2,0.0.0.0,(c2.m1.p0.v2),(2.4.3.0^8.0.6^0.0.0^7.0.3),(0.0.1^0.1.2),0.19"),
    ("DUFU", "2016-02-22", "DUFU,BBS,-51.3,0.0.0.0,(c3.m0.p2.v2),(2.3.0.0^7.2.0^0.0.0^0.0.0),(0.0.2^0.1.2),0.36"),
    ("DUFU", "2016-03-01", "DUFU,TSS,-52.3,0.0.0.0,(c3.m2.p2.v2),(0.4.0.0^0.2.0^0.0.0^0.0.3),(0.0.2^0.1.2),0.36"),
    ("DUFU", "2016-05-06", "DUFU,BBS,50.2,0.0.0.0,(c3.m2.p2.v2),(2.0.0.0^4.1.0^0.0.0^0.0.0),(0.0.2^0.2.0),0.32"),
    ("DUFU", "2016-11-04", "DUFU,BBS,58.2,0.0.0.0,(c3.m2.p1.v0),(2.0.0.3^0.4.4^0.0.0^0.0.0),(0.0.1^0.1.0),0.38"),
    ("DUFU", "2016-12-02", "DUFU,BBS,50.1,0.0.0.0,(c4.m2.p2.v2),(1.0.0.0^0.5.0^0.0.9^0.0.4),(0.0.2^0.1.0),0.45"),
    ("DUFU", "2016-12-14", "DUFU,BBS,50.1,0.0.0.0,(c4.m2.p2.v2),(1.0.0.0^0.5.0^0.0.9^0.0.4),(0.0.2^0.1.0),0.46"),
    ("DUFU", "2017-01-03", "DUFU,BBS,58.3,0.0.0.0,(c3.m2.p2.v0),(2.0.0.3^0.7.0^0.0.2^0.0.3),(0.0.2^0.1.0),0.46"),
    ("DUFU", "2017-09-06", "DUFU,TSS,-56.1,0.0.0.0,(c4.m2.p2.v2),(1.0.4.0^1.8.0^0.5.0^0.0.0),(0.0.0^0.2.0),0.99"),
    ("F&N", "2010-11-02", "F&N,BBS,51.1,0.0.0.0,(c3.m0.p2.v2),(2.3.2.0^0.8.0^0.0.0^4.0.0),(0.0.0^0.1.0),14.30"),
    ("F&N", "2011-01-03", "F&N,BBS,51.10,0.0.0.0,(c3.m0.p1.v2),(0.3.0.0^0.0.7^0.0.0^5.0.0),(0.0.0^0.1.0),15.20"),
    ("F&N", "2011-04-07", "F&N,BBS,58.7,0.0.0.0,(c3.m2.p2.v0),(2.0.0.3^0.4.7^0.0.0^6.0.0),(0.0.0^0.1.0),15.70"),
    ("F&N", "2011-07-06", "F&N,TSS,-50.2,0.0.0.0,(c3.m2.p2.v2),(2.0.0.0^2.0.0^0.0.0^5.0.0),(0.0.0^0.1.0),19.18"),
    ("F&N", "2011-08-03", "F&N,TSS,-5.7,0.0.0.0,(c3.m2.p2.v2),(0.0.0.0^2.8.0^0.0.0^6.0.4.z.4),(^),19.38"),
    ("F&N", "2011-08-09", "F&N,TSS,-55.2,0.0.0.0,(c3.m2.p0.v2),(2.0.3.0^2.0.0^0.0.0^5.0.0),(0.0.0^0.1.1),18.00"),
    ("F&N", "2011-08-29", "F&N,TSS,-51.14,0.0.0.0,(c3.m0.p0.v2),(2.3.3.0^2.0.0^0.0.0^4.0.0),(0.0.0^0.1.1),16.54"),
    ("F&N", "2011-12-05", "F&N,BBS,52.7,0.0.0.0,(c3.m2.p2.v0),(0.4.4.3^1.0.0^0.0.0^0.0.0),(0.0.0^0.2.2),18.20"),
    ("F&N", "2011-12-07", "F&N,BBS,52.10,0.0.0.0,(c3.m2.p2.v0),(0.4.0.3^1.8.0^0.0.0^0.0.0),(0.0.0^0.2.2),18.10"),
    ("F&N", "2012-01-04", "F&N,TSS,-58.-51,0.0.0.0,(c3.m2.p2.v2),(0.0.0.4^0.8.8^0.0.0^0.0.0),(0.0.0^0.2.0),18.12"),
    ("F&N", "2012-01-10", "F&N,TSS,-58.51,0.0.0.0,(c3.m2.p2.v2),(0.0.0.4^0.8.8^0.0.0^0.0.0),(0.0.0^0.2.0),19.02"),
    ("F&N", "2016-10-05", "F&N,BBS,-52.5,0.0.0.0,(c3.m2.p1.v2),(2.4.0.0^6.0.0^0.0.0^1.0.0),(0.1.0^0.2.0),24.10"),
    ("F&N", "2016-12-02", "F&N,BBS,51.14,0.0.0.0,(c2.m0.p0.v2),(2.3.3.0^0.0.0^0.0.0^0.0.0),(0.0.0^0.2.0),22.56"),
    ("F&N", "2018-07-13", "F&N,TSS,-53.4,0.0.0.0,(c4.m2.p2.v0),(1.0.2.3^4.1.0^0.0.0^0.0.0),(0.0.0^0.1.1),37.90"),
    ("F&N", "2018-08-02", "F&N,TSS,-51.2,0.0.0.0,(c3.m0.p1.v0),(2.3.2.3^4.1.0^0.0.0^0.0.0),(0.0.0^0.1.1),37.40"),
    ("F&N", "2018-10-01", "F&N,TSS,-52.4,0.0.0.0,(c3.m2.p2.v0),(2.4.0.3^4.0.0^0.0.0^0.0.0),(0.0.0^0.1.2),37.74"),
    ("F&N", "2018-10-23", "F&N,TSS,-52.2,0.0.0.0,(c3.m2.p0.v2),(2.4.3.0^4.0.0^0.0.0^0.0.0),(0.0.0^0.1.2),34.64"),
    ("F&N", "2018-11-16", "F&N,TSS,-51.5,0.0.0.0,(c2.m0.p0.v1),(2.3.3.0^4.0.0^0.0.0^0.0.2),(1.0.0^0.1.2),33.40"),
    ("KESM", "2013-12-31", "KESM,BBS,51.2,0.0.0.0,(c3.m0.p2.v2),(0.3.2.0^0.2.0^0.8.0^0.0.0),(0.0.0^0.1.2),1.98"),
    ("KESM", "2014-01-02", "KESM,BBS,52.1,0.0.0.0,(c3.m2.p2.v2),(0.4.2.0^8.2.0^0.8.0^0.0.0),(0.0.2^0.1.2),1.99"),
    ("KESM", "2014-04-02", "KESM,BBS,53.3,0.0.0.0,(c3.m2.p2.v0),(2.2.2.2^3.2.1^0.0.0^0.0.0),(0.0.0^0.1.0),2.40"),
    ("KESM", "2014-04-24", "KESM,BBS,53.-4,0.0.0.0,(c4.m2.p2.v2),(1.0.2.2^1.2.1^0.0.0^0.0.0),(0.0.0^0.1.0),2.67"),
    ("KESM", "2014-06-23", "KESM,BBS,53.-2,0.0.0.0,(c3.m2.p2.v1),(2.0.2.2^0.2.1^0.0.0^0.0.0),(0.0.0^0.1.2),2.45"),
    ("KESM", "2014-07-08", "KESM,TSS,-50.-1,0.0.0.0,(c3.m2.p2.v2),(0.0.0.0^0.1.2^0.0.0^3.0.4),(0.0.0^0.1.2),2.50"),
    ("KESM", "2014-07-17", "KESM,TSS,-57.-1,0.0.0.0,(c3.m2.p2.v4),(0.0.0.1^0.1.2^0.0.0^3.0.4),(0.0.0^0.1.2),2.83"),
    ("KESM", "2014-08-04", "KESM,TSS,-54.1,0.0.0.0,(c4.m2.p4.v2),(1.0.1.2^4.1.2^0.0.0^3.0.0),(0.0.0^0.1.2),2.96"),
    ("KESM", "2014-12-15", "KESM,BBS,51.-2,0.0.0.0,(c2.m0.p0.v2),(2.3.3.0^6.6.7^0.0.0^1.0.3),(0.1.1^0.2.0),2.47"),
    ("KESM", "2015-01-13", "KESM,BBS,51.3,0.0.0.0,(c2.m0.p0.v2),(2.3.3.0^6.6.0^0.0.0^1.0.3),(0.1.1^0.2.0),2.36"),
    ("KESM", "2015-05-06", "KESM,BBS,5.9,0.0.0.0,(c3.m2.p2.v2),(0.0.0.0^1.0.1^0.0.0^0.0.0.s.4),(^),2.91"),
    ("KESM", "2015-09-01", "KESM,BBS,5.3,0.0.0.0,(c3.m2.p0.v0),(2.0.2.3^0.1.0^0.0.0^0.0.0.s.3),(^),3.50"),
    ("KESM", "2017-03-01", "KESM,BBS,58.1,0.0.0.0,(c3.m3.p1.v0),(2.0.0.3^7.7.4^0.0.0^0.0.2),(0.0.1^0.1.0),9.82"),
    ("KESM", "2017-04-06", "KESM,BBS,59.1,0.0.0.0,(c4.m4.p3.v2),(1.1.0.0^7.0.0^0.0.0^0.0.0),(0.0.2^0.2.0),12.70"),
    ("KESM", "2017-09-06", "KESM,BBS,52.3,0.0.0.0,(c3.m2.p2.v2),(2.4.0.0^1.4.1^0.0.0^0.0.2),(0.0.2^0.2.0),14.86"),
    ("KESM", "2018-01-02", "KESM,TSS,-5.9,0.0.0.0,(c4.m2.p2.v2),(1.0.0.0^0.4.0^0.0.0^0.0.0.l.4),(^),19.62"),
    ("KESM", "2018-02-14", "KESM,TSS,-55.3,0.0.0.0,(c3.m2.p0.v2),(2.0.3.0^4.4.0^0.0.0^0.0.0),(0.0.0^0.1.0),19.18"),
    ("KESM", "2018-02-26", "KESM,TSS,-50.5,0.0.0.0,(c3.m2.p1.v2),(2.0.0.0^0.4.4^0.0.0^0.0.0),(0.0.0^0.1.0),20.50"),
    ("KESM", "2018-06-18", "KESM,TSS,-50.3,0.0.0.0,(c3.m2.p2.v2),(0.0.4.4^4.6.0^0.0.0^0.0.0),(0.0.0^0.2.0),17.52"),
    # ("KLSE", "2007-03-06", "KLSE,BBS,53.3,0.0.0.0,(c2.m1.p1.v2),(2.2.2.0^1.0.7^0.0.0^0.0.0),(0.0.0^0.1.1),1130.96"),
    # ("KLSE", "2007-08-01", "KLSE,TSS,-51.10,0.0.0.0,(c3.m0.p1.v2),(2.3.0.0^9.0.4^0.0.0^4.0.2),(0.0.1^0.1.0),1339.49"),
    ("KLSE", "2007-08-07", "KLSE,BBS,51.-6,0.0.0.0,(c3.m0.p0.v2),(2.3.3.0^9.0.4^0.0.0^4.0.2),(0.0.1^0.1.0),1290.13"),
    ("KLSE", "2007-09-04", "KLSE,BBS,52.4,0.0.0.0,(c3.m1.p1.v1),(0.4.4.0^9.8.0^0.0.0^0.0.0),(0.0.2^0.2.0),1283.75"),
    ("KLSE", "2007-11-01", "KLSE,TSS,52.-4,0.0.0.0,(c4.m2.p2.v2),(1.4.0.0^9.6.1^0.0.0^0.0.0),(0.0.0^0.2.0),1409.16"),
    ("KLSE", "2007-12-13", "KLSE,BBS,-50.-9,0.0.0.0,(c4.m2.p2.v2),(1.0.0.0^0.4.1^0.0.0^0.0.0),(0.0.0^0.1.0),1410.56"),
    ("KLSE", "2008-04-02", "KLSE,TSS,-52.-5,0.0.0.0,(c2.m2.p1.v2),(0.4.4.0^0.4.0^0.0.0^0.0.0),(0.0.0^0.2.0),1239.65"),
    ("KLSE", "2010-01-04", "KLSE,TSS,-59.-2,0.0.0.0,(c3.m4.p2.v2),(0.1.0.0^0.6.0^0.0.4^4.0.0),(0.0.0^0.1.0),1275.75"),
    ("KLSE", "2010-04-12", "KLSE,TSS,-59.4,0.0.0.0,(c4.m4.p2.v2),(1.1.0.0^0.6.0^0.0.4^5.0.0),(0.0.0^0.1.0),1339.61"),
    ("KLSE", "2010-05-03", "KLSE,TSS,-59.0,0.0.0.0,(c4.m2.p2.v2),(1.2.0.0^1.8.0^0.0.4^5.0.0),(0.0.0^0.1.0),1346.89"),
    ("KLSE", "2010-06-02", "KLSE,BBS,59.52,0.0.0.0,(c3.m2.p1.v2),(2.2.0.0^1.8.0^0.0.4^5.0.0),(0.0.0^0.1.0),1276.02"),
    ("KLSE", "2010-07-01", "KLSE,BBS,50.1,0.0.0.0,(c3.m2.p2.v2),(0.0.0.0^1.0.8^0.5.0^6.0.1),(0.0.0^0.1.0),1308.76"),
    ("KLSE", "2010-09-02", "KLSE,BBS,59.3,0.0.0.0,(c4.m4.p2.v3),(1.1.0.0^0.0.8^0.6.0^6.0.1),(0.0.0^0.1.0),1441.07"),
    ("KLSE", "2011-11-21", "KLSE,BBS,56.1,0.0.0.0,(c2.m2.p3.v2),(0.0.4.0^8.4.0^0.0.0^0.0.1),(0.0.1^0.2.0),1434.08"),
    ("KLSE", "2011-12-01", "KLSE,BBS,57.-1,0.0.0.0,(c2.m2.p2.v4),(0.0.0.1^8.0.0^0.0.0^0.0.1),(0.0.0^0.2.0),1485.26"),
    ("KLSE", "2011-12-15", "KLSE,BBS,50.3,0.0.0.0,(c2.m2.p2.v2),(0.0.0.0^8.0.0^0.0.0^0.0.1),(0.0.1^0.2.0),1464.11"),
    ("KLSE", "2012-04-02", "KLSE,BBS,59.-1,0.0.0.0,(c4.m4.p2.v1),(1.1.0.2^2.7.0^0.0.9^0.0.0),(0.0.2^0.1.0),1603.78"),
    ("KLSE", "2012-04-16", "KLSE,TSS,58.-99,0.0.0.0,(c4.m3.p2.v0),(1.0.0.2^2.0.0^0.0.0^0.0.0),(0.0.2^0.1.0),1597.51"),
    ("KLSE", "2012-04-18", "KLSE,BBS,-50.2,0.0.0.0,(c4.m3.p2.v1),(1.0.0.2^2.0.0^0.0.0^0.0.0),(0.0.2^0.1.0),1598.86"),
    # ("KLSE", "2012-05-02", "KLSE,BBS,59.-53,0.0.0.0,(c3.m2.p2.v2),(2.2.0.0^1.0.7^0.0.0^0.0.0),(0.0.2^0.1.0),1582.39"),
    # ("KLSE", "2012-05-16", "KLSE,BBS,59.53,0.0.0.0,(c3.m2.p2.v2),(2.2.0.0^1.0.7^0.0.0^0.0.0),(0.0.2^0.1.0),1536.04"),
    ("KLSE", "2012-06-01", "KLSE,BBS,50.2,0.0.0.0,(c3.m2.p2.v1),(0.0.0.0^2.0.7^0.0.0^0.0.0),(0.0.0^0.1.0),1573.59"),
    ("KLSE", "2012-06-13", "KLSE,BBS,59.1,0.0.0.0,(c3.m4.p2.v2),(0.1.0.0^2.0.7^0.0.0^0.0.0),(0.0.0^0.1.0),1576.23"),
    ("KLSE", "2012-07-11", "KLSE,BBS,59.-1,0.0.0.0,(c4.m4.p2.v2),(1.1.0.0^2.0.7^0.0.0^0.0.0),(0.0.0^0.1.0),1629.45"),
    ("KLSE", "2012-10-01", "KLSE,TSS,-50.-3,0.0.0.0,(c3.m2.p2.v2),(0.0.0.0^1.4.7^0.0.0^3.0.7),(0.0.0^0.1.0),1643.31"),
    ("KLSE", "2012-11-01", "KLSE,TSS,-58.7,0.0.0.0,(c4.m2.p2.v0),(1.0.0.3^0.4.7^0.0.0^3.0.0),(0.0.0^0.1.0),1675.69"),
    ("KLSE", "2012-11-26", "KLSE,BBS,51.27,0.0.0.0,(c3.m0.p2.v2),(2.3.0.0^0.4.0^0.0.0^3.0.0),(0.0.0^0.1.0),1607.88"),
    ("KLSE", "2013-01-03", "KLSE,BBS,-52.6,0.0.0.0,(c4.m2.p4.v2),(1.4.1.0^8.4.0^0.0.0^4.0.7),(0.0.0^0.1.0),1692.65"),
    ("KLSE", "2013-02-04", "KLSE,BBS,51.18,0.0.0.0,(c3.m0.p1.v2),(2.3.0.0^6.4.0^0.0.0^4.0.1),(0.0.0^0.1.0),1634.55"),
    ("KLSE", "2013-07-19", "KLSE,TSS,-50.3,0.0.0.0,(c4.m2.p2.v2),(1.0.0.0^7.0.0^0.0.0^0.0.7),(0.0.0^0.1.2),1797.74"),
    ("KLSE", "2013-09-02", "KLSE,BBS,55.4,0.0.0.0,(c3.m2.p0.v0),(2.0.3.3^0.0.8^0.0.0^0.0.0),(0.0.0^0.1.0),1717.56"),
    ("KLSE", "2013-09-04", "KLSE,BBS,55.5,0.0.0.0,(c3.m1.p0.v2),(2.0.3.0^7.0.8^0.0.0^0.0.0),(0.0.0^0.1.0),1716.76"),
    ("KLSE", "2014-02-05", "KLSE,BBS,55.7,0.0.0.0,(c3.m2.p0.v4),(2.0.3.1^1.0.4^0.0.0^3.0.0),(0.0.0^0.1.0),1785.88"),
    ("KLSE", "2014-06-03", "KLSE,TSS,-57.-4,0.0.0.0,(c3.m2.p2.v4),(2.0.0.1^0.4.7^0.0.0^4.0.0),(0.0.0^0.1.0),1872.55"),
    ("KLSE", "2014-07-01", "KLSE,TSS,-58.9,0.0.0.0,(c4.m2.p2.v0),(1.0.0.3^0.4.7^0.0.0^5.0.3),(0.0.0^0.1.0),1879.12"),
    ("KLSE", "2014-09-09", "KLSE,TSS,-57.2,0.0.0.0,(c3.m2.p2.v4),(0.0.0.1^0.4.0^0.0.0^5.0.4),(0.0.0^0.1.0),1874.12"),
    ("KLSE", "2017-06-01", "KLSE,TSS,-51.-18,0.0.0.0,(c3.m0.p2.v2),(2.3.0.0^7.0.0^0.0.0^3.0.0),(0.0.0^0.1.0),1763.11"),
    ("KLSE", "2018-04-03", "KLSE,TSS,-53.-5,0.0.0.0,(c3.m2.p2.v0),(2.0.2.3^0.8.0^0.0.0^5.0.0),(0.0.0^0.1.0),1850.78"),
    ("KLSE", "2018-05-07", "KLSE,TSS,-53.5,0.0.0.0,(c3.m2.p2.v4),(2.0.2.1^0.8.8^0.0.0^5.0.0),(0.0.0^0.1.0),1828.20"),
    ("KLSE", "2018-05-31", "KLSE,TSS,-53.-2,0.0.0.0,(c3.m1.p0.v4),(2.0.2.1^0.8.8^0.0.0^5.0.0),(0.0.0^0.1.0),1740.62"),
    ("KLSE", "2018-06-04", "KLSE,TSS,-53.2,0.0.0.0,(c2.m2.p0.v3),(2.0.2.2^0.8.8^0.0.0^5.0.0),(0.0.0^0.1.0),1755.17"),
    ("KLSE", "2018-08-01", "KLSE,TSS,-54.-1,0.0.0.0,(c2.m4.p4.v2),(0.1.1.4^0.8.8^0.0.0^0.0.0),(0.0.0^0.2.0),1788.31"),
    ("KLSE", "2018-09-04", "KLSE,TSS,-59.51,0.0.0.0,(c3.m2.p2.v1),(0.2.0.0^0.8.8^0.0.0^0.0.0),(0.0.0^0.2.0),1812.76"),
    ("PADINI", "2010-06-02", "PADINI,BBS,51.13,0.0.0.0,(c3.m0.p2.v2),(2.3.0.0^0.0.0^0.0.0^1.0.3),(0.1.0^0.2.0),0.72"),
    ("PADINI", "2010-08-03", "PADINI,BBS,57.1,0.0.0.0,(c3.m2.p2.v4),(0.0.0.1^9.0.0^0.0.0^0.0.4),(0.0.0^0.2.0),0.79"),
    ("PADINI", "2010-12-03", "PADINI,BBS,51.11,0.0.0.0,(c3.m0.p1.v2),(2.3.0.0^0.0.4^0.0.0^0.0.3),(0.0.0^0.1.0),0.97"),
    ("PADINI", "2011-01-04", "PADINI,TSS,-57.-3,0.0.0.0,(c4.m2.p2.v4),(1.0.0.1^9.0.5^0.0.0^0.0.4),(0.0.0^0.2.1),1.10"),
    ("PADINI", "2011-02-07", "PADINI,TSS,-51.16,0.0.0.0,(c3.m0.p2.v0),(2.3.0.3^0.1.7^0.0.0^0.0.3),(0.0.0^0.2.1),1.14"),
    ("PADINI", "2011-05-04", "PADINI,TSS,-56.1,0.0.0.0,(c3.m2.p2.v2),(0.0.4.0^9.3.0^0.0.0^0.0.4),(0.0.0^0.0.2),1.11"),
    ("PADINI", "2012-04-03", "PADINI,BBS,58.6,0.0.0.0,(c3.m2.p2.v0),(2.0.0.3^7.1.1^0.0.0^0.0.0),(0.0.0^0.1.0),1.41"),
    ("PADINI", "2016-04-04", "PADINI,BBS,58.5,0.0.0.0,(c3.m2.p2.v0),(0.0.0.3^7.7.0^0.0.0^0.0.0),(0.0.0^0.1.1),2.06"),
    ("PADINI", "2016-07-08", "PADINI,BBS,58.4,0.0.0.0,(c4.m1.p2.v0),(1.0.0.3^7.0.0^0.0.0^0.0.0),(0.0.0^0.1.2),2.36"),
    ("PADINI", "2016-08-04", "PADINI,TSS,-59.-1,0.0.0.0,(c4.m4.p3.v2),(1.1.0.0^0.0.0^0.0.0^3.0.0),(0.0.0^0.1.0),2.70"),
    ("PADINI", "2018-01-02", "PADINI,TSS,-58.8,0.0.0.0,(c3.m2.p2.v0),(2.0.0.3^7.4.0^0.5.0^3.0.0),(0.0.0^0.1.0),5.20"),
    ("PADINI", "2018-02-28", "PADINI,TSS,-51.29,0.0.0.0,(c3.m0.p1.v2),(2.3.0.0^7.4.8^0.5.0^3.0.2),(0.0.0^0.1.0),4.96"),
    ("PADINI", "2018-05-04", "PADINI,BBS,51.4,0.0.0.0,(c2.m0.p2.v2),(2.3.0.4^4.4.8^0.5.0^0.0.0),(0.0.0^0.2.0),4.50"),
    ("PADINI", "2018-07-02", "PADINI,TSS,-53.6,0.0.0.0,(c4.m2.p2.v0),(1.0.2.2^0.0.3^0.5.0^0.0.0),(0.0.0^0.2.0),5.88"),
    ("PADINI", "2018-07-04", "PADINI,TSS,-52.1,0.0.0.0,(c4.m4.p2.v2),(1.1.2.0^0.0.1^0.0.0^0.0.0),(0.0.0^0.2.0),5.90"),
    ("PADINI", "2018-09-07", "PADINI,TSS,-53.2,0.0.0.0,(c3.m1.p2.v2),(2.2.2.0^0.0.0^0.0.0^0.0.0),(0.0.0^0.2.0),5.82"),
    ("PADINI", "2018-11-02", "PADINI,TSS,-51.3,0.0.0.0,(c3.m0.p1.v2),(2.2.0.0^0.0.7^0.0.0^1.0.0),(0.1.0^0.0.0),5.52"),
    ("PARAMON", "2015-08-11", "PARAMON,TSS,-53.1,0.0.0.0,(c3.m2.p0.v2),(2.0.2.0^9.2.0^0.0.0^0.0.0),(0.0.0^0.1.2),1.76"),
    ("PARAMON", "2015-09-02", "PARAMON,BBS,53.3,0.0.0.0,(c1.m2.p0.v2),(2.0.2.2^9.2.2^0.0.0^0.0.0),(0.0.0^0.1.1),1.52"),
    ("PARAMON", "2015-09-28", "PARAMON,TSS,-56.-3,0.0.0.0,(c2.m2.p1.v2),(2.0.4.2^9.1.2^0.0.0^0.0.0),(0.0.0^0.2.1),1.66"),
])
@pytest.mark.topC
def test_topC_success(counter, tdate, expected):
    result = scanSignals("", 0, counter, loadjson(counter, tdate), 0)
    result, expected = matchpartial(result, expected, 2)
    assert result == expected, "*** Input = " + counter + "," + tdate


@pytest.mark.parametrize("counter,tdate,expected", [
    ("CARLSBG", "2015-03-16", "CARLSBG,TSS,-63.-1,0.0.0.0,(c2.m3.p4.v2),(4.0.1.2^0.1.1^1.0.0^0.0.0),(0.0.0^0.1.0),13.48"),
    ("DUFU", "2014-07-31", "DUFU,BBS,63.-1,0.0.0.0,(c3.m1.p4.v2),(4.0.1.0^9.7.2^1.0.9^6.0.0),(0.0.0^2.1.1),0.19"),
    ("DUFU", "2018-10-24", "DUFU,BBS,62.1,0.0.0.0,(c4.m2.p2.v2),(1.2.2.0^2.7.7^0.0.3^0.1.0),(0.0.2^0.0.0),1.73"),
    ("F&N", "2016-06-01", "F&N,BBS,62.1,0.0.0.0,(c4.m0.p2.v0),(1.3.2.3^8.1.7^0.0.0^5.0.0),(0.0.0^0.1.0),23.80"),
    ("F&N", "2018-04-02", "F&N,BBS,63.2,0.0.0.0,(c4.m2.p4.v2),(1.0.1.0^7.0.0^0.0.0^0.0.0),(0.0.0^0.1.2),33.40"),
    ("F&N", "2018-05-02", "F&N,BBS,63.3,0.0.0.0,(c4.m2.p4.v2),(1.0.1.0^0.0.0^0.0.0^0.0.0),(0.0.0^0.1.1),35.88"),
    ("KESM", "2013-10-02", "KESM,BBS,63.4,0.0.0.0,(c2.m2.p4.v2),(0.0.1.0^0.2.4^1.8.0^0.1.0),(0.0.0^0.1.2),1.88"),
    ("KESM", "2013-11-07", "KESM,BBS,61.1,0.0.0.0,(c2.m4.p3.v2),(0.1.2.0^0.2.0^1.8.0^0.1.0),(0.0.0^0.1.2),1.94"),
    ("KESM", "2013-11-13", "KESM,BBS,61.-1,0.0.0.0,(c3.m4.p4.v2),(0.1.1.0^0.2.0^1.8.0^0.1.0),(0.0.0^0.1.2),2.10"),
    ("KESM", "2013-12-03", "KESM,BBS,63.-3,0.0.0.0,(c3.m2.p4.v2),(0.0.1.0^0.2.0^1.8.0^0.1.0),(0.0.0^0.1.2),2.03"),
    ("KESM", "2014-05-02", "KESM,BBS,64.-3,0.0.0.0,(c4.m2.p2.v2),(1.0.0.0^0.2.2^0.0.0^3.0.0),(0.0.0^0.1.0),2.61"),
    ("KLSE", "2009-05-04", "KLSE,BBS,62.20,0.0.0.0,(c2.m2.p4.v2),(0.2.1.2^1.0.0^0.0.0^0.1.0),(0.0.0^0.1.0),1009.36"),
    ("KLSE", "2015-04-01", "KLSE,TSS,-67.-1,0.0.0.0,(c2.m2.p2.v0),(0.0.0.3^4.1.0^0.7.0^0.0.0),(0.0.0^0.1.0),1826.31"),
    ("KLSE", "2016-02-24", "KLSE,BBS,60.2,0.0.0.0,(c1.m2.p2.v2),(0.0.0.0^7.0.0^1.0.0^0.0.0),(0.0.0^0.1.0),1664.17"),
    ("KLSE", "2016-04-04", "KLSE,TSS,-60.2,0.0.0.0,(c2.m2.p2.v2),(0.0.0.0^7.0.0^1.0.0^0.0.0),(0.0.0^0.1.0),1725.24"),
    ("N2N", "2012-01-20", "N2N,BBS,62.1,0.0.0.0,(c2.m2.p4.v2),(0.0.1.0^2.2.0^2.0.0^5.0.0),(0.0.0^0.1.0),0.28"),
    ("F&N", "2016-06-01", "F&N,BBS,64.12,0.0.0.0,(c4.m0.p2.v0),(1.3.2.3^8.1.7^0.0.0^5.0.0),(0.0.0^0.1.0),23.80"),
    ("PADINI", "2009-07-29", "PADINI,BBS,60.1,0.0.0.0,(c2.m2.p2.v1),(0.0.0.0^0.7.0^0.0.0^0.0.0),(0.0.2^0.1.0),0.51"),
])
@pytest.mark.breakout
def test_breakout_success(counter, tdate, expected):
    result = scanSignals("", 0, counter, loadjson(counter, tdate), 0)
    result, expected = matchpartial(result, expected, 2)
    assert result == expected, "*** Input = " + counter + "," + tdate


@pytest.mark.parametrize("counter,tdate,expected", [
    ("CARLSBG", "2009-08-04", "CARLSBG,BBS,43.-50,0.0.0.0,(c3.m3.p4.v3),(0.0.1.2^5.7.0^1.9.9^0.0.0),(0.0.0^0.1.0),4.50"),
    ("CARLSBG", "2015-03-16", "CARLSBG,TSS,-63.-1,0.0.0.0,(c2.m3.p4.v2),(4.0.1.2^0.1.1^1.0.0^0.0.0),(0.0.0^0.1.0),13.48"),
    ("CARLSBG", "2018-03-02", "CARLSBG,TSS,-45.-1,0.0.0.0,(c4.m4.p4.v2),(1.1.1.0^0.5.8^0.0.9^0.0.0),(0.0.0^0.1.0),18.78"),
    ("DUFU", "2014-07-31", "DUFU,BBS,63.-1,0.0.0.0,(c3.m1.p4.v2),(4.0.1.0^9.7.2^1.0.9^6.0.0),(0.0.0^2.1.1),0.19"),
    ("DUFU", "2018-10-24", "DUFU,BBS,62.1,0.0.0.0,(c4.m2.p2.v2),(1.2.2.0^2.7.7^0.0.3^0.1.0),(0.0.2^0.0.0),1.73"),
    ("F&N", "2016-06-01", "F&N,BBS,62.1,0.0.0.0,(c4.m0.p2.v0),(1.3.2.3^8.1.7^0.0.0^5.0.0),(0.0.0^0.1.0),23.80"),
    ("F&N", "2018-04-02", "F&N,BBS,63.2,0.0.0.0,(c4.m2.p4.v2),(1.0.1.0^7.0.0^0.0.0^0.0.0),(0.0.0^0.1.2),33.40"),
    ("F&N", "2018-05-02", "F&N,BBS,63.3,0.0.0.0,(c4.m2.p4.v2),(1.0.1.0^0.0.0^0.0.0^0.0.0),(0.0.0^0.1.1),35.88"),
    ("GKENT", "2013-07-15", "GKENT,TSS,-63.105,0.0.0.0,(c3.m2.p4.v3),(4.0.1.0^0.0.1^0.0.0^0.2.0),(0.0.0^0.1.2),0.48"),
    ("KESM", "2013-10-02", "KESM,BBS,63.4,0.0.0.0,(c2.m2.p4.v2),(0.0.1.0^0.2.4^1.8.0^0.1.0),(0.0.0^0.1.2),1.88"),
    ("KESM", "2013-11-07", "KESM,BBS,61.1,0.0.0.0,(c2.m4.p3.v2),(0.1.2.0^0.2.0^1.8.0^0.1.0),(0.0.0^0.1.2),1.94"),
    ("KESM", "2013-11-13", "KESM,BBS,61.-1,0.0.0.0,(c3.m4.p4.v2),(0.1.1.0^0.2.0^1.8.0^0.1.0),(0.0.0^0.1.2),2.10"),
    ("KESM", "2013-12-03", "KESM,BBS,63.-3,0.0.0.0,(c3.m2.p4.v2),(0.0.1.0^0.2.0^1.8.0^0.1.0),(0.0.0^0.1.2),2.03"),
    ("KESM", "2014-05-02", "KESM,BBS,64.-3,0.0.0.0,(c4.m2.p2.v2),(1.0.0.0^0.2.2^0.0.0^3.0.0),(0.0.0^0.1.0),2.61"),
    ("KESM", "2016-07-08", "KESM,BBS,43.40,0.0.0.0,(c4.m4.p4.v2),(1.1.1.2^4.4.0^0.6.1^0.0.0),(0.0.2^0.1.0),5.72"),
    ("KLSE", "2009-05-04", "KLSE,BBS,62.20,0.0.0.0,(c2.m2.p4.v2),(0.2.1.2^1.0.0^0.0.0^0.1.0),(0.0.0^0.1.0),1009.36"),
    ("KLSE", "2015-04-01", "KLSE,TSS,-67.-1,0.0.0.0,(c2.m2.p2.v0),(0.0.0.3^4.1.0^0.7.0^0.0.0),(0.0.0^0.1.0),1826.31"),
    ("KLSE", "2016-02-24", "KLSE,BBS,60.2,0.0.0.0,(c1.m2.p2.v2),(0.0.0.0^7.0.0^1.0.0^0.0.0),(0.0.0^0.1.0),1664.17"),
    ("KLSE", "2016-04-04", "KLSE,TSS,-60.2,0.0.0.0,(c2.m2.p2.v2),(0.0.0.0^7.0.0^1.0.0^0.0.0),(0.0.0^0.1.0),1725.24"),
    ("KLSE", "2018-01-03", "KLSE,BBS,45.21,0.0.0.0,(c4.m4.p4.v2),(1.1.1.0^8.6.1^0.0.0^5.0.0),(0.0.0^0.1.0),1792.79"),
    ("N2N", "2012-01-20", "N2N,BBS,62.1,0.0.0.0,(c2.m2.p4.v2),(0.0.1.0^2.2.0^2.0.0^5.0.0),(0.0.0^0.1.0),0.28"),
    ("F&N", "2016-06-01", "F&N,BBS,64.12,0.0.0.0,(c4.m0.p2.v0),(1.3.2.3^8.1.7^0.0.0^5.0.0),(0.0.0^0.1.0),23.80"),
    ("PADINI", "2009-07-29", "PADINI,BBS,60.1,0.0.0.0,(c2.m2.p2.v1),(0.0.0.0^0.7.0^0.0.0^0.0.0),(0.0.2^0.1.0),0.51"),
])
@pytest.mark.uptrend
def test_uptrend_success(counter, tdate, expected):
    result = scanSignals("", 0, counter, loadjson(counter, tdate), 0)
    result, expected = matchpartial(result, expected, 2)
    assert result == expected, "*** Input = " + counter + "," + tdate


@pytest.mark.parametrize("counter,tdate,expected", [
    # ("CARLSBG", "2014-02-05", "CARLSBG,BBS,90.8,0.0.0.0,(c1.m1.p1.v4),(0.0.0.1^4.1.0^0.0.1^0.0.0),(0.2.0^0.0.0),11.10"),
    # ("CARLSBG", "2014-02-25", "CARLSBG,BBS,90.-8,0.0.0.0,(c2.m2.p2.v2),(0.0.0.0^4.2.0^0.0.3^0.0.0),(0.2.0^0.0.0),13.18"),
    # ("CARLSBG", "2014-04-24", "CARLSBG,TSS,-90.8,0.0.0.0,(c2.m4.p2.v2),(0.1.0.0^4.2.0^0.0.3^0.0.0),(0.0.0^0.0.0),13.46"),
    ("CARLSBG", "2015-05-06", "CARLSBG,TSS,-90.2,0.0.0.0,(c2.m2.p2.v0),(0.2.2.2^1.1.1^1.0.0^0.0.0),(0.0.0^0.1.0),13.14"),
    ("CARLSBG", "2017-10-03", "CARLSBG,BBS,90.17,0.0.0.0,(c3.m2.p2.v0),(0.0.0.2^4.5.0^0.0.9^0.0.1),(0.0.2^0.1.0),14.88"),
    ("CARLSBG", "2017-11-01", "CARLSBG,BBS,90.-17,0.0.0.0,(c4.m2.p2.v0),(1.0.0.2^0.7.0^0.0.0^0.0.1),(0.0.2^0.1.0),15.80"),
    ("DUFU", "2014-03-06", "DUFU,BBS,90.5,0.0.0.0,(c0.m3.p2.v2),(3.0.0.0^9.7.0^0.0.0^6.0.0),(0.0.0^1.1.1),0.13"),
    ("DUFU", "2018-08-02", "DUFU,BBS,90.1,0.0.0.0,(c3.m4.p4.v4),(0.1.1.1^7.7.0^2.0.9^0.0.0),(0.0.1^0.0.0),0.91"),
    ("F&N", "2008-10-03", "F&N,BBS,-90.11,0.0.0.0,(c4.m2.p2.v4),(1.0.0.1^9.0.8^0.0.2^5.0.0),(0.0.0^1.1.0),9.10"),
    ("F&N", "2009-03-18", "F&N,BBS,90.11,0.0.0.0,(c2.m2.p0.v2),(0.0.3.0^9.0.0^0.0.2^5.0.0),(0.0.0^1.1.2),7.90"),
    ("F&N", "2009-06-16", "F&N,BBS,90.14,0.0.0.0,(c4.m2.p2.v2),(1.0.0.0^9.3.0^0.0.0^0.0.0),(0.0.0^1.2.0),9.10"),
    ("KESM", "2013-05-13", "KESM,BBS,90.-1,0.0.0.0,(c1.m4.p2.v2),(4.1.0.0^0.2.0^1.6.0^0.0.0),(0.0.2^0.0.0),1.80"),
    ("KESM", "2014-04-02", "KESM,BBS,90.3,0.0.0.0,(c3.m2.p2.v0),(2.2.2.2^3.2.1^0.0.0^0.0.0),(0.0.0^0.1.0),2.40"),
    ("KESM", "2015-01-19", "KESM,BBS,90.7,0.0.0.0,(c2.m1.p1.v2),(2.4.4.0^6.6.0^0.0.0^1.0.3),(0.1.1^0.0.0),2.41"),
    ("KESM", "2018-03-16", "KESM,TSS,-90.1,0.0.0.0,(c3.m2.p2.v2),(0.0.0.0^4.4.4^0.0.0^0.0.0),(0.0.0^0.2.0),19.88"),
    ("KESM", "2018-05-03", "KESM,TSS,-90.-15,0.0.0.0,(c2.m2.p1.v0),(2.4.4.2^4.6.0^0.0.0^0.0.0),(0.0.0^0.0.0),15.98"),
    ("KLSE", "2009-07-07", "KLSE,BBS,90.2,0.0.0.0,(c2.m2.p2.v0),(0.2.2.2^1.1.0^1.0.0^0.0.0),(0.0.0^0.1.0),1066.36"),
    # ("KLSE", "2011-05-05", "KLSE,BBS,90.6,0.0.0.0,(c3.m2.p2.v1),(0.0.0.0^6.4.4^0.0.0^0.0.0),(0.0.1^0.2.0),1521.18"),
    ("KLSE", "2011-07-04", "KLSE,TSS,-90.6,0.0.0.0,(c4.m4.p2.v1),(1.1.0.0^4.4.4^0.0.0^0.0.0),(0.0.0^0.1.0),1582.35"),
    ("KLSE", "2011-10-10", "KLSE,BBS,90.15,0.0.0.0,(c2.m2.p1.v0),(2.4.4.2^6.4.0^0.0.0^0.0.0),(0.0.0^0.2.0),1397.04"),
    ("KLSE", "2011-11-09", "KLSE,BBS,52.-4,0.0.0.0,(c2.m2.p4.v1),(0.4.1.0^6.4.0^0.0.0^0.0.1),(0.0.1^0.2.0),1489.64"),
    ("KLSE", "2012-04-16", "KLSE,TSS,90.-16,0.0.0.0,(c4.m3.p2.v0),(1.0.0.2^2.0.0^0.0.0^0.0.0),(0.0.2^0.1.0),1597.51"),
    ("KLSE", "2018-07-02", "KLSE,BBS,90.2,0.0.0.0,(c1.m0.p0.v0),(2.3.2.2^0.8.8^0.0.0^5.0.0),(0.0.0^0.1.0),1685.05"),
    ("N2N", "2012-08-01", "N2N,BBS,90.-18,0.0.0.0,(c4.m2.p2.v4),(1.0.0.1^4.0.0^0.0.2^5.0.0),(0.0.0^0.1.0),0.59"),
    ("PADINI", "2011-11-01", "PADINI,BBS,90.2,0.0.0.0,(c2.m2.p4.v2),(0.0.1.0^4.4.4^0.0.0^0.0.0),(0.0.0^0.2.0),1.02"),
    ("PADINI", "2011-11-09", "PADINI,BBS,90.2,0.0.0.0,(c2.m2.p3.v3),(0.0.4.0^4.4.4^0.0.0^0.0.0),(0.0.0^0.2.0),1.00"),
    ("PADINI", "2012-08-09", "PADINI,TSS,-90.-9,0.0.0.0,(c4.m2.p2.v2),(1.0.0.0^4.0.0^0.6.0^3.0.0),(0.0.0^0.1.0),2.10"),
    ("PADINI", "2012-08-23", "PADINI,TSS,-90.9,0.0.0.0,(c4.m2.p2.v2),(1.0.0.0^4.0.4^0.6.0^3.0.0),(0.0.0^0.1.0),2.36"),
    ("PADINI", "2014-02-04", "PADINI,BBS,90.10,0.0.0.0,(c1.m0.p0.v2),(0.3.3.0^5.0.7^2.9.0^0.0.0),(0.0.0^0.0.1),1.59"),
    ("PADINI", "2019-01-02", "PADINI,TSS,-90.15,0.0.0.0,(c2.m1.p1.v0),(2.4.4.2^8.0.7^0.0.0^1.0.0),(0.1.2^0.0.0),3.50"),
    ("PARAMON", "2015-08-21", "PARAMON,BBS,53.1,0.0.0.0,(c2.m2.p0.v2),(2.2.2.2^9.2.2^0.0.0^0.0.0),(0.0.0^0.1.1),1.53"),
])
@pytest.mark.extremes
def test_extremes_success(counter, tdate, expected):
    result = scanSignals("", 0, counter, loadjson(counter, tdate), 0)
    result, expected = matchpartial(result, expected, 2)
    assert result == expected, "*** Input = " + counter + "," + tdate


def matchpartial(res, exp, partialmatch=2):
    newexp = []
    newres = res.replace('\t', '')
    # endpos = partialmatch + 1
    if partialmatch:
        tmpres = newres.split(",")
        tmpexp = exp.split(",")
        newres = []
        val1 = tmpres[2].split(".")
        val2 = tmpexp[2].split(".")
        for i in range(len(val1)):
            if int(val1[i]) > 0:
                newres.append(1)
            elif int(val1[i]) < 0:
                newres.append(-1)
            else:
                newres.append(0)
            if int(val2[i]) > 0:
                newexp.append(1)
            elif int(val2[i]) < 0:
                newexp.append(-1)
            else:
                newexp.append(0)
        # newres = ",".join(tmpres[:endpos])
        # newexp = ",".join(tmpexp[:endpos])
    else:
        newexp = exp
    return newres, newexp
