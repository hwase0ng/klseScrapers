
'''
Created on Nov 15, 2018

@author: hwase0ng
'''

from mvpsignals import scanSignals
import pytest
import settings as S
from common import loadCfg


def setup_module():
    loadCfg(S.DATA_DIR)


# DUFU,2018-07-25 BRV1, 2018-07-31 BRV2
# PADINI,2011-10-12,BRV,2,0 with low V
@pytest.mark.parametrize("counter,pnlist,lasttxn,expected", [
    ("PADINI", [[[['2014-05-04', '2014-07-27', '2014-09-14', '2014-11-09', '2014-12-28', '2015-02-22', '2015-04-12', '2015-06-07'], ['2014-05-04', '2014-06-15', '2014-08-03', '2014-09-28', '2014-11-09', '2015-02-01', '2015-04-12', '2015-06-07', '2015-07-26'], ['2014-05-04', '2014-07-27', '2014-10-05', '2014-11-30', '2015-02-22', '2015-04-12', '2015-06-07'], ['2014-05-04', '2014-06-29', '2014-09-07', '2014-10-26', '2014-12-21', '2015-02-08', '2015-04-05', '2015-05-24', '2015-07-12']], [['2014-06-15', '2014-08-31', '2014-10-26', '2015-01-18', '2015-03-15', '2015-05-24', '2015-07-19'], ['2014-05-18', '2014-07-20', '2014-09-07', '2014-10-26', '2015-01-04', '2015-03-22', '2015-05-31', '2015-07-12'], ['2014-06-15', '2014-09-07', '2014-10-26', '2014-12-21', '2015-02-08', '2015-05-10', '2015-07-19'], ['2014-05-18', '2014-07-27', '2014-09-28', '2014-11-23', '2015-01-04', '2015-03-08', '2015-05-17', '2015-08-02']], [[2.02, 1.9939999999999998, 1.924, 1.842, 1.5075, 1.4466666666666665, 1.442, 1.4133333333333333], [7.75, 9.8, 10.333333333333334, 7.8, 8.8, 4.4, 11.4, 7.0, 7.6], [0.0325, 0.034, -0.02, -0.01, 0.013333333333333334, 0.03, 0.016666666666666666], [-0.405, 0.492, 1.0524999999999998, 3.2099999999999995, 0.834, 1.5199999999999998, -0.312, 1.9920000000000002, 1.2639999999999998]], [[1.886, 1.888, 1.6966666666666665, 1.406, 1.3719999999999999, 1.376, 1.2974999999999999], [4.5, 8.25, 5.25, 6.0, 3.75, 7.0, 6.0, 5.8], [-0.044, -0.045, -0.10333333333333333, -0.152, -0.05000000000000001, -0.042499999999999996, -0.0675], [-0.64, -0.7699999999999999, -0.8859999999999999, -0.696, -0.3825, -0.792, -0.6275, -0.732]]], [[['2014-05-11', '2014-08-03', '2014-11-09', '2015-02-01', '2015-04-12'], ['2014-07-06', '2014-11-09', '2015-04-12', '2015-07-05'], ['2014-05-11', '2014-08-03', '2014-11-23', '2015-04-12'], ['2014-06-22', '2014-11-09', '2015-02-15', '2015-04-26', '2015-07-19']], [['2014-06-22', '2014-10-26', '2015-01-18', '2015-03-29', '2015-07-19'], ['2014-05-25', '2014-09-14', '2015-01-18', '2015-05-10', '2015-07-19'], ['2014-06-22', '2014-10-26', '2015-01-04', '2015-03-29', '2015-07-19'], ['2014-05-11', '2014-08-17', '2015-01-04', '2015-03-15', '2015-07-05']], [[1.9966666666666666, 1.9899999999999998, 1.8190000000000002, 1.45, 1.4419999999999997], [10.0, 7.8, 11.3, 7.333333333333333], [0.017777777777777778, 0.02875, -0.022, 0.02], [0.006999999999999995, 1.9409999999999996, 1.0550000000000002, 0.35, 0.8622222222222222]], [[1.8980000000000004, 1.74375, 1.4240000000000002, 1.3969999999999998, 1.3100000000000003], [5.333333333333333, 5.666666666666667, 4.2, 7.25, 5.888888888888889], [-0.039, -0.0825, -0.13375, -0.026000000000000002, -0.05777777777777778], [-0.5077777777777777, -0.701, -0.31375, -0.651, -0.10999999999999999]]], [[['2014-07-31', '2014-11-30', '2015-04-30'], ['2014-06-30', '2014-11-30', '2015-04-30'], ['2014-07-31', '2014-11-30', '2015-04-30'], ['2014-06-30', '2014-10-31', '2015-02-28', '2015-06-30']], [['2014-06-30', '2014-10-31', '2015-03-31', '2015-07-31'], ['2014-05-31', '2014-09-30', '2015-01-31', '2015-06-30'], ['2014-06-30', '2014-12-31', '2015-07-31'], ['2014-07-31', '2015-03-31']], [[1.97, 1.7785000000000004, 1.4195454545454542], [9.523809523809524, 6.75, 9.409090909090908], [0.021, -0.0175, 0.009999999999999997], [0.029047619047619058, 1.0018749999999998, 0.2931250000000001, 0.4358333333333333]], [[1.9233333333333331, 1.7743749999999998, 1.4063636363636365, 1.3280952380952382], [6.3, 6.352941176470588, 4.190476190476191, 6.75], [-0.027619047619047623, -0.11954545454545454, -0.03904761904761906], [-0.49000000000000005, -0.5495454545454547]]]], ['2015-08-07', 1.33, 1.352, 7.8, 0.012, -0.5820000000000001], "PADINI,BRV,7,1,(c1000100,m0000000,p3000000,v0100000)"),
    ("DUFU", [[[['2017-05-28', '2017-07-30', '2017-09-10', '2017-10-29', '2018-01-14', '2018-03-04', '2018-05-20'], ['2017-05-21', '2017-08-27', '2017-10-29', '2017-12-31', '2018-03-04', '2018-04-22', '2018-07-22'], ['2017-05-21', '2017-09-10', '2017-11-05', '2018-01-14', '2018-03-04', '2018-05-20', '2018-07-08'], ['2017-05-28', '2017-07-09', '2017-08-20', '2017-10-29', '2017-12-10', '2018-03-11', '2018-06-03']], [['2017-06-04', '2017-07-16', '2017-10-08', '2017-12-10', '2018-02-11', '2018-04-08', '2018-06-03', '2018-07-15'], ['2017-07-02', '2017-10-01', '2017-12-10', '2018-02-04', '2018-04-01', '2018-05-13', '2018-07-01'], ['2017-07-16', '2017-09-03', '2017-10-15', '2017-12-10', '2018-02-11', '2018-04-08', '2018-07-01'], ['2017-05-21', '2017-07-02', '2017-10-15', '2017-12-24', '2018-02-18', '2018-04-29', '2018-07-01']], [[1.5340000000000003, 1.3799999999999997, 1.5225, 1.444, 1.254, 1.166, 1.132], [10.0, 10.4, 7.4, 8.5, 7.4, 10.2, 8.2], [0.32199999999999995, 0.1125, 0.03, 0.066, -0.016, 0.062, -0.054000000000000006], [0.398, -0.278, 1.36, 0.42399999999999993, 2.8660000000000005, 0.03600000000000003, 0.22750000000000004]], [[1.418, 1.332, 1.3699999999999999, 1.09, 1.1320000000000001, 1.028, 1.04, 0.982], [4.666666666666667, 2.6, 4.0, 4.666666666666667, 5.8, 6.5, 6.0], [-0.098, 0.09999999999999999, -0.09400000000000001, -0.22400000000000003, -0.068, -0.096, -0.07], [-0.03599999999999998, -0.73, -0.6719999999999999, 0.16399999999999998, -0.8325, -0.6719999999999999, -0.7420000000000001]]], [[['2017-06-18', '2017-09-10', '2018-01-14', '2018-05-20'], ['2017-05-21', '2017-08-27', '2017-11-05', '2018-01-14', '2018-04-22'], ['2017-05-21', '2017-09-10', '2018-01-14', '2018-05-20'], ['2017-06-04', '2017-08-27', '2017-12-17', '2018-03-11', '2018-06-03']], [['2017-07-16', '2017-10-08', '2017-12-17', '2018-04-08', '2018-07-15'], ['2017-07-02', '2017-10-08', '2018-02-11', '2018-07-01'], ['2017-07-16', '2017-10-08', '2017-12-17', '2018-04-08', '2018-07-15'], ['2017-07-02', '2017-09-24', '2018-01-28', '2018-07-01']], [[1.5022222222222221, 1.5185714285714287, 1.2422222222222223, 1.1142857142857143], [9.666666666666666, 10.3, 7.1, 8.333333333333334, 9.0], [0.29555555555555557, 0.10714285714285714, 0.03666666666666667, 0.047142857142857146], [0.379, 1.0910000000000002, 1.9710000000000005, -0.009999999999999986, -0.046666666666666634]], [[1.36, 1.3710000000000004, 1.129, 1.052, 0.9969999999999999], [5.625, 2.6, 5.0, 6.2], [-0.08299999999999999, -0.07899999999999999, -0.189, -0.083, -0.06000000000000001], [-0.72875, -0.5833333333333334, -0.6930000000000001, -0.658]]], [[['2017-06-30', '2018-01-31', '2018-05-31'], ['2017-08-31', '2018-04-30'], ['2017-08-31', '2018-01-31', '2018-05-31'], ['2017-08-31', '2017-12-31']], [['2017-07-31', '2017-12-31', '2018-06-30'], ['2017-09-30', '2018-02-28', '2018-06-30'], ['2017-07-31', '2017-12-31', '2018-06-30'], ['2017-06-30', '2018-02-28', '2018-06-30']], [[1.4689473684210526, 1.2119047619047616, 1.0938888888888887], [9.045454545454545, 8.523809523809524], [0.04363636363636363, 0.030476190476190483, 0.022777777777777775], [0.47727272727272735, 1.3947368421052635]], [[1.3680952380952383, 1.1394736842105262, 1.0431578947368425], [4.111111111111111, 6.055555555555555, 6.368421052631579], [-0.06666666666666668, -0.1610526315789474, -0.044736842105263144], [-0.45368421052631575, -0.46166666666666667, -0.43105263157894735]]]], ['2018-07-25', 1.22, 1.0458333333333334, 7.277777777777778, -0.006111111111111113, 4.945555555555556], "DUFU,BRV,7,0,(c1000100,m0000000,p0000000,v4010000)"),
    ("DUFU", [[[['2017-05-28', '2017-07-30', '2017-09-10', '2017-10-29', '2018-01-14', '2018-03-04', '2018-05-20'], ['2017-05-21', '2017-08-27', '2017-10-29', '2017-12-31', '2018-03-04', '2018-04-22', '2018-07-22'], ['2017-05-21', '2017-09-10', '2017-11-05', '2018-01-14', '2018-03-04', '2018-05-20', '2018-07-08'], ['2017-05-28', '2017-07-09', '2017-08-20', '2017-10-29', '2017-12-10', '2018-03-11', '2018-06-03', '2018-07-29']], [['2017-06-04', '2017-07-16', '2017-10-08', '2017-12-10', '2018-02-11', '2018-04-08', '2018-06-03', '2018-07-15'], ['2017-07-02', '2017-10-01', '2017-12-10', '2018-02-04', '2018-04-01', '2018-05-13', '2018-07-01'], ['2017-07-16', '2017-09-03', '2017-10-15', '2017-12-10', '2018-02-11', '2018-04-08', '2018-07-01'], ['2017-05-21', '2017-07-02', '2017-10-15', '2017-12-24', '2018-02-18', '2018-04-29', '2018-07-01']], [[1.5340000000000003, 1.3799999999999997, 1.5225, 1.444, 1.254, 1.166, 1.132], [10.0, 10.4, 7.4, 8.5, 7.4, 10.2, 8.2], [0.32199999999999995, 0.1125, 0.03, 0.066, -0.016, 0.062, -0.054000000000000006], [0.398, -0.278, 1.36, 0.42399999999999993, 2.8660000000000005, 0.03600000000000003, 0.22750000000000004, 12.719999999999999]], [[1.418, 1.332, 1.3699999999999999, 1.09, 1.1320000000000001, 1.028, 1.04, 0.982], [4.666666666666667, 2.6, 4.0, 4.666666666666667, 5.8, 6.5, 6.0], [-0.098, 0.09999999999999999, -0.09400000000000001, -0.22400000000000003, -0.068, -0.096, -0.07], [-0.03599999999999998, -0.73, -0.6719999999999999, 0.16399999999999998, -0.8325, -0.6719999999999999, -0.7420000000000001]]], [[['2017-05-28', '2017-09-17', '2018-01-21', '2018-05-27'], ['2017-05-28', '2017-08-20', '2017-10-29', '2018-01-07', '2018-04-29'], ['2017-05-28', '2017-09-03', '2017-11-12', '2018-01-21', '2018-05-27'], ['2017-09-03', '2017-12-10', '2018-03-18', '2018-06-10']], [['2017-07-23', '2017-10-15', '2017-12-24', '2018-04-15', '2018-07-08'], ['2017-07-09', '2017-10-01', '2017-12-10', '2018-04-01', '2018-06-24'], ['2017-07-23', '2017-12-10', '2018-04-15', '2018-07-08'], ['2017-06-25', '2017-10-15', '2018-02-04', '2018-06-24']], [[1.5290000000000004, 1.5188888888888887, 1.2189999999999999, 1.1229999999999998], [9.7, 9.6, 7.0, 8.375, 10.1], [0.31999999999999995, 0.1025, 0.023, 0.053000000000000005, 0.049], [0.7437500000000001, 1.6666666666666667, -0.16599999999999998, -0.028888888888888877]], [[1.3510000000000002, 1.3699999999999999, 1.153, 1.048, 1.0139999999999998], [5.0, 2.7777777777777777, 4.222222222222222, 6.3, 6.25], [-0.084, -0.1611111111111111, -0.067, -0.06200000000000001], [-0.5711111111111111, -0.5860000000000001, -0.7487499999999999, -0.58375]]], [[['2017-09-30', '2018-01-31', '2018-05-31'], ['2017-08-31', '2018-04-30'], ['2017-08-31', '2018-01-31', '2018-05-31'], ['2017-08-31', '2017-12-31']], [['2017-07-31', '2017-12-31', '2018-06-30'], ['2017-09-30', '2018-02-28', '2018-06-30'], ['2017-07-31', '2017-12-31', '2018-06-30'], ['2017-06-30', '2018-02-28', '2018-06-30']], [[1.4633333333333334, 1.2119047619047616, 1.0938888888888887], [9.045454545454545, 8.523809523809524], [0.04363636363636363, 0.030476190476190483, 0.022777777777777775], [0.47727272727272735, 1.3947368421052635]], [[1.3680952380952383, 1.1394736842105262, 1.0431578947368425], [4.111111111111111, 6.055555555555555, 6.368421052631579], [-0.06666666666666668, -0.1610526315789474, -0.044736842105263144], [-0.45368421052631575, -0.46166666666666667, -0.43105263157894735]]]], ['2018-07-31', 1.28, 1.080681818181818, 7.545454545454546, 0.03272727272727272, 5.742272727272727], "DUFU,BRV,7,1,(c1000100,m0000000,p3000000,v4010000)"),
    ("PADINI", [[[['2010-08-08', '2010-09-19', '2010-11-21', '2011-01-16', '2011-03-06', '2011-05-01', '2011-06-19', '2011-09-04'], ['2010-07-18', '2010-09-12', '2010-11-21', '2011-01-02', '2011-02-20', '2011-04-24', '2011-07-24'], ['2010-07-18', '2010-10-03', '2010-11-14', '2011-01-16', '2011-03-13', '2011-05-01', '2011-06-19', '2011-07-31', '2011-09-25'], ['2010-08-08', '2010-10-10', '2010-11-28', '2011-01-09', '2011-05-01', '2011-06-19', '2011-09-04']], [['2010-07-25', '2010-09-26', '2010-12-05', '2011-01-23', '2011-03-27', '2011-05-29', '2011-07-10', '2011-10-02'], ['2010-08-15', '2010-10-17', '2010-12-05', '2011-02-06', '2011-03-27', '2011-06-05', '2011-08-28'], ['2010-08-22', '2010-10-31', '2010-12-26', '2011-03-27', '2011-07-10', '2011-08-28'], ['2010-07-04', '2010-08-22', '2010-10-03', '2010-12-19', '2011-02-13', '2011-04-10', '2011-07-03', '2011-08-21', '2011-10-09']], [[0.8048, 0.925, 1.0605, 1.19, 1.0899999999999999, 1.154, 1.114, 0.9275], [11.666666666666666, 13.0, 9.0, 11.0, 7.5, 12.4, 10.2], [0.09000000000000001, 0.16999999999999998, 0.10600000000000001, 0.198, -0.044000000000000004, 0.11599999999999999, 0.003999999999999998, 0.016, -0.08499999999999999], [4.966, 2.6100000000000003, -0.12, 4.658, 4.006, 1.084, 2.065]], [[0.7920000000000001, 0.8995000000000001, 0.9835, 1.1325, 1.014, 1.094, 1.052, 0.841], [7.75, 6.25, 4.75, 4.0, 3.0, 6.2, 3.4], [0.03666666666666667, 0.06666666666666667, -0.057999999999999996, -0.078, -0.046, -0.15000000000000002], [-0.21250000000000002, -0.6266666666666666, -0.97, -0.68, -0.85, -0.668, -0.798, 0.06, -0.8219999999999998]]], [[['2010-10-17', '2011-01-23', '2011-05-15', '2011-07-24'], ['2010-09-19', '2011-01-09', '2011-05-01', '2011-07-24'], ['2010-07-25', '2010-10-17', '2011-01-23', '2011-05-01', '2011-08-07'], ['2010-08-08', '2010-10-17', '2011-01-09', '2011-05-01', '2011-09-04']], [['2010-10-31', '2011-04-03', '2011-07-10', '2011-10-02'], ['2010-08-22', '2010-12-12', '2011-03-20', '2011-06-12', '2011-09-04'], ['2010-08-22', '2010-12-26', '2011-04-03', '2011-06-12', '2011-09-04'], ['2010-10-03', '2010-12-12', '2011-02-20', '2011-07-10']], [[0.9773333333333333, 1.1644444444444444, 1.1155555555555554, 1.076], [12.571428571428571, 10.333333333333334, 12.2, 9.9], [0.08166666666666667, 0.15333333333333332, 0.1722222222222222, 0.06799999999999999, 0.009], [4.302222222222223, 1.4833333333333334, 3.285555555555556, 2.0640000000000005, 2.0285714285714285]], [[0.9745000000000001, 1.03, 1.0560000000000003, 0.8616666666666667], [8.0, 5.0, 4.2, 6.2, 3.7142857142857144], [0.038571428571428576, -0.0525, -0.06000000000000001, -0.018, -0.1457142857142857], [-0.7916666666666666, -0.5587500000000001, -0.8000000000000002, -0.7040000000000001]]], [[['2011-01-31', '2011-05-31'], ['2010-09-30', '2011-04-30'], ['2010-09-30', '2011-01-31', '2011-05-31'], ['2010-08-31', '2011-01-31', '2011-05-31']], [['2010-12-31'], ['2010-10-31', '2011-03-31', '2011-09-30'], ['2010-08-31', '2011-03-31', '2011-09-30'], ['2010-09-30', '2011-02-28', '2011-06-30']], [[1.1570000000000003, 1.107], [11.533333333333333, 11.142857142857142], [0.12533333333333332, 0.14649999999999996, 0.03500000000000001], [2.1252941176470586, 1.8965000000000007, 1.3215000000000001]], [[1.0052222222222222], [6.833333333333333, 4.391304347826087, 5.315789473684211], [0.04941176470588237, -0.05695652173913044, -0.10210526315789475], [-0.5746666666666668, -0.72875, -0.11545454545454549]]]], ['2011-10-12', 1.02, 0.8887500000000002, 7.75, -0.03375, -0.68625], "PADINI,OVS,2,0,(c0100000,m0000000,p0000100,v0000000)"),
    ("DUFU", [[[['2014-06-22', '2014-08-10', '2014-09-28', '2014-11-30', '2015-02-08', '2015-04-19', '2015-06-07', '2015-07-26'], ['2014-06-22', '2014-08-10', '2014-09-28', '2014-11-16', '2015-02-15', '2015-05-24'], ['2014-06-22', '2014-08-10', '2014-09-28', '2014-11-30', '2015-02-08', '2015-04-19', '2015-06-07', '2015-07-26'], ['2014-06-15', '2014-08-10', '2014-09-28', '2014-11-30', '2015-02-01', '2015-04-19']], [['2014-05-04', '2014-07-06', '2014-10-19', '2014-12-21', '2015-03-08', '2015-05-10', '2015-07-05', '2015-08-23'], ['2014-06-08', '2014-09-07', '2014-10-19', '2014-12-21', '2015-04-12', '2015-07-19'], ['2014-05-04', '2014-07-13', '2014-09-14', '2014-11-09', '2015-01-04', '2015-03-08', '2015-07-05', '2015-08-16'], ['2014-06-08', '2014-08-31', '2014-11-02', '2014-12-28', '2015-03-22', '2015-05-10', '2015-06-21', '2015-08-02']], [[0.24299999999999997, 0.292, 0.273, 0.321, 0.3983333333333334, 0.422, 0.3666666666666667, 0.345], [11.6, 7.8, 9.0, 9.8, 11.4, 8.4], [0.156, 0.22000000000000003, 0.017999999999999995, 0.34400000000000003, 0.4666666666666666, 0.21200000000000002, -0.07, -0.07], [4.618, 0.6259999999999999, 2.8999999999999995, 19.768, 9.654, 2.962]], [[0.19374999999999998, 0.238, 0.227, 0.23899999999999996, 0.305, 0.365, 0.29, 0.27], [8.4, 5.5, 6.2, 5.8, 5.4, 2.0], [0.0375, 0.092, -0.148, -0.0675, -0.09500000000000001, -0.10200000000000001, -0.22, -0.18000000000000002], [-0.8, -0.8240000000000001, -0.8399999999999999, -0.91, -0.8099999999999999, -0.6, -0.91, -0.825]]], [[['2014-05-25', '2014-08-17', '2014-12-07', '2015-02-15', '2015-04-26', '2015-08-02'], ['2014-06-22', '2014-11-23', '2015-02-15', '2015-05-24'], ['2014-05-25', '2014-08-17', '2014-12-07', '2015-02-15', '2015-04-26', '2015-08-02'], ['2014-06-22', '2014-09-28', '2014-12-07', '2015-04-26']], [['2014-05-11', '2014-10-26', '2015-03-15', '2015-07-05'], ['2014-06-08', '2014-09-14', '2014-12-21', '2015-04-12', '2015-07-19'], ['2014-06-08', '2014-09-14', '2015-01-04', '2015-03-15', '2015-07-05'], ['2014-06-08', '2014-08-31', '2015-01-04', '2015-03-15', '2015-07-19']], [[0.21333333333333335, 0.2885000000000001, 0.30200000000000005, 0.3775, 0.421, 0.31666666666666665], [10.7, 9.4, 11.375, 7.8], [0.14, 0.18899999999999997, 0.25900000000000006, 0.35625, 0.18699999999999997, -0.14333333333333334], [3.585, 2.57, 14.416999999999998, 1.5290000000000001]], [[0.19444444444444445, 0.23062500000000002, 0.3275, 0.29875], [8.8, 6.0, 6.1, 5.9, 2.0], [0.091, -0.14666666666666664, -0.095, -0.06200000000000001, -0.19749999999999998], [-0.58, -0.792, -0.90375, -0.683, -0.78]]], [[['2014-08-31', '2015-04-30'], ['2014-06-30', '2015-01-31', '2015-05-31'], ['2014-07-31', '2015-02-28'], ['2014-06-30', '2014-11-30', '2015-04-30']], [['2014-10-31', '2015-03-31'], ['2014-08-31', '2014-12-31', '2015-07-31'], ['2014-09-30', '2015-03-31', '2015-07-31'], ['2014-05-31', '2014-10-31', '2015-03-31', '2015-07-31']], [[0.2769047619047618, 0.3986363636363635], [10.19047619047619, 10.571428571428571, 7.470588235294118], [0.14, 0.24749999999999997], [2.163333333333333, 7.680000000000001, 0.9427272727272729]], [[0.24300000000000002, 0.34568181818181815], [6.809523809523809, 6.7272727272727275, 2.111111111111111], [-0.0875, -0.00500000000000001, -0.17666666666666664], [0.6945000000000002, -0.5025, -0.4895454545454545, -0.7477777777777779]]]], ['2015-08-26', 0.275, 0.2789285714285714, 4.785714285714286, -0.16214285714285712, -0.5342857142857143], "DUFU,BRV,5,0,(c1001000,m0000100,p0000110,v0000100)"),
])
@pytest.mark.skip
def test_bottom_reversal_success(counter, pnlist, lasttxn, expected):
    result = scanSignals(0, counter, "", pnlist, lasttxn)
    assert result.replace('\t', '') == expected, "*** Input = " + counter + "," + lasttxn[0]


# AZRB,2018-11-15 - TopP
@pytest.mark.parametrize("counter,pnlist,lasttxn,expected", [
    ("PADINI", [[[['2014-04-20', '2014-06-01', '2014-07-27', '2014-09-14', '2014-11-09', '2014-12-28', '2015-02-22', '2015-04-12'], ['2014-03-16', '2014-06-15', '2014-08-03', '2014-09-28', '2014-11-09', '2015-02-01', '2015-04-12'], ['2014-03-23', '2014-05-04', '2014-07-27', '2014-10-05', '2014-11-30', '2015-02-22', '2015-04-12'], ['2014-03-23', '2014-05-04', '2014-06-29', '2014-09-07', '2014-10-26', '2014-12-21', '2015-02-08', '2015-04-05', '2015-05-24']], [['2014-03-30', '2014-06-15', '2014-08-31', '2014-10-26', '2015-01-18', '2015-03-15', '2015-05-24'], ['2014-05-18', '2014-07-20', '2014-09-07', '2014-10-26', '2015-01-04', '2015-03-22', '2015-05-31'], ['2014-04-27', '2014-06-15', '2014-09-07', '2014-10-26', '2014-12-21', '2015-02-08', '2015-05-10'], ['2014-03-30', '2014-05-18', '2014-07-27', '2014-09-28', '2014-11-23', '2015-01-04', '2015-03-08', '2015-05-17']], [[2.0700000000000003, 2.002, 1.9939999999999998, 1.924, 1.842, 1.5075, 1.4466666666666665, 1.442], [10.8, 9.8, 10.333333333333334, 7.8, 8.8, 4.4, 11.4], [0.238, 0.0325, 0.034, -0.02, -0.01, 0.013333333333333334, 0.03], [2.318, -0.405, 0.492, 1.0524999999999998, 3.2099999999999995, 0.834, 1.5199999999999998, -0.312, 1.9920000000000002]], [[1.8860000000000003, 1.886, 1.888, 1.6966666666666665, 1.406, 1.3719999999999999, 1.376], [4.5, 8.25, 5.25, 6.0, 3.75, 7.0, 6.0], [0.024, -0.044, -0.045, -0.10333333333333333, -0.152, -0.05000000000000001, -0.042499999999999996], [0.578, -0.64, -0.7699999999999999, -0.8859999999999999, -0.696, -0.3825, -0.792, -0.6275]]], [[['2014-04-20', '2014-08-10', '2014-11-16', '2015-02-08', '2015-04-19'], ['2014-08-10', '2014-11-16', '2015-04-19'], ['2014-03-23', '2014-07-27', '2014-11-16', '2015-04-19'], ['2014-03-23', '2014-06-29', '2014-11-02', '2015-02-08', '2015-05-31']], [['2014-04-06', '2014-06-15', '2014-11-02', '2015-03-22'], ['2014-05-18', '2014-09-07', '2015-01-25', '2015-05-31'], ['2014-06-15', '2014-09-07', '2014-12-28', '2015-03-22'], ['2014-05-18', '2014-10-05', '2014-12-14', '2015-03-08', '2015-05-17']], [[2.032, 1.9774999999999998, 1.814, 1.44375, 1.4359999999999997], [9.75, 8.3, 10.6], [0.215, 0.02888888888888889, -0.017, 0.029999999999999992], [1.9470000000000003, 0.26799999999999996, 2.22125, 0.7337499999999999, 0.9390000000000001]], [[1.9260000000000002, 1.911, 1.75875, 1.3719999999999999], [5.333333333333333, 5.888888888888889, 4.1, 6.6], [-0.036000000000000004, -0.044444444444444446, -0.1422222222222222, -0.044], [-0.6122222222222222, -0.8449999999999999, -0.35, -0.654, -0.29625]]], [[['2014-04-30', '2014-11-30', '2015-04-30'], ['2014-06-30', '2014-11-30', '2015-04-30'], ['2014-07-31', '2014-11-30', '2015-04-30'], ['2014-06-30', '2014-10-31', '2015-05-31']], [['2014-06-30', '2014-10-31', '2015-05-31'], ['2014-05-31', '2014-09-30', '2015-01-31'], ['2014-06-30', '2014-12-31', '2015-05-31'], ['2014-07-31', '2015-03-31']], [[2.011818181818182, 1.7785000000000004, 1.4195454545454542], [9.523809523809524, 6.75, 9.409090909090908], [0.021, -0.0175, 0.009999999999999997], [0.029047619047619058, 1.0018749999999998, 0.38999999999999996]], [[1.9233333333333331, 1.7743749999999998, 1.3827777777777774], [6.3, 6.352941176470588, 4.190476190476191], [-0.027619047619047623, -0.11954545454545454, -0.02888888888888889], [-0.49000000000000005, -0.5495454545454547]]]], ['2015-06-05', 1.4, 1.4133333333333333, 7.0, 0.016666666666666666, -0.06666666666666667], "PADINI,Dbg,0,0,(c1000100,m0000001,p3000000,v0000001)"),
    ("AZRB", [[[['2017-09-17', '2017-10-29', '2018-01-14', '2018-02-25', '2018-04-22', '2018-06-10', '2018-08-19', '2018-11-11'], ['2017-09-03', '2017-11-12', '2018-01-14', '2018-03-11', '2018-04-29', '2018-06-17', '2018-08-05', '2018-10-07'], ['2017-09-17', '2017-11-05', '2018-01-14', '2018-03-25', '2018-05-06', '2018-07-01', '2018-08-12', '2018-10-07'], ['2018-05-20', '2018-07-22']], [['2017-08-27', '2017-10-22', '2017-12-24', '2018-02-18', '2018-04-08', '2018-06-03', '2018-09-16', '2018-10-28'], ['2017-10-22', '2017-12-03', '2018-02-11', '2018-04-08', '2018-05-20', '2018-07-01', '2018-09-09', '2018-10-28'], ['2017-10-22', '2017-12-10', '2018-02-18', '2018-04-08', '2018-06-03', '2018-09-16', '2018-10-28'], None], [[1.1640000000000001, 1.152, 1.04, 0.8800000000000001, 0.7559999999999999, 0.418, 0.523, 0.36124999999999996], [11.0, 10.0, 9.2, 5.0, 9.25, 8.25, 8.6, 7.8], [0.06000000000000001, 0.016, 0.054000000000000006, -0.11, -0.005, -0.048, 0.306, -0.156], [215.196, 4.709999999999999]], [[1.078, 1.1150000000000002, 0.942, 0.8733333333333334, 0.6910000000000001, 0.37374999999999997, 0.39999999999999997, 0.326], [7.0, 5.0, 3.2, 4.2, 5.2, 6.6, 4.4, 5.2], [-0.035, -0.148, -0.13, -0.16799999999999998, -0.5, -0.21, -0.198], None]], [[['2017-09-17', '2018-01-21', '2018-04-29', '2018-08-19'], ['2017-09-03', '2017-11-12', '2018-01-21', '2018-06-24', '2018-10-14'], ['2017-09-17', '2018-01-21', '2018-05-13', '2018-08-19'], ['2018-05-27']], [['2017-10-15', '2017-12-24', '2018-04-15', '2018-07-08', '2018-10-28'], ['2017-12-10', '2018-02-18', '2018-05-27', '2018-09-16'], ['2017-12-24', '2018-03-04', '2018-05-27', '2018-10-28'], None], [[1.1588888888888889, 1.0145, 0.7483333333333333, 0.5155], [10.375, 9.1, 8.6, 8.222222222222221, 7.4], [0.05222222222222222, 0.043000000000000003, -0.006666666666666667, 0.276], [146.59499999999997]], [[1.121, 0.9564999999999999, 0.7094999999999999, 0.37700000000000006, 0.329], [5.222222222222222, 3.625, 5.5, 4.5], [-0.123, -0.145, -0.45199999999999996, -0.19699999999999998], None]], [[['2017-09-30', '2018-01-31', '2018-08-31'], ['2018-01-31', '2018-06-30'], ['2017-09-30', '2018-01-31', '2018-08-31'], ['2018-05-31']], [['2017-12-31', '2018-06-30', '2018-10-31'], ['2017-10-31', '2018-02-28', '2018-09-30'], ['2017-12-31', '2018-05-31', '2018-10-31'], None], [[1.1472222222222221, 0.9988095238095239, 0.4976190476190477], [7.714285714285714, 7.7], [0.04722222222222224, 0.021904761904761913, 0.1842857142857143], [88.28277777777778]], [[0.9594736842105261, 0.39899999999999997, 0.3450000000000001], [7.571428571428571, 3.588235294117647, 5.588235294117647], [-0.1205263157894737, -0.3355555555555555, -0.18739130434782614], None]]], ['2018-11-15', 0.355, 0.358, 8.6, -0.005000000000000001, -0.653], "AZRB,Dbg,0,0,(c1000100,m4010000,p0000010,v0100000)"),
])
@pytest.mark.skip
def test_bottom_reversal_fail(counter, pnlist, lasttxn, expected):
    result = scanSignals(1, counter, "", pnlist, lasttxn)
    assert result.replace('\t', '') == expected, "*** Input = " + counter + "," + lasttxn[0]


# DUFU 2014-11-21 OVS,8 (previously BRV3)
# DUFU 2016-11-01 BRV,12,0 powerful break out after final retrace
# PADINI 2017-02-016 OVS,8 (previously BRV3)
# KLSE 2017-12-12 OVS,8,1
@pytest.mark.parametrize("counter,pnlist,lasttxn,expected", [
    ("DUFU", [[[['2013-09-29', '2013-11-17', '2014-01-05', '2014-02-16', '2014-06-22', '2014-08-10', '2014-09-28'], ['2013-09-22', '2013-12-01', '2014-01-19', '2014-03-30', '2014-06-22', '2014-08-10', '2014-09-28', '2014-11-09'], ['2013-09-08', '2013-10-27', '2014-01-19', '2014-03-02', '2014-06-22', '2014-08-10', '2014-09-28'], ['2013-10-13', '2014-01-19', '2014-04-06', '2014-06-15', '2014-08-10', '2014-09-28']], [['2013-09-15', '2013-12-15', '2014-02-02', '2014-04-20', '2014-06-08', '2014-10-19'], ['2013-10-06', '2013-12-08', '2014-02-09', '2014-04-13', '2014-06-08', '2014-09-07', '2014-10-19'], ['2013-09-15', '2013-12-15', '2014-02-09', '2014-04-06', '2014-06-08', '2014-08-03', '2014-09-14', '2014-11-09'], ['2013-09-08', '2013-11-10', '2013-12-22', '2014-03-16', '2014-06-08', '2014-08-31', '2014-11-02']], [[0.197, 0.20600000000000002, 0.1975, 0.195, 0.24299999999999997, 0.292, 0.273], [11.0, 11.2, 12.666666666666666, 12.333333333333334, 11.6, 7.8, 9.0, 10.25], [-0.054000000000000006, 0.06000000000000001, 0.006666666666666667, 0.004000000000000001, 0.156, 0.22000000000000003, 0.017999999999999995], [37.116, 3.046666666666667, 2.84, 4.618, 0.6259999999999999, 2.8999999999999995]], [[0.1875, 0.194, 0.19, 0.186, 0.20800000000000002, 0.227], [8.0, 10.2, 9.5, 11.6, 8.4, 5.5, 6.2], [-0.0725, -0.054000000000000006, -0.025, -0.042, 0.06799999999999999, 0.17666666666666667, -0.148, -0.06], [-0.8620000000000001, -0.75, -0.898, -0.6875, -0.8, -0.8240000000000001, -0.8650000000000001]]], [[['2013-11-24', '2014-03-02', '2014-05-25', '2014-08-17'], ['2013-09-15', '2014-01-19', '2014-04-27', '2014-10-12'], ['2013-10-27', '2014-03-02', '2014-05-25', '2014-08-17'], ['2013-10-13', '2014-01-19', '2014-04-13', '2014-06-22', '2014-09-28']], [['2013-09-15', '2013-12-22', '2014-04-13', '2014-10-26'], ['2013-10-13', '2014-02-16', '2014-06-08', '2014-09-14'], ['2013-09-15', '2013-12-22', '2014-03-30', '2014-06-08', '2014-09-14'], ['2013-09-15', '2013-12-22', '2014-03-30', '2014-06-08', '2014-08-31', '2014-11-09']], [[0.20500000000000002, 0.1945, 0.21333333333333335, 0.2885000000000001], [10.555555555555555, 12.625, 11.9, 8.222222222222221], [0.060000000000000005, -1.7347234759768072e-19, 0.14, 0.18899999999999997], [23.681250000000002, 1.4837500000000001, 1.9499999999999997, 3.585, 2.57]], [[0.19055555555555556, 0.194, 0.1865, 0.23062500000000002], [8.375, 9.666666666666666, 8.8, 6.0], [-0.062222222222222213, -0.051000000000000004, -0.03428571428571429, 0.091, -0.14666666666666664], [-0.7733333333333334, -0.883, -0.5328571428571428, -0.58, -0.792, -0.7860000000000001]]], [[['2013-11-30', '2014-08-31'], ['2013-09-30', '2014-01-31', '2014-06-30'], ['2013-10-31', '2014-02-28', '2014-07-31'], ['2013-10-31', '2014-06-30']], [['2013-09-30', '2014-04-30', '2014-10-31'], ['2013-10-31', '2014-02-28', '2014-08-31'], ['2013-12-31', '2014-09-30'], ['2013-12-31', '2014-05-31', '2014-10-31']], [[0.20325000000000007, 0.2769047619047618], [10.38888888888889, 11.764705882352942, 10.19047619047619], [0.041904761904761924, -0.006315789473684211, 0.14], [9.526190476190475, 2.163333333333333]], [[0.1927777777777778, 0.18795454545454549, 0.24309523809523811], [8.952380952380953, 10.421052631578947, 6.809523809523809], [-0.04157894736842107, -0.0875], [-0.7699999999999999, 0.6945000000000002, -0.5257142857142857]]]], ['2014-11-21', 0.28, 0.24535714285714288, 9.785714285714286, 0.002142857142857137, 3.573571428571429], "DUFU,OVS,8,1,(c3000010,m0000100,p0000110,v3000000)"),
    ("DUFU", [[[['2015-10-25', '2016-01-17', '2016-02-28', '2016-04-17', '2016-05-29', '2016-07-17', '2016-10-02'], ['2015-09-13', '2015-10-25', '2015-12-06', '2016-02-28', '2016-04-17', '2016-05-29', '2016-07-17', '2016-09-04', '2016-10-16'], ['2015-09-27', '2015-12-27', '2016-02-07', '2016-04-17', '2016-06-12', '2016-10-02'], ['2015-08-30', '2015-10-25', '2015-12-13', '2016-02-07', '2016-04-10', '2016-05-29', '2016-07-17', '2016-09-11', '2016-10-30']], [['2015-08-23', '2015-10-18', '2016-01-31', '2016-03-13', '2016-05-01', '2016-06-19', '2016-09-04'], ['2015-10-04', '2015-11-15', '2015-12-27', '2016-02-14', '2016-05-08', '2016-06-19', '2016-08-07', '2016-10-09'], ['2015-08-23', '2015-10-18', '2015-12-20', '2016-01-31', '2016-03-13', '2016-05-01', '2016-06-26', '2016-09-04'], ['2015-09-13', '2015-11-15', '2016-02-14', '2016-04-24', '2016-06-05', '2016-07-31', '2016-09-18']], [[0.32599999999999996, 0.5730000000000001, 0.554, 0.501, 0.5509999999999999, 0.664, 0.6319999999999999], [10.4, 8.8, 11.8, 6.0, 8.6, 9.0, 10.4, 7.75, 5.8], [0.14250000000000002, 0.3466666666666667, 0.035, 0.024, 0.17800000000000002, 0.038000000000000006], [-0.22799999999999998, 2.0679999999999996, 4.683999999999999, 1.5525000000000002, -0.03600000000000003, 2.0500000000000003, -0.039999999999999994, -0.184, -0.5559999999999999]], [[0.27, 0.30625, 0.50625, 0.47000000000000003, 0.485, 0.584, 0.59], [7.0, 7.0, 7.666666666666667, 3.6666666666666665, 7.25, 8.4, 6.6, 5.5], [-0.16, 0.0, 0.23399999999999999, 0.0275, -0.1, -0.01, 0.10999999999999999, -0.0675], [-0.694, -0.39749999999999996, -0.7133333333333333, -0.746, 0.55, -0.46399999999999997, -0.6566666666666666]]], [[['2015-09-27', '2016-01-17', '2016-04-24', '2016-07-17', '2016-09-25'], ['2015-09-13', '2015-12-06', '2016-04-24', '2016-07-17'], ['2015-09-27', '2016-01-03', '2016-06-19', '2016-10-09'], ['2015-09-27', '2015-12-20', '2016-05-22', '2016-08-14']], [['2015-08-30', '2016-02-14', '2016-05-08', '2016-09-11'], ['2015-10-11', '2016-02-14', '2016-05-08', '2016-08-14', '2016-10-23'], ['2015-08-30', '2016-03-27', '2016-08-28'], ['2015-09-13', '2016-04-24', '2016-08-28']], [[0.314375, 0.5435, 0.49450000000000005, 0.651875, 0.6181249999999999], [10.222222222222221, 11.2, 8.5, 9.875], [0.125, 0.2914285714285714, 0.14400000000000004, 0.014444444444444447], [0.485, 3.283, 1.575, -0.20500000000000002]], [[0.27199999999999996, 0.5285714285714286, 0.4872222222222222, 0.6044444444444443], [7.1, 4.428571428571429, 8.0, 6.8, 5.7], [-0.15599999999999997, -0.08299999999999999, -0.049], [-0.48777777777777787, -0.6980000000000001, -0.5269999999999999]]], [[['2016-01-31', '2016-07-31'], ['2015-09-30', '2016-07-31'], ['2015-12-31', '2016-06-30'], ['2015-12-31', '2016-05-31', '2016-09-30']], [['2016-04-30'], ['2015-10-31', '2016-02-29', '2016-10-31'], ['2015-10-31', '2016-03-31', '2016-08-31'], ['2016-04-30', '2016-08-31']], [[0.5402631578947369, 0.6486842105263158], [9.1, 9.473684210526315], [0.27142857142857146, 0.1323809523809524], [2.5480952380952377, 1.2052380952380952, -0.3345]], [[0.490952380952381], [7.9523809523809526, 4.722222222222222, 6.15], [0.04047619047619049, -0.07434782608695654, -0.03500000000000001], [-0.5447619047619048, -0.3686363636363636]]]], ['2016-11-01', 0.575, 0.575, 7.0, -0.06, -0.61], "DUFU,BRV,12,0,(c3001001,m0000010,p0000000,v0100000)"),
    ("PADINI", [[[['2015-12-27', '2016-03-06', '2016-05-29', '2016-09-11', '2016-10-30', '2016-12-18', '2017-01-29'], ['2015-12-27', '2016-03-06', '2016-05-15', '2016-06-26', '2016-08-14', '2016-10-23', '2017-01-01', '2017-02-19'], ['2015-12-27', '2016-02-07', '2016-03-27', '2016-05-15', '2016-08-14', '2016-10-30', '2017-01-08'], ['2016-01-24', '2016-03-13', '2016-05-08', '2016-07-17', '2016-08-28', '2016-10-23', '2016-12-04', '2017-01-22']], [['2016-01-10', '2016-04-17', '2016-06-26', '2016-08-28', '2016-10-16', '2016-12-11', '2017-01-22'], ['2016-01-03', '2016-03-20', '2016-05-22', '2016-07-10', '2016-09-04', '2016-11-20', '2017-01-22'], ['2016-01-24', '2016-03-20', '2016-06-26', '2016-08-28', '2016-10-16', '2016-12-04', '2017-01-22'], ['2016-01-03', '2016-02-21', '2016-04-03', '2016-05-29', '2016-07-10', '2016-10-02', '2016-11-20', '2017-01-01', '2017-02-19']], [[1.97, 2.16, 2.3840000000000003, 3.008, 2.922, 2.605, 2.4520000000000004], [8.666666666666666, 10.4, 8.0, 5.5, 11.0, 9.0, 7.25, 9.8], [0.20666666666666667, 0.1025, -0.0275, 0.156, 0.186, 0.02, -0.037500000000000006], [1.0379999999999998, -0.22799999999999998, 2.0775, 0.48, 0.738, 0.9339999999999999, 2.962, 2.302]], [[1.8559999999999999, 1.964, 2.2675, 2.7340000000000004, 2.7640000000000002, 2.58, 2.396], [7.75, 6.8, 6.6, 3.6666666666666665, 5.5, 6.4, 5.0], [0.017999999999999995, -0.052000000000000005, -0.035, 0.044, -0.06000000000000001, -0.096, -0.074], [-0.5825, -0.33399999999999996, -0.7939999999999999, -0.29, -0.8700000000000001, -0.636, -0.404, -0.865, 0.062]]], [[['2015-12-27', '2016-03-06', '2016-05-29', '2016-09-18'], ['2015-12-13', '2016-03-06', '2016-05-15', '2016-08-07', '2016-10-30', '2017-02-19'], ['2015-12-27', '2016-05-15', '2016-08-21', '2016-11-13'], ['2016-02-07', '2016-05-01', '2016-09-04', '2016-12-11']], [['2016-01-10', '2016-04-17', '2016-06-26', '2016-10-16', '2017-02-05'], ['2016-01-10', '2016-04-03', '2016-07-10', '2016-10-16', '2017-01-22'], ['2016-01-24', '2016-04-17', '2016-06-26', '2016-09-04', '2016-12-11'], ['2016-01-10', '2016-04-03', '2016-07-10', '2016-10-02', '2017-01-08']], [[1.91875, 2.15, 2.3419999999999996, 2.9825000000000004], [8.3, 10.0, 7.888888888888889, 10.4, 8.9, 9.444444444444445], [0.18, 0.12666666666666662, 0.14900000000000002, 0.016], [0.7325, 1.4360000000000002, 0.5855555555555555, 2.402]], [[1.8677777777777775, 1.9989999999999999, 2.281111111111111, 2.7655555555555558, 2.4325], [8.0, 7.111111111111111, 3.8333333333333335, 7.0, 5.7], [0.036000000000000004, -0.03599999999999999, -0.023333333333333334, 0.06444444444444444, -0.096], [-0.12444444444444443, -0.7311111111111112, -0.5933333333333333, -0.583, -0.73625]]], [[['2016-05-31', '2016-09-30'], ['2016-01-31', '2016-08-31'], ['2015-12-31', '2016-05-31', '2016-11-30'], ['2016-01-31', '2016-05-31']], [['2016-03-31', '2017-01-31'], ['2016-06-30', '2017-01-31'], ['2016-03-31', '2016-12-31'], ['2016-03-31', '2016-09-30']], [[2.3199999999999994, 2.9225000000000008], [8.947368421052632, 8.909090909090908], [0.15857142857142859, 0.1219047619047619, -0.013636363636363636], [0.58, 0.6052380952380952]], [[2.0572727272727276, 2.4675000000000007], [5.7368421052631575, 6.3], [-0.01090909090909091, -0.08000000000000002], [-0.5322727272727272, -0.4334999999999999]]]], ['2017-02-22', 2.73, 2.4921428571428565, 8.857142857142858, -0.0007142857142857149, 1.147142857142857], "PADINI,OVS,8,1,(c3000010,m0000000,p0000100,v4010000)"),
    ("PADINI", [[[['2015-12-27', '2016-03-06', '2016-05-29', '2016-09-11', '2016-10-30', '2016-12-18', '2017-01-29'], ['2015-12-27', '2016-03-06', '2016-05-15', '2016-06-26', '2016-08-14', '2016-10-23', '2017-01-01'], ['2015-12-27', '2016-02-07', '2016-03-27', '2016-05-15', '2016-08-14', '2016-10-30', '2017-01-08'], ['2015-12-06', '2016-01-24', '2016-03-13', '2016-05-08', '2016-07-17', '2016-08-28', '2016-10-23', '2016-12-04', '2017-01-22']], [['2015-11-22', '2016-01-10', '2016-04-17', '2016-06-26', '2016-08-28', '2016-10-16', '2016-12-11', '2017-01-22'], ['2016-01-03', '2016-03-20', '2016-05-22', '2016-07-10', '2016-09-04', '2016-11-20', '2017-01-22'], ['2015-11-29', '2016-01-24', '2016-03-20', '2016-06-26', '2016-08-28', '2016-10-16', '2016-12-04', '2017-01-22'], ['2016-01-03', '2016-02-21', '2016-04-03', '2016-05-29', '2016-07-10', '2016-10-02', '2016-11-20', '2017-01-01']], [[1.97, 2.16, 2.3840000000000003, 3.008, 2.922, 2.605, 2.4520000000000004], [8.666666666666666, 10.4, 8.0, 5.5, 11.0, 9.0, 7.25], [0.20666666666666667, 0.1025, -0.0275, 0.156, 0.186, 0.02, -0.037500000000000006], [1.008, 1.0379999999999998, -0.22799999999999998, 2.0775, 0.48, 0.738, 0.9339999999999999, 2.962, 2.302]], [[1.598, 1.8559999999999999, 1.964, 2.2675, 2.7340000000000004, 2.7640000000000002, 2.58, 2.396], [7.75, 6.8, 6.6, 3.6666666666666665, 5.5, 6.4, 5.0], [0.062, 0.017999999999999995, -0.052000000000000005, -0.035, 0.044, -0.06000000000000001, -0.096, -0.074], [-0.5825, -0.33399999999999996, -0.7939999999999999, -0.29, -0.8700000000000001, -0.636, -0.404, -0.865]]], [[['2015-12-27', '2016-03-06', '2016-05-29', '2016-09-18'], ['2016-03-06', '2016-05-15', '2016-08-07', '2016-10-30', '2017-01-08'], ['2015-12-27', '2016-05-15', '2016-08-21', '2016-11-13'], ['2016-02-07', '2016-05-01', '2016-09-04', '2016-12-11']], [['2015-11-29', '2016-04-17', '2016-06-26', '2016-10-16'], ['2016-01-10', '2016-04-03', '2016-07-10', '2016-10-16', '2017-01-22'], ['2016-01-24', '2016-04-17', '2016-06-26', '2016-09-04', '2016-12-11'], ['2016-01-10', '2016-04-03', '2016-07-10', '2016-10-02', '2017-01-08']], [[1.91875, 2.15, 2.3419999999999996, 2.9825000000000004], [10.0, 7.888888888888889, 10.4, 8.9, 7.0], [0.18, 0.12666666666666662, 0.14900000000000002, 0.016], [0.7325, 1.4360000000000002, 0.5855555555555555, 2.402]], [[1.6, 1.9989999999999999, 2.281111111111111, 2.7655555555555558], [8.0, 7.111111111111111, 3.8333333333333335, 7.0, 5.7], [0.036000000000000004, -0.03599999999999999, -0.023333333333333334, 0.06444444444444444, -0.096], [-0.12444444444444443, -0.7311111111111112, -0.5933333333333333, -0.583, -0.73625]]], [[['2016-05-31', '2016-09-30'], ['2016-01-31', '2016-08-31'], ['2015-12-31', '2016-05-31', '2016-11-30'], ['2016-01-31', '2016-05-31']], [['2016-03-31'], ['2015-12-31', '2016-06-30', '2017-01-31'], ['2016-03-31', '2016-12-31'], ['2016-03-31', '2016-09-30']], [[2.3199999999999994, 2.9225000000000008], [8.947368421052632, 8.909090909090908], [0.15857142857142859, 0.1219047619047619, -0.013636363636363636], [0.58, 0.6052380952380952]], [[2.0572727272727276], [8.19047619047619, 5.7368421052631575, 6.3], [-0.01090909090909091, -0.08000000000000002], [-0.5322727272727272, -0.4334999999999999]]]], ['2017-02-06', 2.42, 2.393333333333333, 8.0, -0.06333333333333334, 2.9266666666666663], "PADINI,OVS,8,1,(c3001001,m0000000,p0000100,v4010000)"),
    ("KLSE", [[[['2016-10-30', '2016-12-18', '2017-01-29', '2017-03-26', '2017-06-18', '2017-09-17', '2017-11-12'], ['2016-10-16', '2016-12-11', '2017-01-22', '2017-03-26', '2017-05-14', '2017-06-25', '2017-08-13', '2017-10-15', '2017-12-10'], ['2016-10-30', '2016-12-18', '2017-01-29', '2017-03-26', '2017-05-21', '2017-08-20', '2017-11-12'], ['2016-10-09', '2016-12-04', '2017-02-05', '2017-03-19', '2017-06-04', '2017-08-06', '2017-10-01', '2017-12-03']], [['2016-10-09', '2016-11-20', '2017-01-22', '2017-03-05', '2017-04-16', '2017-06-04', '2017-07-16', '2017-09-03', '2017-12-03'], ['2016-11-20', '2017-03-05', '2017-04-16', '2017-06-04', '2017-07-23', '2017-10-08', '2017-11-26'], ['2016-09-25', '2016-11-20', '2017-01-22', '2017-03-05', '2017-04-23', '2017-06-04', '2017-07-23', '2017-09-03', '2017-10-29'], ['2016-10-30', '2016-12-25', '2017-02-26', '2017-04-16', '2017-05-28', '2017-07-16', '2017-10-15', '2017-11-26']], [[1673.682, 1640.8374999999999, 1682.902, 1749.0260000000003, 1789.5275000000001, 1785.274, 1744.9275], [7.2, 7.4, 10.2, 9.8, 9.666666666666666, 7.0, 9.25, 4.0, 4.8], [0.006, 0.0, 0.028000000000000004, 0.026000000000000002, 0.015999999999999997, 0.01, -0.0075], [0.3575, 0.356, 0.4466666666666667, 0.392, 0.32199999999999995, -0.142, 0.462, 0.895]], [[1664.07, 1625.0800000000002, 1663.658, 1701.8699999999997, 1737.7220000000002, 1767.232, 1755.636, 1767.93, 1718.1299999999999], [5.0, 5.2, 4.8, 4.6, 5.0, 3.2, 3.0], [-0.014000000000000002, -0.024, 0.02, 0.014000000000000002, 0.002, 0.008, -0.018, 0.0, -0.018], [-0.13799999999999998, -0.36, 0.164, -0.35, -0.013999999999999995, -0.30400000000000005, -0.15799999999999997, 0.11600000000000002]]], [[['2016-10-30', '2017-04-02', '2017-06-25', '2017-09-17'], ['2016-10-16', '2017-01-22', '2017-05-14', '2017-08-20', '2017-10-29'], ['2016-10-30', '2017-02-19', '2017-05-14', '2017-08-20', '2017-11-12'], ['2016-10-16', '2017-02-05', '2017-06-11', '2017-10-01', '2017-12-10']], [['2016-11-27', '2017-04-16', '2017-07-23', '2017-12-10'], ['2016-11-27', '2017-03-05', '2017-06-11', '2017-11-26'], ['2016-11-27', '2017-04-30', '2017-07-23', '2017-10-29'], ['2016-10-30', '2017-01-08', '2017-04-16', '2017-07-23', '2017-10-15']], [[1669.512, 1748.425, 1784.4633333333336, 1781.2622222222221], [6.888888888888889, 9.9, 9.285714285714286, 9.11111111111111, 3.888888888888889], [0.002, 0.026666666666666665, 0.014285714285714287, 0.008888888888888889, -0.008888888888888889], [0.15111111111111108, 0.32499999999999996, 0.14299999999999996, 0.37444444444444447, 0.7277777777777777]], [[1626.385, 1740.7240000000002, 1756.0350000000003, 1718.791111111111], [5.5, 6.1, 5.3, 3.4], [-0.023, 0.005555555555555556, -0.016, -0.017777777777777778], [-0.05800000000000001, -0.21375, -0.217, -0.255, -0.131]]], [[['2016-10-31', '2017-06-30'], ['2017-01-31', '2017-08-31'], ['2016-10-31', '2017-02-28', '2017-08-31'], ['2017-02-28', '2017-09-30']], [['2016-12-31', '2017-07-31'], ['2016-11-30', '2017-07-31', '2017-11-30'], ['2016-11-30', '2017-04-30', '2017-10-31'], ['2016-12-31', '2017-07-31']], [[1667.446, 1781.3594736842106], [9.3, 8.380952380952381], [-0.0015, 0.02222222222222223, 0.006190476190476189], [0.28500000000000003, 0.3233333333333333]], [[1632.9745, 1760.8680952380957], [5.714285714285714, 5.571428571428571, 3.5238095238095237], [-0.017142857142857144, 0.008421052631578947, -0.013333333333333329], [-0.17800000000000002, -0.22380952380952368]]]], ['2017-12-12', 1729.57, 1720.8057142857142, 4.714285714285714, -0.01, 0.5028571428571429], "KLSE,OVS,8,1,(c3000010,m0000100,p0000000,v4010001)"),
])
@pytest.mark.skip
def test_retracement_success(counter, pnlist, lasttxn, expected):
    result = scanSignals(0, counter, "", pnlist, lasttxn)
    assert result.replace('\t', '') == expected, "*** Input = " + counter + "," + lasttxn[0]


@pytest.mark.parametrize("counter,pnlist,lasttxn,expected", [
    ("PADINI", [[[['2013-08-11', '2013-09-22', '2013-12-29', '2014-02-16', '2014-04-20', '2014-06-01', '2014-07-27', '2014-09-14'], ['2013-08-25', '2013-10-20', '2013-12-29', '2014-03-16', '2014-06-15', '2014-08-03', '2014-09-28'], ['2013-08-11', '2013-09-22', '2013-12-22', '2014-03-23', '2014-05-04', '2014-07-27', '2014-10-05'], ['2013-08-11', '2013-10-20', '2013-12-01', '2014-02-02', '2014-03-23', '2014-05-04', '2014-06-29', '2014-09-07', '2014-10-26']], [['2013-09-01', '2013-11-17', '2014-02-09', '2014-03-30', '2014-06-15', '2014-08-31', '2014-10-26'], ['2013-09-01', '2013-12-01', '2014-02-16', '2014-05-18', '2014-07-20', '2014-09-07', '2014-10-26'], ['2013-09-01', '2013-11-17', '2014-02-09', '2014-04-27', '2014-06-15', '2014-09-07', '2014-10-26'], ['2013-09-22', '2013-11-03', '2014-01-19', '2014-03-30', '2014-05-18', '2014-07-27', '2014-09-28']], [[1.8050000000000002, 1.8025, 1.7925, 1.6179999999999999, 2.0700000000000003, 2.002, 1.9939999999999998, 1.924], [8.0, 9.5, 9.0, 10.8, 9.8, 10.333333333333334, 7.8], [-0.035, 0.02, 0.05, 0.238, 0.0325, 0.034, -0.02], [1.755, 0.5675, 1.8559999999999999, 0.6374999999999998, 2.318, -0.405, 0.492, 1.0524999999999998, 3.2099999999999995]], [[1.7259999999999998, 1.67, 1.5950000000000002, 1.8860000000000003, 1.886, 1.888, 1.6966666666666665], [6.4, 4.4, 1.4, 4.5, 8.25, 5.25, 6.0], [-0.052000000000000005, -0.057999999999999996, -0.10500000000000001, 0.024, -0.044, -0.045, -0.10333333333333333], [-0.8175, -0.518, -0.2866666666666667, 0.578, -0.64, -0.7699999999999999, -0.8859999999999999]]], [[['2013-08-18', '2013-10-27', '2014-01-05', '2014-04-27', '2014-08-03'], ['2013-10-27', '2014-01-05', '2014-03-16', '2014-07-06', '2014-09-28'], ['2013-09-29', '2013-12-22', '2014-03-30', '2014-08-03'], ['2013-08-18', '2013-12-22', '2014-03-30', '2014-06-22', '2014-09-14']], [['2013-09-01', '2013-11-24', '2014-02-16', '2014-06-22', '2014-10-26'], ['2013-09-15', '2013-11-24', '2014-02-16', '2014-05-25', '2014-09-14'], ['2013-09-01', '2013-11-24', '2014-02-16', '2014-06-22', '2014-10-26'], ['2013-09-29', '2014-01-19', '2014-05-11', '2014-08-17']], [[1.7928571428571427, 1.7777777777777777, 1.7900000000000003, 2.032, 1.9899999999999998], [9.222222222222221, 9.0, 10.3, 10.0, 7.125], [0.015555555555555557, 0.045, 0.18000000000000002, 0.02875], [0.32857142857142857, 1.8170000000000002, 1.448, 0.006999999999999995, 0.7666666666666666]], [[1.7459999999999998, 1.674, 1.6077777777777778, 1.8980000000000004, 1.74375], [7.1, 4.9, 2.111111111111111, 5.333333333333333, 5.666666666666667], [-0.049, -0.05499999999999999, -0.09444444444444444, -0.039, -0.0825], [-0.77, -0.13499999999999995, -0.5077777777777777, -0.701]]], [[['2013-09-30', '2014-04-30'], ['2013-10-31', '2014-03-31'], ['2013-09-30', '2014-03-31', '2014-07-31'], ['2014-03-31', '2014-10-31']], [['2014-02-28', '2014-06-30', '2014-10-31'], ['2014-02-28', '2014-09-30'], ['2014-02-28', '2014-06-30', '2014-10-31'], ['2013-09-30', '2014-01-31', '2014-07-31']], [[1.782, 2.011818181818182], [8.5, 9.666666666666666], [0.0035000000000000005, 0.16476190476190475, 0.021], [1.319047619047619, 1.0018749999999998]], [[1.6321052631578947, 1.9233333333333331, 1.7743749999999998], [4.2105263157894735, 6.352941176470588], [-0.06052631578947369, -0.027619047619047623, -0.06875], [-0.6195, 0.11473684210526312, -0.49000000000000005]]]], ['2014-11-05', 1.84, 1.8333333333333333, 8.666666666666666, -0.02666666666666667, 0.9333333333333335], "PADINI,Dbg,0,0,(c3000010,m3000010,p0000100,v0000000)"),
])
@pytest.mark.skip
def test_retracement_fail(counter, pnlist, lasttxn, expected):
    result = scanSignals(1, counter, "", pnlist, lasttxn)
    assert result.replace('\t', '') == expected, "*** Input = " + counter + "," + lasttxn[0]


# PADINI 2014-03-03 OVS,1,0 2014-03-07 OVS,1,2
# PETRONM,2013-04-24, OVS,3,0
# EDGENTA,2018-08-01, OVS,4,0
# FLBHD 2018-07-02
# DUFU 2014-11-14 OVS,9,0
# DUFU 2016-02-10 OVS,6,0
# KLSE 2017-01-03 OVS,10,1
# KLSE 2018-07-12 OVS,11,0
@pytest.mark.parametrize("counter,pnlist,lasttxn,expected", [
    ("PADINI", [[[['2013-01-06', '2013-02-17', '2013-04-14', '2013-06-02', '2013-07-14', '2013-09-22', '2013-12-29', '2014-02-16'], ['2013-01-13', '2013-03-03', '2013-04-14', '2013-06-02', '2013-08-25', '2013-10-20', '2013-12-29'], ['2013-01-13', '2013-03-17', '2013-06-02', '2013-08-11', '2013-09-22', '2013-12-22'], ['2012-12-16', '2013-02-10', '2013-04-14', '2013-05-26', '2013-08-11', '2013-10-20', '2013-12-01', '2014-02-02']], [['2013-01-27', '2013-05-05', '2013-07-07', '2013-09-01', '2013-11-17', '2014-02-09'], ['2012-12-16', '2013-01-27', '2013-05-05', '2013-07-21', '2013-09-01', '2013-12-01', '2014-02-16'], ['2012-12-16', '2013-01-27', '2013-03-31', '2013-05-12', '2013-07-07', '2013-09-01', '2013-11-17', '2014-02-09'], ['2013-01-13', '2013-02-24', '2013-04-21', '2013-06-09', '2013-08-04', '2013-09-22', '2013-11-03', '2014-01-19']], [[1.8699999999999999, 1.8966666666666665, 1.97, 2.1119999999999997, 1.8820000000000001, 1.8025, 1.7925, 1.6179999999999999], [6.8, 12.8, 9.4, 9.0, 8.0, 9.5, 9.0], [0.024, 0.05, 0.156, -0.035, 0.02, 0.05], [0.78, 0.8619999999999999, 2.4, 0.385, 1.755, 0.5675, 1.8559999999999999, 0.6374999999999998]], [[1.7775, 1.7925, 1.866, 1.7259999999999998, 1.67, 1.5950000000000002], [3.4, 3.75, 3.5, 3.8, 6.4, 4.4, 1.4], [-0.094, -0.022500000000000003, 0.030000000000000006, -0.07, -0.11399999999999999, -0.052000000000000005, -0.057999999999999996, -0.10500000000000001], [-0.55, -0.558, -0.050000000000000024, -0.8459999999999999, -0.24000000000000005, -0.8175, -0.518, -0.2866666666666667]]], [[['2013-01-06', '2013-03-17', '2013-06-09', '2013-09-29', '2014-01-05'], ['2013-03-03', '2013-06-09', '2013-10-27', '2014-01-05'], ['2013-03-17', '2013-06-09', '2013-09-29', '2013-12-22'], ['2012-12-23', '2013-04-14', '2013-07-21', '2013-10-13', '2013-12-22']], [['2013-02-03', '2013-05-12', '2013-09-01', '2013-11-24', '2014-02-16'], ['2012-12-23', '2013-05-12', '2013-07-21', '2013-11-24', '2014-02-16'], ['2012-12-23', '2013-03-03', '2013-07-07', '2013-11-24', '2014-02-16'], ['2013-01-06', '2013-03-17', '2013-06-23', '2013-09-29', '2014-01-19']], [[1.8525, 1.8960000000000001, 2.1049999999999995, 1.79, 1.7900000000000003], [12.0, 8.6, 9.222222222222221, 9.0], [0.039, 0.156, 0.015555555555555557, 0.045], [0.43400000000000005, 1.382, 0.593, 0.24700000000000005, 1.8170000000000002]], [[1.8000000000000003, 1.795555555555556, 1.7459999999999998, 1.674, 1.6077777777777778], [3.7, 4.111111111111111, 4.3, 4.9, 2.111111111111111], [-0.09199999999999998, -0.003, -0.09999999999999999, -0.05499999999999999, -0.09444444444444444], [-0.06750000000000003, -0.354, -0.64, -0.77, -0.13499999999999995]]], [[['2013-01-31', '2013-06-30', '2013-12-31'], ['2013-03-31', '2013-10-31'], ['2013-01-31', '2013-06-30', '2013-12-31'], ['2013-04-30', '2013-12-31']], [['2013-02-28', '2013-11-30'], ['2013-07-31', '2013-11-30'], ['2013-02-28', '2013-07-31', '2013-11-30'], ['2013-06-30', '2014-01-31']], [[1.8344999999999998, 2.0220000000000002, 1.7771428571428571], [10.523809523809524, 8.5], [0.003, 0.05500000000000001, 0.03857142857142858], [0.9104545454545453, 1.0580952380952384]], [[1.8317647058823525, 1.7080000000000002], [4.695652173913044, 5.05], [-0.0029411764705882353, -0.08695652173913046, -0.03350000000000001], [-0.6950000000000001, 0.11473684210526312]]]], ['2014-02-27', 1.73, 1.6249999999999998, 3.9444444444444446, -0.06722222222222224, 0.523888888888889], "PADINI,OVS,1,0,(c0100000,m0100000,p0000000,v0000010)"),
    ("PADINI", [[[['2013-01-06', '2013-02-17', '2013-04-14', '2013-06-02', '2013-07-14', '2013-09-22', '2013-12-29', '2014-02-16'], ['2013-01-13', '2013-03-03', '2013-04-14', '2013-06-02', '2013-08-25', '2013-10-20', '2013-12-29'], ['2013-01-13', '2013-03-17', '2013-06-02', '2013-08-11', '2013-09-22', '2013-12-22'], ['2013-02-10', '2013-04-14', '2013-05-26', '2013-08-11', '2013-10-20', '2013-12-01', '2014-02-02']], [['2013-01-27', '2013-05-05', '2013-07-07', '2013-09-01', '2013-11-17', '2014-02-09'], ['2013-01-27', '2013-05-05', '2013-07-21', '2013-09-01', '2013-12-01', '2014-02-16'], ['2013-01-27', '2013-03-31', '2013-05-12', '2013-07-07', '2013-09-01', '2013-11-17', '2014-02-09'], ['2013-01-13', '2013-02-24', '2013-04-21', '2013-06-09', '2013-08-04', '2013-09-22', '2013-11-03', '2014-01-19']], [[1.8699999999999999, 1.8966666666666665, 1.97, 2.1119999999999997, 1.8820000000000001, 1.8025, 1.7925, 1.6179999999999999], [6.8, 12.8, 9.4, 9.0, 8.0, 9.5, 9.0], [0.024, 0.05, 0.156, -0.035, 0.02, 0.05], [0.8619999999999999, 2.4, 0.385, 1.755, 0.5675, 1.8559999999999999, 0.6374999999999998]], [[1.7775, 1.7925, 1.866, 1.7259999999999998, 1.67, 1.5950000000000002], [3.75, 3.5, 3.8, 6.4, 4.4, 1.4], [-0.022500000000000003, 0.030000000000000006, -0.07, -0.11399999999999999, -0.052000000000000005, -0.057999999999999996, -0.10500000000000001], [-0.55, -0.558, -0.050000000000000024, -0.8459999999999999, -0.24000000000000005, -0.8175, -0.518, -0.2866666666666667]]], [[['2013-01-13', '2013-03-24', '2013-06-02', '2013-09-22', '2013-12-29'], ['2013-03-10', '2013-06-02', '2013-10-20', '2013-12-29'], ['2013-01-13', '2013-03-24', '2013-06-16', '2013-10-06', '2013-12-29'], ['2013-02-10', '2013-04-21', '2013-07-28', '2013-12-15']], [['2013-01-27', '2013-05-05', '2013-09-08', '2013-11-17', '2014-02-09'], ['2013-01-27', '2013-05-05', '2013-07-28', '2013-12-01', '2014-02-23'], ['2013-01-27', '2013-05-05', '2013-07-14', '2013-11-17', '2014-02-09'], ['2013-02-24', '2013-06-16', '2013-09-22', '2014-01-26']], [[1.8688888888888888, 1.9130000000000003, 2.0922222222222224, 1.7844444444444447, 1.7844444444444447], [12.4, 8.88888888888889, 8.666666666666666, 8.666666666666666], [0.013333333333333332, 0.043000000000000003, 0.13900000000000004, 0.007999999999999998, 0.049999999999999996], [0.6225, 1.1749999999999998, 0.687, 1.211]], [[1.8033333333333335, 1.8155555555555556, 1.7549999999999997, 1.6977777777777776, 1.60375], [4.444444444444445, 4.111111111111111, 4.3, 4.7, 2.7], [-0.010000000000000002, -0.05, -0.10399999999999998, -0.04111111111111111, -0.09999999999999999], [-0.54625, -0.8389999999999999, -0.81, -0.185]]], [[['2013-01-31', '2013-06-30', '2013-12-31'], ['2013-03-31', '2013-10-31'], ['2013-01-31', '2013-06-30', '2013-12-31'], ['2013-04-30', '2013-12-31']], [['2013-02-28', '2013-08-31', '2014-02-28'], ['2013-07-31', '2014-02-28'], ['2013-02-28', '2013-07-31', '2014-02-28'], ['2013-06-30', '2014-01-31']], [[1.8344999999999998, 2.0220000000000002, 1.7771428571428571], [10.523809523809524, 8.5], [0.003, 0.05500000000000001, 0.03857142857142858], [0.9104545454545453, 1.0580952380952384]], [[1.8317647058823525, 1.7657894736842108, 1.6321052631578947], [4.695652173913044, 4.2105263157894735], [-0.0029411764705882353, -0.08695652173913046, -0.06052631578947369], [-0.6950000000000001, 0.11473684210526312]]]], ['2014-03-03', 1.74, 1.74, 9.0, 0.06, -0.05], "PADINI,OVS,1,0,(c1000100,m3000100,p4010000,v0000010)"),
    ("PADINI", [[[['2013-01-06', '2013-02-17', '2013-04-14', '2013-06-02', '2013-07-14', '2013-09-22', '2013-12-29', '2014-02-16'], ['2013-01-13', '2013-03-03', '2013-04-14', '2013-06-02', '2013-08-25', '2013-10-20', '2013-12-29'], ['2013-01-13', '2013-03-17', '2013-06-02', '2013-08-11', '2013-09-22', '2013-12-22'], ['2013-02-10', '2013-04-14', '2013-05-26', '2013-08-11', '2013-10-20', '2013-12-01', '2014-02-02']], [['2013-01-27', '2013-05-05', '2013-07-07', '2013-09-01', '2013-11-17', '2014-02-09'], ['2013-01-27', '2013-05-05', '2013-07-21', '2013-09-01', '2013-12-01', '2014-02-16'], ['2013-01-27', '2013-03-31', '2013-05-12', '2013-07-07', '2013-09-01', '2013-11-17', '2014-02-09'], ['2013-01-13', '2013-02-24', '2013-04-21', '2013-06-09', '2013-08-04', '2013-09-22', '2013-11-03', '2014-01-19']], [[1.8699999999999999, 1.8966666666666665, 1.97, 2.1119999999999997, 1.8820000000000001, 1.8025, 1.7925, 1.6179999999999999], [6.8, 12.8, 9.4, 9.0, 8.0, 9.5, 9.0], [0.024, 0.05, 0.156, -0.035, 0.02, 0.05], [0.8619999999999999, 2.4, 0.385, 1.755, 0.5675, 1.8559999999999999, 0.6374999999999998]], [[1.7775, 1.7925, 1.866, 1.7259999999999998, 1.67, 1.5950000000000002], [3.75, 3.5, 3.8, 6.4, 4.4, 1.4], [-0.022500000000000003, 0.030000000000000006, -0.07, -0.11399999999999999, -0.052000000000000005, -0.057999999999999996, -0.10500000000000001], [-0.55, -0.558, -0.050000000000000024, -0.8459999999999999, -0.24000000000000005, -0.8175, -0.518, -0.2866666666666667]]], [[['2013-01-13', '2013-03-24', '2013-06-02', '2013-09-22', '2013-12-29'], ['2013-03-10', '2013-06-02', '2013-10-20', '2013-12-29'], ['2013-01-13', '2013-03-24', '2013-06-16', '2013-10-06', '2013-12-29'], ['2013-02-10', '2013-04-21', '2013-07-28', '2013-12-15']], [['2013-01-27', '2013-05-05', '2013-09-08', '2013-11-17', '2014-02-09'], ['2013-01-27', '2013-05-05', '2013-07-28', '2013-12-01', '2014-02-23'], ['2013-01-27', '2013-05-05', '2013-07-14', '2013-11-17', '2014-02-09'], ['2013-02-24', '2013-06-16', '2013-09-22', '2014-01-26']], [[1.8688888888888888, 1.9130000000000003, 2.0922222222222224, 1.7844444444444447, 1.7844444444444447], [12.4, 8.88888888888889, 8.666666666666666, 8.666666666666666], [0.013333333333333332, 0.043000000000000003, 0.13900000000000004, 0.007999999999999998, 0.049999999999999996], [0.6225, 1.1749999999999998, 0.687, 1.211]], [[1.8033333333333335, 1.8155555555555556, 1.7549999999999997, 1.6977777777777776, 1.60375], [4.444444444444445, 4.111111111111111, 4.3, 4.7, 2.7], [-0.010000000000000002, -0.05, -0.10399999999999998, -0.04111111111111111, -0.09999999999999999], [-0.54625, -0.8389999999999999, -0.81, -0.185]]], [[['2013-01-31', '2013-06-30', '2013-12-31'], ['2013-03-31', '2013-10-31'], ['2013-01-31', '2013-06-30', '2013-12-31'], ['2013-04-30', '2013-12-31']], [['2013-02-28', '2013-08-31', '2014-02-28'], ['2013-07-31', '2014-02-28'], ['2013-02-28', '2013-07-31', '2014-02-28'], ['2013-06-30', '2014-01-31']], [[1.8344999999999998, 2.0220000000000002, 1.7771428571428571], [10.523809523809524, 8.5], [0.003, 0.05500000000000001, 0.03857142857142858], [0.9104545454545453, 1.0580952380952384]], [[1.8317647058823525, 1.7657894736842108, 1.6321052631578947], [4.695652173913044, 4.2105263157894735], [-0.0029411764705882353, -0.08695652173913046, -0.06052631578947369], [-0.6950000000000001, 0.11473684210526312]]]], ['2014-03-07', 1.84, 1.826, 9.8, 0.11800000000000002, 0.7819999999999999], "PADINI,OVS,1,2,(c3000100,m3000100,p4010000,v0000010)"),
    ("PETRONM", [[[['2012-02-19', '2012-05-06', '2012-07-15', '2012-09-16', '2012-11-18', '2013-01-06', '2013-02-17', '2013-04-21'], ['2012-02-26', '2012-05-20', '2012-07-15', '2012-09-30', '2012-11-18', '2013-01-20', '2013-03-24'], ['2012-02-19', '2012-05-06', '2012-07-15', '2012-11-18', '2013-01-13', '2013-04-21'], ['2012-02-12', '2012-04-15', '2012-05-27', '2012-07-22', '2012-09-09', '2012-11-04', '2012-12-30', '2013-03-17']], [['2012-04-08', '2012-07-01', '2012-10-14', '2012-12-02', '2013-01-13', '2013-03-03'], ['2012-04-08', '2012-06-24', '2012-09-02', '2012-10-21', '2012-12-02', '2013-02-17', '2013-04-14'], ['2012-03-25', '2012-06-10', '2012-09-09', '2012-12-16', '2013-02-24'], ['2012-03-18', '2012-06-10', '2012-08-05', '2012-10-14', '2012-12-09', '2013-02-24', '2013-04-14']], [[3.8659999999999997, 3.585, 3.374, 2.7859999999999996, 2.9499999999999997, 2.89, 2.8166666666666664, 2.982], [7.8, 7.4, 8.0, 5.4, 8.666666666666666, 8.6, 10.6], [0.078, 0.0, 0.006, 0.07666666666666667, 0.016, 0.05], [1.6433333333333333, 2.315, -0.792, 1.53, 1.5500000000000003, 1.226, 1.7925, 1.222]], [[3.568, 3.312, 2.7359999999999998, 2.7920000000000003, 2.882, 2.784], [5.6, 5.6, 2.0, 3.0, 3.4, 6.333333333333333, 8.6], [-0.034, -0.06, -0.152, -0.024, -0.032], [-0.48599999999999993, -0.9175, -0.37399999999999994, -0.844, -0.572, -0.45199999999999996, 0.08999999999999997]]], [[['2012-02-19', '2012-05-13', '2012-07-22', '2012-11-25'], ['2012-02-19', '2012-07-22', '2012-09-30', '2013-01-20', '2013-03-31'], ['2012-02-19', '2012-05-13', '2012-07-22', '2012-11-25', '2013-03-31'], ['2012-04-15', '2012-09-02', '2013-01-06', '2013-03-17']], [['2012-04-15', '2012-06-24', '2012-10-14', '2013-03-03'], ['2012-04-15', '2012-06-24', '2012-09-02', '2012-12-09', '2013-02-17'], ['2012-04-01', '2012-06-10', '2012-09-16', '2012-12-23', '2013-03-03'], ['2012-03-18', '2012-06-10', '2012-10-14', '2013-03-03']], [[3.815, 3.58, 3.357, 2.93], [7.25, 7.5, 5.111111111111111, 8.4, 9.7], [0.06875, 0.0, 0.004, 0.06625, 0.015000000000000003], [1.9555555555555557, 1.4185714285714286, 0.97375, 0.553]], [[3.572222222222222, 3.3340000000000005, 2.742, 2.7849999999999997], [5.666666666666667, 6.0, 2.142857142857143, 3.5, 6.5], [-0.031000000000000007, -0.05666666666666667, -0.138, -0.018000000000000002, -0.028000000000000004], [-0.404, -0.8822222222222221, -0.714, -0.418]]], [[['2012-07-31', '2012-11-30'], ['2012-05-31', '2012-11-30', '2013-03-31'], ['2012-07-31', '2012-11-30'], ['2012-04-30', '2012-08-31', '2013-01-31']], [['2012-06-30', '2012-10-31', '2013-02-28'], ['2012-04-30', '2012-08-31', '2012-12-31'], ['2012-03-31', '2012-09-30', '2013-02-28'], ['2012-06-30', '2012-10-31', '2013-02-28']], [[3.3418181818181822, 2.905], [7.2727272727272725, 6.05, 9.095238095238095], [-0.003181818181818182, 0.05], [1.482, 0.7755, 0.11799999999999997]], [[3.338, 2.759090909090909, 2.7964705882352936], [5.9, 3.05, 5.55], [-0.02090909090909092, -0.11157894736842106, -0.02764705882352941], [-0.596, -0.37954545454545446, -0.3752941176470589]]]], ['2013-04-24', 2.95, 2.91, 8.777777777777779, 0.028333333333333335, 0.5055555555555558], "PETRONM,OVS,3,0,(c1000000,m3001000,p3000010,v0000000)"),
    ("EDGENTA", [[[['2017-07-09', '2017-09-17', '2017-12-03', '2018-03-04', '2018-05-06', '2018-06-17'], ['2017-07-23', '2017-09-17', '2017-12-03', '2018-03-04', '2018-04-15', '2018-06-17', '2018-07-29'], ['2017-07-23', '2017-09-17', '2017-12-03', '2018-01-28', '2018-03-18', '2018-05-06', '2018-06-24'], ['2017-07-02', '2017-09-10', '2017-11-05', '2017-12-24', '2018-02-25', '2018-04-22', '2018-06-10', '2018-07-22']], [['2017-06-25', '2017-08-13', '2017-10-01', '2017-11-12', '2018-01-07', '2018-02-18', '2018-04-08', '2018-07-15'], ['2017-06-18', '2017-08-20', '2017-11-05', '2018-01-07', '2018-02-18', '2018-05-13', '2018-07-08'], ['2017-06-25', '2017-08-13', '2017-10-29', '2018-01-07', '2018-02-18', '2018-04-08', '2018-06-03', '2018-07-15'], ['2017-05-21', '2017-08-13', '2017-10-08', '2017-11-19', '2018-01-28', '2018-03-25', '2018-05-06', '2018-07-15']], [[2.7979999999999996, 2.7359999999999998, 2.6550000000000002, 2.7479999999999998, 2.3425, 2.08], [7.2, 9.6, 10.0, 8.2, 5.6, 6.5, 8.8], [0.022000000000000002, 0.072, 0.01, 0.006, 0.15, 0.02, -0.044000000000000004], [4.983333333333333, 2.42, 0.342, 2.6979999999999995, 4.34, 0.932, -0.10800000000000001, -0.12400000000000003]], [[2.412, 2.498, 2.67, 2.6160000000000005, 2.475, 2.3075, 2.174, 1.892], [2.75, 3.2, 6.8, 4.75, 5.25, 4.5, 3.6], [-0.21600000000000003, -0.068, -0.026000000000000002, -0.052500000000000005, -0.075, -0.194, -0.115, -0.082], [0.04600000000000004, -0.842, -0.9120000000000001, -0.6025, -0.578, -0.652, -0.7575000000000001, -0.76]]], [[['2017-07-09', '2017-09-17', '2017-11-26', '2018-03-18', '2018-06-24'], ['2017-09-17', '2017-12-10', '2018-03-18', '2018-06-24'], ['2017-09-17', '2017-12-10', '2018-03-18', '2018-06-24'], ['2017-07-09', '2017-09-17', '2017-12-10', '2018-03-04', '2018-06-10']], [['2017-06-25', '2018-01-07', '2018-04-15', '2018-07-08'], ['2017-06-25', '2017-10-01', '2018-01-07', '2018-07-08'], ['2017-06-25', '2017-10-29', '2018-01-07', '2018-04-15', '2018-07-08'], ['2017-05-28', '2017-08-06', '2017-10-15', '2018-01-21', '2018-05-13']], [[2.6925, 2.698888888888889, 2.632222222222222, 2.7090000000000005, 2.066666666666667], [9.11111111111111, 9.555555555555555, 8.0, 6.333333333333333], [0.05444444444444444, -0.0011111111111111115, 0.127, -0.054444444444444434], [4.07125, 2.2677777777777774, 1.5166666666666666, 3.41, -0.2411111111111111]], [[2.481111111111111, 2.49125, 2.196, 1.9240000000000002], [3.0, 7.111111111111111, 5.25, 4.1], [-0.19999999999999998, -0.025555555555555554, -0.049999999999999996, -0.18100000000000002, -0.07000000000000002], [0.7710000000000001, -0.7619999999999999, -0.6970000000000001, -0.181, -0.5933333333333334]]], [[['2017-09-30', '2018-03-31'], ['2017-07-31', '2017-11-30', '2018-03-31'], ['2017-09-30', '2018-03-31'], ['2017-06-30', '2018-02-28', '2018-06-30']], [['2017-08-31', '2018-02-28', '2018-07-31'], ['2017-06-30', '2018-01-31', '2018-05-31'], ['2017-06-30', '2017-12-31', '2018-04-30'], ['2017-10-31', '2018-03-31', '2018-07-31']], [[2.691111111111111, 2.588863636363637], [6.476190476190476, 8.80952380952381, 7.2272727272727275], [0.044444444444444446, 0.05272727272727269], [2.6073684210526316, 1.867222222222222, -0.34850000000000003]], [[2.5913636363636363, 2.449444444444444, 1.9913636363636364], [4.105263157894737, 5.9523809523809526, 4.833333333333333], [-0.16210526315789475, -0.03368421052631579, -0.11952380952380953], [-0.5885714285714287, -0.22136363636363637, -0.4840909090909092]]]], ['2018-08-01', 2.19, 2.19, 8.0, 0.13, 0.29], "EDGENTA,OVS,4,0,(c1000100,m3000000,p4010000,v0000000)"),
    ("FLBHD", [[[['2017-05-28', '2017-08-06', '2017-09-17', '2017-10-29', '2018-01-14', '2018-03-11', '2018-05-20'], ['2017-04-30', '2017-06-25', '2017-08-06', '2017-10-01', '2017-11-12', '2018-01-14', '2018-03-11', '2018-05-06'], ['2017-05-28', '2017-08-06', '2017-10-29', '2018-01-14', '2018-03-11', '2018-05-20'], ['2017-05-14', '2017-08-06', '2017-10-08', '2017-11-26', '2018-02-11', '2018-04-15', '2018-05-27']], [['2017-04-23', '2017-06-04', '2017-07-30', '2017-09-10', '2017-10-22', '2017-12-24', '2018-02-18', '2018-04-15', '2018-05-27'], ['2017-06-04', '2017-07-23', '2017-09-03', '2017-10-22', '2017-12-17', '2018-02-04', '2018-04-01', '2018-06-03'], ['2017-06-25', '2017-09-10', '2017-12-10', '2018-02-18', '2018-04-08', '2018-05-27'], ['2017-04-23', '2017-06-18', '2017-09-03', '2017-10-15', '2017-12-24', '2018-02-18', '2018-04-22', '2018-07-01']], [[1.746, 1.784, 1.522, 1.516, 1.31, 1.248, 1.0740000000000003], [10.0, 10.4, 10.0, 8.6, 8.6, 10.0, 8.2, 10.333333333333334], [0.09, 0.036, 0.004, 0.042, 0.01, 0.003999999999999999], [4.1725, 2.558, -0.722, 2.6799999999999997, 2.124, 0.35, 3.6819999999999995]], [[1.5879999999999999, 1.6779999999999997, 1.7220000000000002, 1.51, 1.4725000000000001, 1.2440000000000002, 1.165, 1.048, 1.024], [7.0, 5.4, 4.0, 6.5, 5.2, 7.0, 4.6, 7.25], [-0.027999999999999997, -0.14250000000000002, -0.16599999999999998, -0.095, -0.134, -0.028000000000000004], [-0.45, -0.9125, -0.4533333333333333, -0.804, -0.766, -0.635, -0.7925, -0.82]]], [[['2017-05-28', '2017-08-20', '2017-10-29', '2018-01-21', '2018-04-29'], ['2017-06-25', '2017-10-01', '2018-01-21', '2018-05-13'], ['2017-05-28', '2017-11-12', '2018-01-21', '2018-05-27'], ['2017-05-28', '2017-08-06', '2017-11-26', '2018-02-18', '2018-06-10']], [['2017-04-30', '2017-07-23', '2017-10-15', '2018-02-18', '2018-06-10'], ['2017-06-11', '2017-09-03', '2017-12-24', '2018-04-01', '2018-06-10'], ['2017-06-25', '2017-09-17', '2017-12-10', '2018-04-15'], ['2017-06-25', '2017-10-15', '2017-12-24', '2018-04-01']], [[1.738, 1.759, 1.4966666666666668, 1.289, 1.0525], [9.88888888888889, 8.555555555555555, 9.1, 9.8], [0.08600000000000001, 0.001, 0.028000000000000004, -0.012000000000000002], [3.607999999999999, 1.119, 1.032, 0.8977777777777778, 2.1766666666666663]], [[1.5911111111111111, 1.7310000000000003, 1.4820000000000002, 1.182222222222222, 1.0366666666666666], [7.3, 4.75, 5.4, 4.9, 7.555555555555555], [-0.02222222222222222, -0.13999999999999999, -0.15666666666666665, -0.13300000000000003], [-0.8688888888888889, -0.7629999999999999, -0.633, -0.6020000000000001]]], [[['2017-07-31', '2018-01-31'], ['2017-05-31', '2018-01-31'], ['2017-05-31', '2018-01-31'], ['2017-05-31', '2017-11-30', '2018-05-31']], [['2017-04-30', '2017-12-31', '2018-05-31'], ['2017-07-31', '2017-12-31'], ['2017-06-30', '2017-12-31', '2018-04-30'], ['2017-06-30', '2018-03-31']], [[1.7338095238095237, 1.283809523809524], [9.0, 8.523809523809524], [0.06809523809523811, 0.016190476190476193], [2.9142857142857146, 0.4354545454545455, 1.764705882352941]], [[1.596315789473684, 1.2515789473684211, 1.041764705882353], [6.666666666666667, 6.0], [-0.004210526315789473, -0.12789473684210528, -0.1110526315789474], [-0.7121052631578948, -0.5923809523809526]]]], ['2018-07-02', 1.15, 1.15, 10.0, 0.11, -0.54], "FLBHD,OVS,4,0,(c1000100,m4010001,p4010000,v0000000)"),
    ("DUFU", [[[['2013-08-18', '2013-09-29', '2013-11-17', '2014-01-05', '2014-02-16', '2014-06-22', '2014-08-10', '2014-09-28'], ['2013-09-22', '2013-12-01', '2014-01-19', '2014-03-30', '2014-06-22', '2014-08-10', '2014-09-28', '2014-11-09'], ['2013-08-18', '2013-10-27', '2014-01-19', '2014-03-02', '2014-06-22', '2014-08-10', '2014-09-28'], ['2013-10-13', '2014-01-19', '2014-04-06', '2014-06-15', '2014-08-10', '2014-09-28']], [['2013-09-15', '2013-12-15', '2014-02-02', '2014-04-20', '2014-06-08', '2014-10-19'], ['2013-10-06', '2013-12-08', '2014-02-09', '2014-04-13', '2014-06-08', '2014-09-07', '2014-10-19'], ['2013-09-15', '2013-12-15', '2014-02-09', '2014-04-06', '2014-06-08', '2014-08-03', '2014-09-14', '2014-11-09'], ['2013-09-08', '2013-11-10', '2013-12-22', '2014-03-16', '2014-06-08', '2014-08-31', '2014-11-02']], [[0.20299999999999999, 0.197, 0.20600000000000002, 0.1975, 0.195, 0.24299999999999997, 0.292, 0.273], [11.0, 11.2, 12.666666666666666, 12.333333333333334, 11.6, 7.8, 9.0, 10.25], [-0.028000000000000004, 0.06000000000000001, 0.006666666666666667, 0.004000000000000001, 0.156, 0.22000000000000003, 0.017999999999999995], [37.116, 3.046666666666667, 2.84, 4.618, 0.6259999999999999, 2.8999999999999995]], [[0.1875, 0.194, 0.19, 0.186, 0.20800000000000002, 0.227], [8.0, 10.2, 9.5, 11.6, 8.4, 5.5, 6.2], [-0.0725, -0.054000000000000006, -0.025, -0.042, 0.06799999999999999, 0.17666666666666667, -0.148, -0.06], [-0.8620000000000001, -0.75, -0.898, -0.6875, -0.8, -0.8240000000000001, -0.8650000000000001]]], [[['2013-08-25', '2013-11-17', '2014-02-23', '2014-08-10', '2014-11-02'], ['2013-09-22', '2014-01-12', '2014-04-06', '2014-06-29', '2014-10-05'], ['2013-08-25', '2013-11-03', '2014-01-26', '2014-06-01', '2014-08-10'], ['2013-10-20', '2014-01-26', '2014-04-06', '2014-06-29', '2014-10-05']], [['2013-09-22', '2013-12-29', '2014-04-06', '2014-07-13', '2014-10-19'], ['2013-10-20', '2014-02-09', '2014-06-15', '2014-09-07'], ['2013-09-08', '2013-12-15', '2014-04-06', '2014-06-15', '2014-09-21'], ['2013-09-08', '2013-12-29', '2014-03-23', '2014-06-01', '2014-11-02']], [[0.20166666666666666, 0.20500000000000002, 0.19500000000000003, 0.28874999999999995, 0.245], [10.625, 12.555555555555555, 12.125, 11.2, 8.6], [-0.03666666666666667, 0.06000000000000001, 0.0025, 0.12500000000000003, 0.20375], [21.60888888888889, 2.02875, 1.5525, 2.195, 1.686]], [[0.19, 0.1942857142857143, 0.18625000000000003, 0.2385, 0.23555555555555557], [8.666666666666666, 9.666666666666666, 9.1, 5.555555555555555], [-0.06300000000000001, -0.046, -0.04125, 0.07899999999999999, -0.1366666666666667], [-0.8240000000000001, -0.8228571428571428, -0.5875, 0.09899999999999998, -0.8200000000000001]]], [[['2013-11-30', '2014-08-31'], ['2013-09-30', '2014-01-31', '2014-06-30'], ['2013-10-31', '2014-02-28', '2014-07-31'], ['2013-10-31', '2014-06-30']], [['2013-09-30', '2014-04-30'], ['2013-10-31', '2014-02-28', '2014-08-31'], ['2013-12-31', '2014-09-30'], ['2013-12-31', '2014-08-31']], [[0.20325000000000007, 0.2769047619047618], [10.38888888888889, 11.764705882352942, 10.19047619047619], [0.041904761904761924, -0.006315789473684211, 0.14], [9.526190476190475, 2.163333333333333]], [[0.1927777777777778, 0.18795454545454549], [8.952380952380953, 10.421052631578947, 6.809523809523809], [-0.04157894736842107, -0.0875], [-0.7699999999999999, -0.3390476190476191]]]], ['2014-11-14', 0.225, 0.235, 10.11111111111111, -0.05666666666666667, -0.5855555555555556], "DUFU,OVS,9,0,(c3001001,m0000100,p0000110,v0000000)"),
    ("DUFU", [[[['2014-11-30', '2015-02-08', '2015-04-19', '2015-07-26', '2015-10-25', '2016-01-17'], ['2015-02-15', '2015-05-24', '2015-07-26', '2015-09-13', '2015-10-25', '2015-12-06'], ['2014-11-30', '2015-02-08', '2015-04-19', '2015-06-07', '2015-07-26', '2015-09-27', '2015-12-27', '2016-02-07'], ['2014-11-30', '2015-02-01', '2015-04-19', '2015-07-26', '2015-10-25', '2015-12-13', '2016-02-07']], [['2014-12-21', '2015-03-08', '2015-05-10', '2015-07-05', '2015-08-23', '2015-10-18', '2016-01-31'], ['2014-12-21', '2015-04-12', '2015-06-28', '2015-08-16', '2015-10-04', '2015-11-15', '2015-12-27'], ['2015-01-04', '2015-03-08', '2015-07-05', '2015-08-23', '2015-10-18', '2015-12-20', '2016-01-31'], ['2014-12-28', '2015-03-22', '2015-05-31', '2015-08-09', '2015-10-11', '2015-11-29', '2016-01-10']], [[0.321, 0.3983333333333334, 0.422, 0.344, 0.32599999999999996, 0.5730000000000001], [11.4, 8.4, 9.2, 10.4, 8.8, 11.8], [0.34, 0.4666666666666666, 0.21200000000000002, -0.04, 0.122, 0.14250000000000002, 0.3466666666666667, 0.035], [20.428, 9.654, 2.962, 0.5860000000000001, 2.0679999999999996, 4.683999999999999, 1.5525000000000002]], [[0.23899999999999996, 0.305, 0.365, 0.288, 0.27, 0.30625, 0.50625], [5.8, 5.4, 3.6, 6.4, 7.0, 7.0, 7.666666666666667], [-0.09500000000000001, -0.10200000000000001, -0.20599999999999996, -0.16, 0.0, 0.23399999999999999, 0.0275], [-0.91, -0.8099999999999999, -0.8480000000000001, -0.748, -0.542, 1.624, -0.082]]], [[['2014-12-07', '2015-02-15', '2015-04-26', '2015-08-02', '2016-01-17'], ['2015-02-15', '2015-05-24', '2015-09-13', '2015-12-06'], ['2014-12-07', '2015-02-15', '2015-04-26', '2015-09-27', '2016-01-03'], ['2014-12-07', '2015-04-26', '2015-07-05', '2015-09-27', '2015-12-20']], [['2014-12-21', '2015-03-15', '2015-08-30'], ['2014-12-21', '2015-04-12', '2015-07-05', '2015-10-11'], ['2015-01-04', '2015-03-15', '2015-07-05', '2015-10-25'], ['2015-01-04', '2015-03-15', '2015-05-24', '2015-08-16', '2015-11-08']], [[0.30200000000000005, 0.3775, 0.421, 0.3283333333333333, 0.5435], [11.375, 7.8, 10.222222222222221, 11.2], [0.2560000000000001, 0.35625, 0.18699999999999997, 0.125, 0.2914285714285714], [15.305000000000001, 1.5290000000000001, 0.16999999999999996, 0.485, 3.283]], [[0.25100000000000006, 0.3275, 0.27199999999999996], [6.1, 5.9, 4.2, 7.1], [-0.095, -0.06200000000000001, -0.19599999999999998, 0.02444444444444445], [-0.90375, -0.683, -0.6769999999999998, -0.611, 0.638]]], [[['2015-04-30', '2016-01-31'], ['2015-01-31', '2015-05-31', '2015-09-30'], ['2015-02-28', '2015-07-31', '2015-12-31'], ['2015-01-31', '2015-07-31', '2015-12-31']], [['2014-12-31', '2015-08-31'], ['2014-12-31', '2015-06-30', '2015-10-31'], ['2014-12-31', '2015-06-30', '2015-10-31'], ['2014-12-31', '2015-05-31']], [[0.3986363636363635, 0.5402631578947369], [10.571428571428571, 7.421052631578948, 9.1], [0.24749999999999997, -0.025714285714285717, 0.27142857142857146], [2.6199999999999997, -0.16238095238095243, 2.5480952380952377]], [[0.2602272727272727, 0.2825000000000001], [6.7272727272727275, 4.954545454545454, 7.9523809523809526], [0.00954545454545456, -0.1359090909090909, 0.04047619047619049], [2.469090909090909, -0.7057894736842105]]]], ['2016-02-10', 0.535, 0.531, 4.8, 0.030000000000000006, 1.0720000000000003], "DUFU,OVS,6,0,(c2001000,m0100000,p0001000,v0000001)"),
    ("KLSE", [[[['2015-10-18', '2016-01-03', '2016-04-17', '2016-06-12', '2016-08-21', '2016-10-30', '2016-12-18'], ['2015-10-25', '2016-01-17', '2016-03-27', '2016-06-12', '2016-08-28', '2016-10-16', '2016-12-11'], ['2016-01-03', '2016-03-27', '2016-06-12', '2016-08-21', '2016-10-30', '2017-01-01'], ['2015-12-06', '2016-01-31', '2016-03-27', '2016-06-05', '2016-08-21', '2016-10-09', '2016-12-04']], [['2015-11-22', '2016-01-24', '2016-04-03', '2016-06-19', '2016-08-07', '2016-09-25', '2016-11-20'], ['2015-12-20', '2016-03-06', '2016-05-08', '2016-06-19', '2016-08-07', '2016-09-18', '2016-11-20'], ['2015-11-22', '2016-01-24', '2016-04-03', '2016-05-22', '2016-08-07', '2016-09-25', '2016-11-20'], ['2015-11-22', '2016-03-13', '2016-05-29', '2016-07-10', '2016-09-11', '2016-10-30', '2016-12-25']], [[1712.7675, 1685.4350000000002, 1721.032, 1651.8379999999997, 1693.4180000000001, 1673.682, 1640.8374999999999], [11.0, 8.8, 10.2, 9.4, 9.2, 7.2, 7.4], [0.0075, 0.032, -0.002, 0.02, 0.006, 0.005], [0.24400000000000005, 0.6980000000000001, 0.11400000000000002, 0.966, 0.019999999999999997, 0.3575, 0.356]], [[1659.196, 1619.364, 1712.6799999999998, 1624.584, 1658.6580000000001, 1661.3739999999998, 1625.0800000000002], [2.8, 5.2, 4.25, 7.6, 6.0, 3.3333333333333335, 5.0], [-0.026000000000000002, -0.02, 0.02, -0.052000000000000005, 0.01, -0.014000000000000002, -0.024], [-0.308, -0.22200000000000003, -0.084, -0.49333333333333335, -0.21000000000000002, -0.13799999999999998, -0.36]]], [[['2015-10-25', '2016-01-03', '2016-04-24', '2016-08-28', '2016-11-06'], ['2015-10-25', '2016-01-17', '2016-03-27', '2016-06-19', '2016-08-28', '2016-12-18'], ['2016-01-03', '2016-03-27', '2016-08-28', '2016-11-06'], ['2016-01-31', '2016-06-05', '2016-10-09']], [['2015-11-22', '2016-01-31', '2016-06-05', '2016-09-25', '2016-12-04'], ['2015-12-20', '2016-05-08', '2016-09-25', '2017-01-01'], ['2015-11-22', '2016-01-31', '2016-05-22', '2016-09-25', '2016-12-04'], ['2015-11-22', '2016-04-24', '2016-07-03', '2016-11-06']], [[1710.8255555555559, 1668.2285714285715, 1718.2329999999997, 1688.6679999999997, 1666.7720000000002], [10.666666666666666, 8.2, 9.3, 8.5, 9.1, 7.0], [-0.0014285714285714281, 0.029000000000000005, 0.016000000000000004, 0.0019999999999999996], [0.399, 0.44099999999999995, 0.20555555555555557]], [[1663.29, 1628.2559999999999, 1630.9330000000002, 1662.30375, 1626.8560000000002], [4.2, 4.444444444444445, 3.5, 5.888888888888889], [-0.01875, -0.017, -0.049999999999999996, -0.011249999999999998, -0.022], [-0.29625, -0.18200000000000002, -0.2922222222222222, -0.08399999999999999]]], [[['2016-04-30', '2016-08-31'], ['2016-01-31', '2016-06-30', '2016-12-31'], ['2016-03-31', '2016-07-31'], ['2016-01-31', '2016-05-31', '2016-11-30']], [['2016-01-31', '2016-05-31', '2016-12-31'], ['2015-12-31', '2016-04-30', '2016-09-30'], ['2016-01-31', '2016-05-31', '2016-11-30'], ['2015-11-30', '2016-07-31']], [[1711.5585714285717, 1678.1523809523808], [7.3, 7.9523809523809526, 6.45], [0.027391304347826096, 0.01368421052631579], [0.162, 0.36499999999999994, 0.11190476190476188]], [[1638.2915, 1635.6524999999997, 1632.9745], [4.761904761904762, 5.285714285714286, 4.6], [-0.012, -0.04350000000000001, -0.017142857142857144], [-0.13684210526315788, -0.20315789473684207]]]], ['2017-01-03', 1635.53, 1635.53, 6.0, 0.0, -0.52], "KLSE,OVS,10,1,(c1000100,m0000001,p0000000,v0100000)"),
    ("KLSE", [[[['2017-06-18', '2017-09-17', '2017-11-12', '2018-02-04', '2018-04-22', '2018-06-10'], ['2017-05-14', '2017-06-25', '2017-08-13', '2017-10-15', '2018-01-14', '2018-03-25', '2018-06-17'], ['2017-05-21', '2017-08-20', '2017-11-12', '2018-01-14', '2018-02-25', '2018-04-22', '2018-06-17'], ['2017-06-04', '2017-08-06', '2017-10-01', '2017-12-03', '2018-02-11', '2018-04-22', '2018-06-03']], [['2017-06-04', '2017-07-16', '2017-09-03', '2017-12-03', '2018-02-11', '2018-05-13', '2018-07-01'], ['2017-06-04', '2017-07-23', '2017-10-08', '2017-11-26', '2018-02-25', '2018-05-20', '2018-07-01'], ['2017-04-23', '2017-06-04', '2017-07-23', '2017-09-03', '2017-10-29', '2018-01-28', '2018-03-11', '2018-05-13', '2018-07-01'], ['2017-05-14', '2017-07-16', '2017-10-15', '2017-12-31', '2018-02-18', '2018-04-08', '2018-05-27', '2018-07-08']], [[1789.5275000000001, 1785.274, 1744.9275, 1869.86, 1884.3, 1770.3139999999999], [9.666666666666666, 7.0, 9.25, 4.0, 9.8, 9.6, 5.0], [0.015999999999999997, 0.01, -0.0075, 0.05399999999999999, 0.018, 0.014000000000000002, -0.0475], [0.32199999999999995, -0.142, 0.462, 0.895, 0.5625, 0.08399999999999999, 1.9675]], [[1767.232, 1755.636, 1767.93, 1718.1299999999999, 1830.5049999999999, 1837.355, 1675.4440000000002], [4.6, 5.0, 3.2, 3.0, 5.6, 4.0, 2.6], [0.002, 0.008, -0.018, 0.0, -0.018, 0.048, 0.0, -0.01, -0.068], [-0.25666666666666665, -0.30400000000000005, -0.15799999999999997, -0.26, -0.3025, -0.31399999999999995, 0.8220000000000001, -0.522]]], [[['2017-06-25', '2017-09-17', '2018-02-04', '2018-04-29'], ['2017-05-14', '2017-08-20', '2017-10-29', '2018-01-21', '2018-04-01', '2018-06-10'], ['2017-05-14', '2017-08-20', '2017-11-12', '2018-01-21', '2018-04-29'], ['2017-06-11', '2017-10-01', '2017-12-10', '2018-02-18', '2018-05-27']], [['2017-07-23', '2017-12-10', '2018-02-18', '2018-07-08'], ['2017-06-11', '2017-11-26', '2018-03-04', '2018-07-08'], ['2017-07-23', '2017-10-29', '2018-04-15', '2018-07-08'], ['2017-07-23', '2017-10-15', '2018-01-07', '2018-04-01']], [[1784.4633333333336, 1781.2622222222221, 1852.1987499999998, 1873.4870000000003], [9.285714285714286, 9.11111111111111, 3.888888888888889, 9.1, 9.6, 4.777777777777778], [0.014285714285714287, 0.008888888888888889, -0.008888888888888889, 0.05199999999999999, 0.009], [0.14299999999999996, 0.37444444444444447, 0.7277777777777777, 0.13, 1.0]], [[1756.0350000000003, 1718.791111111111, 1832.3025, 1678.56], [5.3, 3.4, 5.8, 2.8], [-0.016, -0.017777777777777778, 3.4694469519536144e-19, -0.06100000000000001], [-0.255, -0.131, -0.16249999999999998, -0.22100000000000003]]], [[['2017-06-30', '2018-04-30'], ['2017-08-31', '2018-01-31'], ['2017-05-31', '2018-01-31'], ['2017-05-31', '2017-12-31', '2018-05-31']], [['2017-07-31', '2017-11-30'], ['2017-07-31', '2017-11-30', '2018-06-30'], ['2017-10-31', '2018-06-30'], ['2017-07-31', '2018-03-31']], [[1781.3594736842106, 1863.1485714285711], [8.380952380952381, 8.571428571428571], [0.013500000000000003, 0.050000000000000024], [0.05349999999999999, 0.3463157894736842, 1.0833333333333333]], [[1760.8680952380957, 1729.1942857142858], [5.571428571428571, 3.5238095238095237, 4.2], [-0.013333333333333329, -0.05800000000000002], [-0.22380952380952368, -0.17818181818181822]]]], ['2018-07-12', 1703.57, 1684.497777777778, 4.555555555555555, -0.04777777777777777, -0.5155555555555557], "KLSE,OVS,11,0,(c0101000,m0000010,p0000110,v0101000)"),
])
@pytest.mark.skip
def test_oversold_success(counter, pnlist, lasttxn, expected):
    result = scanSignals(0, counter, "", pnlist, lasttxn)
    assert result.replace('\t', '') == expected, "*** Input = " + counter + "," + lasttxn[0]


# BTM 2018-11-15 disqualified OVS1 due to prevtopP
# CHOOBEE 2018-11-15 disqualified OVS1 due to lower P
# BONIA 2018-11-15 disqualified OVS2 due to no lower P
#     1. maxC in clist[0] position
#     2. price on new low vs PADINI 2011-09-30 retrace from high
# BENALEC 2018-11-15 disqualified OVS2 due to prevtopP
# DUFU 2016-03-15
@pytest.mark.parametrize("counter,pnlist,lasttxn,expected", [
    ("BENALEC", [[[['2017-09-24', '2017-11-05', '2018-01-14', '2018-02-25', '2018-04-15', '2018-07-29'], ['2017-09-10', '2017-11-05', '2017-12-24', '2018-02-11', '2018-05-20', '2018-07-22', '2018-10-07'], ['2017-09-24', '2017-11-05', '2018-01-14', '2018-03-04', '2018-05-20', '2018-07-29', '2018-10-07'], ['2017-09-24', '2017-11-05', '2018-01-07', '2018-03-18', '2018-06-10', '2018-07-29', '2018-09-16', '2018-11-04']], [['2017-09-17', '2017-10-29', '2017-12-10', '2018-01-28', '2018-03-11', '2018-05-13', '2018-07-08', '2018-08-19', '2018-11-04'], ['2017-10-01', '2017-12-03', '2018-01-28', '2018-04-01', '2018-06-10', '2018-09-16', '2018-10-28'], ['2017-09-17', '2017-10-29', '2017-12-10', '2018-02-18', '2018-04-08', '2018-07-01', '2018-10-21'], ['2017-09-03', '2017-10-15', '2017-12-10', '2018-02-18', '2018-05-06', '2018-07-15', '2018-09-02', '2018-10-28']], [[0.4325, 0.42400000000000004, 0.41100000000000003, 0.384, 0.31399999999999995, 0.303], [10.0, 9.0, 8.6, 10.0, 11.0, 13.4, 11.6], [0.045000000000000005, 0.009999999999999998, 0.08600000000000001, -0.028000000000000004, -0.026000000000000002, 0.16, -0.132], [0.3499999999999999, 2.6599999999999997, 2.8925, 0.982, 0.7220000000000001, 4.864, -0.30333333333333334, 0.756]], [[0.421, 0.4109999999999999, 0.375, 0.395, 0.363, 0.2925, 0.255, 0.288, 0.20299999999999999], [5.8, 4.75, 8.0, 2.6, 8.6, 7.333333333333333, 8.6], [0.014000000000000002, -0.028000000000000004, -0.1, -0.0675, -0.162, -0.11199999999999999, -0.16399999999999998], [-0.3333333333333334, -0.48, -0.7979999999999999, -0.8375, -0.7533333333333333, -0.49399999999999994, -0.8, -0.031999999999999994]]], [[['2017-09-24', '2018-01-14', '2018-05-20', '2018-08-12'], ['2017-11-05', '2018-02-11', '2018-05-20', '2018-07-29', '2018-10-07'], ['2017-09-24', '2018-01-14', '2018-05-20', '2018-08-12'], ['2017-11-05', '2018-01-14', '2018-07-29', '2018-11-04']], [['2017-12-17', '2018-05-06', '2018-07-15'], ['2017-12-03', '2018-04-08', '2018-09-23'], ['2017-12-17', '2018-04-22', '2018-07-01', '2018-11-04'], ['2017-09-10', '2017-12-17', '2018-02-25', '2018-05-06', '2018-09-09']], [[0.42611111111111116, 0.40777777777777785, 0.30214285714285716, 0.289], [8.9, 10.0, 10.714285714285714, 13.2, 10.7], [0.027777777777777776, 0.07444444444444445, -0.04428571428571428, 0.121], [1.153, 2.1422222222222222, 3.194, 0.362]], [[0.376, 0.29312499999999997, 0.25599999999999995], [5.333333333333333, 3.0, 7.714285714285714], [-0.088, -0.147, -0.11100000000000002, -0.15699999999999997], [-0.24285714285714288, -0.7499999999999999, -0.5244444444444444, -0.6362500000000001, -0.6533333333333334]]], [[['2017-09-30', '2018-01-31', '2018-08-31'], ['2017-10-31', '2018-02-28', '2018-07-31'], ['2017-09-30', '2018-01-31', '2018-08-31'], ['2018-01-31', '2018-07-31']], [['2017-12-31', '2018-06-30'], ['2017-11-30', '2018-03-31', '2018-09-30'], ['2017-12-31', '2018-04-30', '2018-10-31'], ['2017-12-31', '2018-05-31', '2018-09-30']], [[0.423611111111111, 0.40142857142857136, 0.2864285714285715], [8.238095238095237, 9.11111111111111, 11.772727272727273], [0.017777777777777774, 0.04714285714285715, 0.0580952380952381], [0.971428571428571, 1.22]], [[0.3821052631578946, 0.26799999999999996], [6.7272727272727275, 4.681818181818182, 8.529411764705882], [-0.05105263157894737, -0.14904761904761904, -0.15130434782608695], [-0.4289473684210526, -0.5817647058823529, -0.4270588235294118]]]], ['2018-11-15', 0.205, 0.20400000000000001, 10.6, -0.10500000000000001, 0.5269999999999999], "BENALEC,Dbg,0,0,(c0100000,m3000010,p0000110,v0000010)"),
    ("BTM", [[[['2017-08-06', '2017-09-17', '2017-11-12', '2018-02-18', '2018-05-20', '2018-08-19', '2018-09-30'], ['2017-07-23', '2017-09-03', '2017-10-22', '2018-01-07', '2018-02-25', '2018-05-06', '2018-07-01', '2018-08-19', '2018-10-21'], ['2017-08-06', '2017-09-17', '2017-11-12', '2018-02-18', '2018-05-20', '2018-08-19', '2018-09-30'], ['2017-07-23', '2017-09-17', '2017-10-29', '2018-01-14', '2018-02-25', '2018-06-17', '2018-08-19']], [['2017-08-20', '2017-11-05', '2017-12-31', '2018-02-11', '2018-04-22', '2018-07-15', '2018-09-23', '2018-11-04'], ['2017-08-13', '2017-09-24', '2017-12-10', '2018-02-11', '2018-04-08', '2018-06-10', '2018-08-12', '2018-09-23'], ['2017-07-30', '2017-09-24', '2017-11-05', '2017-12-31', '2018-02-11', '2018-04-01', '2018-07-01', '2018-08-12', '2018-09-23', '2018-11-04'], ['2017-08-20', '2017-10-15', '2017-12-10', '2018-02-04', '2018-03-25', '2018-05-20', '2018-07-29', '2018-10-07']], [[0.251, 0.25200000000000006, 0.281, 0.26625, 0.16375, 0.158, 0.13], [8.6, 8.0, 10.5, 9.0, 9.2, 10.333333333333334, 10.2, 8.2, 6.5], [-0.041999999999999996, 0.028000000000000004, 0.148, 0.05500000000000001, 0.06, 0.11400000000000002, -0.14400000000000002], [0.358, 0.132, 9.599999999999998, 2.64, 23.901999999999997, 2.83, 34.132]], [[0.23899999999999996, 0.265, 0.245, 0.22125, 0.149, 0.14, 0.12, 0.10000000000000002], [6.6, 8.0, 7.666666666666667, 8.25, 4.4, 7.2, 6.6, 3.5], [-0.08600000000000001, -0.02, 0.086, -0.08499999999999999, -0.11750000000000001, -0.308, -0.06799999999999999, 0.026000000000000002, -0.2125, -0.20333333333333337], [-0.9339999999999999, -0.6125, -0.8999999999999999, -0.7200000000000001, -0.9199999999999999, -0.8375000000000001, -0.8139999999999998, -0.9575]]], [[['2017-09-03', '2017-11-12', '2018-01-21', '2018-05-27', '2018-08-19'], ['2017-07-23', '2017-10-29', '2018-02-04', '2018-05-13', '2018-09-02'], ['2017-11-12', '2018-01-21', '2018-05-27', '2018-08-19'], ['2017-10-29', '2018-03-04', '2018-08-19']], [['2017-10-01', '2018-01-07', '2018-04-29', '2018-07-22', '2018-10-28'], ['2017-08-20', '2017-12-10', '2018-03-18', '2018-06-10', '2018-09-30'], ['2017-07-23', '2017-10-01', '2018-01-07', '2018-04-01', '2018-07-08', '2018-10-14'], ['2017-09-03', '2017-12-10', '2018-04-01', '2018-08-05', '2018-10-14']], [[0.25, 0.273, 0.256, 0.15777777777777777, 0.15250000000000002], [8.0, 9.88888888888889, 9.0, 10.25, 7.5], [0.11700000000000002, -0.015, 0.028888888888888884, 0.07], [7.272222222222221, 16.796, 17.542]], [[0.24083333333333332, 0.246, 0.15, 0.14142857142857143, 0.10944444444444444], [7.1, 7.833333333333333, 4.9, 7.666666666666667, 4.111111111111111], [-0.07699999999999999, -0.016666666666666666, -0.06999999999999999, -0.3, -0.06400000000000002, -0.175], [-0.8066666666666666, -0.8650000000000001, -0.8720000000000001, -0.7166666666666667, -0.91375]]], [[['2017-11-30', '2018-05-31'], ['2017-10-31', '2018-05-31'], ['2017-11-30', '2018-08-31'], ['2017-10-31', '2018-02-28', '2018-08-31']], [['2017-08-31', '2018-04-30', '2018-10-31'], ['2017-08-31', '2018-03-31', '2018-09-30'], ['2018-03-31', '2018-10-31'], ['2017-08-31', '2017-12-31', '2018-07-31']], [[0.2659523809523809, 0.1553333333333333], [9.45, 9.4], [0.05047619047619048, 0.06157894736842106], [3.5375, 9.48470588235294, 12.361578947368422]], [[0.24525000000000002, 0.15199999999999994, 0.11263157894736846], [7.2, 5.409090909090909, 4.5625], [-0.27045454545454545, -0.16894736842105265], [-0.7360000000000001, -0.7223076923076923, -0.7070588235294119]]]], ['2018-11-15', 0.155, 0.12875, 7.75, 0.05374999999999999, 7.22125], "BTM,Dbg,0,0,(c1000100,m0000100,p3000010,v0001000)"),
    ("BONIA", [[[['2017-10-15', '2018-01-14', '2018-02-25', '2018-05-27', '2018-08-26', '2018-10-28'], ['2017-10-08', '2017-11-19', '2018-01-14', '2018-03-04', '2018-05-20', '2018-07-01', '2018-08-26', '2018-11-11'], ['2017-09-24', '2018-01-14', '2018-03-04', '2018-05-27', '2018-07-29', '2018-10-28'], ['2017-09-10', '2017-12-10', '2018-02-04', '2018-03-25', '2018-05-20', '2018-07-29', '2018-10-14']], [['2017-09-03', '2017-10-29', '2017-12-31', '2018-03-11', '2018-05-13', '2018-07-08', '2018-11-04'], ['2017-09-24', '2017-11-12', '2018-02-04', '2018-04-15', '2018-06-10', '2018-07-22', '2018-09-16', '2018-11-04'], ['2017-10-01', '2017-12-10', '2018-02-11', '2018-04-08', '2018-07-01', '2018-08-19', '2018-11-04'], ['2017-09-03', '2017-11-05', '2018-01-21', '2018-03-04', '2018-05-06', '2018-06-17', '2018-09-02', '2018-11-04']], [[0.664, 0.5559999999999999, 0.513, 0.4779999999999999, 0.44625, 0.334], [8.0, 7.0, 9.6, 9.2, 9.6, 8.2, 9.5, 8.5], [0.14500000000000002, 0.062, -0.008, 0.082, 0.05600000000000001, -0.134], [7.59, 3.7119999999999997, 1.626666666666667, 0.278, 2.646, 5.186, 3.6]], [[0.57, 0.644, 0.50625, 0.476, 0.405, 0.414, 0.265], [7.5, 5.8, 3.3333333333333335, 3.2, 5.6, 5.8, 4.0, 6.6], [0.08800000000000001, -0.198, -0.084, -0.11200000000000002, -0.098, 0.02, -0.28400000000000003], [0.10999999999999995, -0.86, -0.5700000000000001, -0.644, -0.8375, -0.865, -0.485, -0.55]]], [[['2017-10-22', '2018-01-14', '2018-06-03', '2018-08-26'], ['2017-10-08', '2018-01-14', '2018-05-20', '2018-08-26'], ['2017-09-24', '2018-01-14', '2018-03-25', '2018-06-03', '2018-08-12'], ['2017-09-10', '2017-12-17', '2018-05-20', '2018-07-29', '2018-10-07']], [['2017-10-08', '2018-02-11', '2018-05-06', '2018-07-15'], ['2017-11-05', '2018-02-11', '2018-04-22', '2018-09-23'], ['2017-12-17', '2018-05-06', '2018-11-04'], ['2017-11-05', '2018-01-28', '2018-04-22', '2018-07-01', '2018-09-09']], [[0.6622222222222223, 0.5433333333333333, 0.4655555555555555, 0.44], [7.9, 9.333333333333334, 9.428571428571429, 9.333333333333334], [0.14333333333333334, 0.01666666666666667, -0.019, 0.060000000000000005, 0.041999999999999996], [4.384285714285714, 1.843, 1.6785714285714286, 2.818, 1.9129999999999998]], [[0.634, 0.48875, 0.4222222222222223, 0.4165], [6.1, 3.5, 4.2, 4.428571428571429], [-0.18999999999999997, -0.0922222222222222, -0.20900000000000002], [-0.8149999999999998, -0.24400000000000005, -0.748, -0.7689999999999999, -0.3088888888888889]]], [[['2017-10-31', '2018-05-31'], ['2018-01-31', '2018-08-31'], ['2017-09-30', '2018-01-31', '2018-08-31'], ['2017-09-30', '2018-05-31', '2018-10-31']], [['2017-12-31', '2018-07-31'], ['2017-11-30', '2018-04-30', '2018-09-30'], ['2017-12-31', '2018-04-30'], ['2017-10-31', '2018-06-30']], [[0.6545238095238096, 0.4519444444444444], [7.904761904761905, 8.761904761904763], [0.11333333333333334, 0.009523809523809525, 0.020476190476190474], [2.9694444444444446, 1.2311111111111113, 0.9213043478260871]], [[0.5105263157894738, 0.4270454545454545], [6.5, 4.857142857142857, 5.176470588235294], [-0.16684210526315787, -0.09333333333333337], [-0.38999999999999996, -0.5265]]]], ['2018-11-15', 0.27, 0.2785, 8.0, -0.20299999999999999, -0.183], "BONIA,Dbg,0,0,(c0100000,m3000010,p0100000,v0000001)"),
    ("CHOOBEE", [[[['2017-09-24', '2017-11-05', '2018-01-14', '2018-02-25', '2018-05-20', '2018-07-22', '2018-09-02', '2018-11-04'], ['2017-09-24', '2017-12-31', '2018-03-04', '2018-04-15', '2018-07-22', '2018-10-07'], ['2017-09-24', '2017-11-05', '2018-01-07', '2018-02-25', '2018-05-20', '2018-07-22', '2018-09-16'], ['2017-09-24', '2017-12-03', '2018-01-21', '2018-03-11', '2018-06-03', '2018-08-19', '2018-10-14']], [['2017-09-03', '2017-11-26', '2018-02-11', '2018-04-08', '2018-06-10', '2018-08-05', '2018-10-28'], ['2017-10-08', '2017-11-26', '2018-02-11', '2018-05-06', '2018-07-08', '2018-09-16', '2018-10-28'], ['2017-09-03', '2017-11-26', '2018-02-11', '2018-04-08', '2018-06-10', '2018-08-05', '2018-10-28'], ['2017-08-27', '2017-10-29', '2017-12-24', '2018-02-18', '2018-04-22', '2018-07-15', '2018-09-16', '2018-11-11']], [[2.43, 2.424, 2.5780000000000003, 2.632, 2.4400000000000004, 2.258, 1.9, 1.544], [9.25, 10.75, 9.6, 8.4, 9.4, 5.6], [0.15000000000000002, 0.032, 0.09, 0.042, 0.036000000000000004, 0.0, -0.05000000000000001], [2.54, 3.2725, 0.518, 2.178, 2.7950000000000004, 2.652, 0.3375]], [[2.106666666666667, 2.312, 2.408, 2.302, 2.1759999999999997, 1.876, 1.498], [7.0, 5.4, 5.0, 5.75, 6.2, 4.333333333333333, 3.4], [0.02, -0.044, -0.042, -0.092, -0.08, -0.158, -0.15200000000000002], [0.294, -0.808, -0.7979999999999999, -0.585, -0.78, -0.7540000000000001, -0.8333333333333334, -0.7799999999999999]]], [[['2017-11-12', '2018-03-04', '2018-05-27'], ['2017-09-17', '2018-01-07', '2018-05-27', '2018-08-05', '2018-10-14'], ['2017-09-17', '2018-01-21', '2018-05-27', '2018-09-16'], ['2017-10-01', '2017-12-10', '2018-03-18', '2018-06-10', '2018-08-19', '2018-10-28']], [['2017-09-03', '2017-11-26', '2018-02-18', '2018-06-10', '2018-11-11'], ['2017-11-26', '2018-02-04', '2018-05-13', '2018-10-28'], ['2017-11-26', '2018-02-18', '2018-06-10', '2018-08-19', '2018-10-28'], ['2017-10-29', '2018-02-18', '2018-05-13', '2018-09-16']], [[2.415, 2.608, 2.387], [9.11111111111111, 10.625, 7.1, 8.9, 5.444444444444445], [0.10888888888888888, 0.07200000000000002, 0.013000000000000001, -0.05499999999999999], [1.1866666666666665, 1.7188888888888887, 1.043, 1.3244444444444448, 1.156, -0.207]], [[2.19875, 2.351, 2.4522222222222223, 2.1844444444444444, 1.5377777777777777], [6.1, 5.25, 5.833333333333333, 4.2], [-0.025, -0.02888888888888889, -0.07666666666666667, -0.13400000000000004, -0.13599999999999998], [-0.7622222222222222, -0.5, -0.7183333333333334, -0.7533333333333333]]], [[['2018-01-31', '2018-05-31'], ['2017-09-30', '2018-03-31', '2018-07-31'], ['2017-09-30', '2018-01-31', '2018-05-31', '2018-09-30'], ['2017-09-30', '2018-03-31', '2018-08-31']], [['2017-12-31', '2018-04-30'], ['2017-11-30', '2018-05-31', '2018-10-31'], ['2017-11-30', '2018-04-30', '2018-08-31'], ['2017-10-31', '2018-04-30', '2018-09-30']], [[2.5338095238095244, 2.3533333333333335], [9.055555555555555, 8.181818181818182, 7.909090909090909], [0.10722222222222222, 0.06190476190476192, -0.0022222222222222227, -0.07142857142857141], [1.1544444444444446, 0.2713636363636364, 0.3590476190476191]], [[2.3731578947368424, 2.3485714285714283], [6.454545454545454, 6.666666666666667, 4.7272727272727275], [-0.0040909090909090895, -0.05333333333333335, -0.12095238095238094], [-0.6157142857142857, -0.5452380952380953, -0.4857142857142857]]]], ['2018-11-15', 1.65, 1.5580000000000003, 5.3, -0.074, -0.5369999999999999], "CHOOBEE,Dbg,0,0,(c0100000,m0000100,p0000001,v0000000)"),
    ("DUFU", [[[['2015-02-08', '2015-04-19', '2015-07-26', '2015-10-25', '2016-01-17', '2016-02-28'], ['2015-02-15', '2015-05-24', '2015-07-26', '2015-09-13', '2015-10-25', '2015-12-06', '2016-02-28'], ['2015-02-08', '2015-04-19', '2015-06-07', '2015-07-26', '2015-09-27', '2015-12-27', '2016-02-07'], ['2015-02-01', '2015-04-19', '2015-06-07', '2015-07-26', '2015-10-25', '2015-12-13', '2016-02-07']], [['2015-03-08', '2015-05-10', '2015-07-05', '2015-08-23', '2015-10-18', '2016-01-31'], ['2015-01-25', '2015-04-12', '2015-06-28', '2015-08-16', '2015-10-04', '2015-11-15', '2015-12-27', '2016-02-14'], ['2015-01-04', '2015-03-08', '2015-07-05', '2015-08-23', '2015-10-18', '2016-01-10', '2016-02-21'], ['2015-03-22', '2015-05-31', '2015-08-09', '2015-10-11', '2015-11-29', '2016-02-14']], [[0.3983333333333334, 0.422, 0.344, 0.32599999999999996, 0.5730000000000001, 0.554], [11.4, 8.4, 9.2, 10.4, 8.8, 11.8, 6.0], [0.4666666666666666, 0.21200000000000002, -0.04, 0.122, 0.14250000000000002, 0.3466666666666667, 0.035], [9.654, 2.962, -0.472, 0.5860000000000001, 2.0679999999999996, 4.683999999999999, 1.5525000000000002]], [[0.305, 0.365, 0.288, 0.27, 0.30625, 0.50625], [10.4, 5.4, 3.6, 6.4, 7.0, 7.0, 7.666666666666667, 3.6666666666666665], [-0.09500000000000001, -0.10200000000000001, -0.20599999999999996, -0.16, 0.0, 0.20400000000000001, -0.030000000000000006], [-0.8099999999999999, -0.8480000000000001, -0.748, -0.542, 1.624, -0.7133333333333333]]], [[['2015-02-08', '2015-04-19', '2015-07-26', '2015-10-04', '2016-01-24'], ['2015-02-08', '2015-05-31', '2015-09-20', '2015-12-13', '2016-03-06'], ['2015-02-08', '2015-04-19', '2015-07-26', '2015-10-04', '2015-12-27', '2016-03-06'], ['2015-02-08', '2015-04-19', '2015-07-26', '2015-10-04', '2015-12-13']], [['2015-03-08', '2015-05-17', '2015-08-23', '2016-02-07'], ['2015-04-19', '2015-06-28', '2015-11-15', '2016-02-21'], ['2015-03-22', '2015-06-28', '2015-10-18', '2016-02-21'], ['2015-03-22', '2015-05-31', '2015-08-09', '2015-10-18', '2016-02-21']], [[0.36437499999999995, 0.4065, 0.3355555555555555, 0.3133333333333333, 0.5670000000000001], [11.25, 7.8, 9.88888888888889, 10.9, 5.5], [0.38, 0.188, 0.06555555555555556, 0.12222222222222223, 0.27625, 5.204170427930421e-19], [8.62875, 2.159, 0.11888888888888888, 0.2644444444444445, 3.225]], [[0.32449999999999996, 0.36999999999999994, 0.27749999999999997, 0.5181250000000001], [6.3, 3.9, 7.222222222222222, 3.875], [-0.019999999999999997, -0.186, 0.026666666666666665, -0.022500000000000003], [-0.7550000000000001, -0.836, -0.6844444444444444, -0.3911111111111112, -0.6575]]], [[['2015-04-30', '2016-01-31'], ['2015-01-31', '2015-05-31', '2015-09-30'], ['2015-02-28', '2015-07-31', '2015-12-31'], ['2015-01-31', '2015-07-31', '2015-12-31']], [['2015-03-31', '2015-08-31'], ['2015-06-30', '2015-10-31', '2016-02-29'], ['2015-06-30', '2015-10-31'], ['2015-05-31']], [[0.3986363636363635, 0.5402631578947369], [10.571428571428571, 7.421052631578948, 9.1], [0.24749999999999997, -0.025714285714285717, 0.27142857142857146], [2.6199999999999997, -0.16238095238095243, 2.5480952380952377]], [[0.34568181818181815, 0.2825000000000001], [4.954545454545454, 7.9523809523809526, 4.722222222222222], [-0.1359090909090909, 0.04047619047619049], [-0.7057894736842105]]]], ['2016-03-15', 0.48, 0.49272727272727274, 5.181818181818182, -0.07, -0.41727272727272724], "DUFU,Dbg,0,0,(c2001001,m0000100,p0001000,v0000001)"),
])
@pytest.mark.skip
def test_oversold_fail(counter, pnlist, lasttxn, expected):
    result = scanSignals(1, counter, "", pnlist, lasttxn)
    assert result.replace('\t', '') == expected, "*** Input = " + counter + "," + lasttxn[0]


# PADINI 2012-09-03 replaced 2012-08-29 TSS,1,1
#   ("PADINI", [[[['2011-06-19', '2011-09-04', '2011-10-30', '2012-01-15', '2012-03-18', '2012-06-03', '2012-07-15'], ['2011-07-24', '2011-10-30', '2012-01-15', '2012-03-18', '2012-05-06', '2012-07-01', '2012-08-12'], ['2011-06-19', '2011-07-31', '2011-10-30', '2011-12-11', '2012-02-05', '2012-05-13', '2012-07-01', '2012-08-19'], ['2011-06-19', '2011-09-04', '2011-11-06', '2012-01-29', '2012-04-29', '2012-07-29']], [['2011-07-10', '2011-10-02', '2011-11-13', '2012-01-22', '2012-03-25', '2012-05-20', '2012-07-08'], ['2011-06-26', '2011-08-28', '2011-11-20', '2012-02-26', '2012-04-08', '2012-05-27', '2012-07-29'], ['2011-07-10', '2011-08-28', '2011-11-27', '2012-01-08', '2012-04-08', '2012-06-10', '2012-07-29'], ['2011-07-03', '2011-08-21', '2011-10-09', '2011-12-25', '2012-02-26', '2012-04-15', '2012-07-01', '2012-08-26']], [[1.114, 0.9275, 1.04, 1.158, 1.498, 1.77, 1.9599999999999997], [10.2, 10.5, 9.6, 10.2, 10.75, 9.2, 7.8], [0.003999999999999998, 0.016, 0.1925, 0.084, 0.18000000000000002, 0.21799999999999997, 0.11200000000000002, 0.174], [1.084, 2.065, 3.902, 4.96, 2.696, 0.954]], [[1.052, 0.841, 1.0, 1.1500000000000001, 1.4099999999999997, 1.608, 1.846], [7.6, 3.4, 5.2, 7.4, 6.2, 6.4, 7.4], [-0.046, -0.15000000000000002, 0.026000000000000002, 0.034999999999999996, -0.016, 0.006, 0.04], [-0.798, 0.06, -0.8219999999999998, -0.6719999999999999, 0.22199999999999998, -0.74, -0.6439999999999999, -0.4633333333333334]]], [[['2011-06-26', '2011-12-11', '2012-05-13'], ['2011-07-24', '2011-10-30', '2012-01-08', '2012-05-13', '2012-08-19'], ['2011-08-07', '2011-10-30', '2012-02-05', '2012-05-13', '2012-07-22'], ['2011-06-26', '2011-09-04', '2011-11-13', '2012-01-22', '2012-04-29', '2012-08-05']], [['2011-07-10', '2011-10-02', '2011-12-25', '2012-04-01'], ['2011-09-04', '2011-11-27', '2012-04-15', '2012-08-05'], ['2011-09-04', '2012-01-08', '2012-04-15', '2012-08-05'], ['2011-07-10', '2011-10-02', '2011-12-25', '2012-04-15', '2012-07-08']], [[1.0930000000000002, 1.0855555555555556, 1.7133333333333334], [9.9, 10.11111111111111, 8.75, 10.555555555555555, 7.8], [0.009, 0.1733333333333333, 0.1771428571428571, 0.2033333333333333, 0.096], [0.19899999999999993, 2.0285714285714285, 2.8877777777777776, 2.949, 1.1019999999999999, 0.8240000000000001]], [[1.0560000000000003, 0.8616666666666667, 1.078, 1.4109999999999998], [3.7142857142857144, 5.4, 6.444444444444445, 7.4], [-0.1457142857142857, 0.0375, -0.013333333333333332, 0.081], [-0.7040000000000001, -0.6011111111111112, -0.5780000000000001, -0.6322222222222221, -0.572]]], [[None, ['2011-07-31', '2012-03-31', '2012-07-31'], ['2011-10-31', '2012-02-29'], ['2011-08-31', '2012-01-31', '2012-07-31']], [['2011-09-30'], ['2011-09-30', '2012-04-30'], ['2011-09-30', '2012-04-30'], ['2011-09-30', '2012-06-30']], [None, [9.428571428571429, 9.272727272727273, 8.0], [0.087, 0.1411111111111111], [0.6733333333333333, 2.586842105263158, 0.21863636363636363]], [[0.8926315789473683], [5.315789473684211, 7.75], [-0.10210526315789475, 0.043000000000000003], [-0.3, -0.4828571428571428]]]], ['2012-08-29', 2.33, 2.2278947368421047, 7.315789473684211, 0.15526315789473683, 0.011052631578947413], "PADINI,TSS,1,1,(c4010000,m0000000,p4010000,v0000001)"),
# PADINI 2014-05-08 replaced 2014-03-13 TSS,4,0, PADINI 2014-04-02 TSS,4,1
#   ("PADINI", [[[['2013-01-06', '2013-02-17', '2013-04-14', '2013-06-02', '2013-07-14', '2013-09-22', '2013-12-29', '2014-02-16'], ['2013-01-13', '2013-03-03', '2013-04-14', '2013-06-02', '2013-08-25', '2013-10-20', '2013-12-29'], ['2013-01-13', '2013-03-17', '2013-06-02', '2013-08-11', '2013-09-22', '2013-12-22'], ['2013-02-10', '2013-04-14', '2013-05-26', '2013-08-11', '2013-10-20', '2013-12-01', '2014-02-02']], [['2013-01-27', '2013-05-05', '2013-07-07', '2013-09-01', '2013-11-17', '2014-02-09'], ['2013-01-27', '2013-05-05', '2013-07-21', '2013-09-01', '2013-12-01', '2014-02-16'], ['2013-01-27', '2013-03-31', '2013-05-12', '2013-07-07', '2013-09-01', '2013-11-17', '2014-02-09'], ['2013-01-13', '2013-02-24', '2013-04-21', '2013-06-09', '2013-08-04', '2013-09-22', '2013-11-03', '2014-01-19']], [[1.8699999999999999, 1.8966666666666665, 1.97, 2.1119999999999997, 1.8820000000000001, 1.8025, 1.7925, 1.6179999999999999], [6.8, 12.8, 9.4, 9.0, 8.0, 9.5, 9.0], [0.024, 0.05, 0.156, -0.035, 0.02, 0.05], [0.8619999999999999, 2.4, 0.385, 1.755, 0.5675, 1.8559999999999999, 0.6374999999999998]], [[1.7775, 1.7925, 1.866, 1.7259999999999998, 1.67, 1.5950000000000002], [3.75, 3.5, 3.8, 6.4, 4.4, 1.4], [-0.022500000000000003, 0.030000000000000006, -0.07, -0.11399999999999999, -0.052000000000000005, -0.057999999999999996, -0.10500000000000001], [-0.55, -0.558, -0.050000000000000024, -0.8459999999999999, -0.24000000000000005, -0.8175, -0.518, -0.2866666666666667]]], [[['2013-01-06', '2013-03-17', '2013-06-09', '2013-09-29', '2014-01-05'], ['2013-03-03', '2013-06-09', '2013-10-27', '2014-01-05'], ['2013-03-17', '2013-06-09', '2013-09-29', '2013-12-22'], ['2013-02-03', '2013-04-14', '2013-07-21', '2013-10-13', '2013-12-22']], [['2013-02-03', '2013-05-12', '2013-09-01', '2013-11-24', '2014-02-16'], ['2013-02-03', '2013-05-12', '2013-07-21', '2013-11-24', '2014-02-16'], ['2013-02-03', '2013-07-07', '2013-11-24', '2014-02-16'], ['2013-01-06', '2013-03-17', '2013-06-23', '2013-09-29', '2014-01-19']], [[1.8525, 1.8960000000000001, 2.1049999999999995, 1.79, 1.7900000000000003], [12.0, 8.6, 9.222222222222221, 9.0], [0.039, 0.156, 0.015555555555555557, 0.045], [0.40571428571428575, 1.382, 0.593, 0.24700000000000005, 1.8170000000000002]], [[1.8000000000000003, 1.795555555555556, 1.7459999999999998, 1.674, 1.6077777777777778], [4.285714285714286, 4.111111111111111, 4.3, 4.9, 2.111111111111111], [-0.011428571428571429, -0.09999999999999999, -0.05499999999999999, -0.09444444444444444], [-0.06750000000000003, -0.354, -0.64, -0.77, -0.13499999999999995]]], [[['2013-01-31', '2013-06-30', '2013-12-31'], ['2013-03-31', '2013-10-31'], ['2013-01-31', '2013-06-30', '2013-12-31'], ['2013-04-30', '2013-12-31']], [['2013-02-28', '2013-08-31', '2014-02-28'], ['2013-01-31', '2013-07-31', '2014-02-28'], ['2013-02-28', '2013-07-31', '2014-02-28'], ['2013-06-30', '2014-01-31']], [[1.8344999999999998, 2.0220000000000002, 1.7771428571428571], [10.523809523809524, 8.5], [0.003, 0.05500000000000001, 0.03857142857142858], [0.9104545454545453, 1.0580952380952384]], [[1.8317647058823525, 1.7657894736842108, 1.6321052631578947], [5.45, 4.695652173913044, 4.2105263157894735], [-0.0029411764705882353, -0.08695652173913046, -0.06052631578947369], [-0.6950000000000001, 0.11473684210526312]]]], ['2014-03-13', 1.96, 1.8655555555555559, 10.333333333333334, 0.15000000000000002, 1.3477777777777777], "PADINI,TSS,4,0,(c3000100,m3000100,p4010000,v4010000)"),
#   ("PADINI", [[[['2013-02-17', '2013-04-14', '2013-06-02', '2013-07-14', '2013-09-22', '2013-12-29', '2014-03-23'], ['2013-03-03', '2013-04-14', '2013-06-02', '2013-08-25', '2013-10-20', '2013-12-29', '2014-03-16'], ['2013-02-03', '2013-03-17', '2013-06-02', '2013-08-11', '2013-09-22', '2013-12-22', '2014-03-23'], ['2013-02-10', '2013-04-14', '2013-05-26', '2013-08-11', '2013-10-20', '2013-12-01', '2014-02-02', '2014-03-23']], [['2013-01-27', '2013-05-05', '2013-07-07', '2013-09-01', '2013-11-17', '2014-02-09', '2014-03-30'], ['2013-01-27', '2013-05-05', '2013-07-21', '2013-09-01', '2013-12-01', '2014-02-16'], ['2013-01-27', '2013-03-31', '2013-05-12', '2013-07-07', '2013-09-01', '2013-11-17', '2014-02-09'], ['2013-02-24', '2013-04-21', '2013-06-09', '2013-08-04', '2013-09-22', '2013-11-03', '2014-01-19', '2014-03-30']], [[1.8966666666666665, 1.97, 2.1119999999999997, 1.8820000000000001, 1.8025, 1.7925, 2.012], [12.8, 9.4, 9.0, 8.0, 9.5, 9.0, 10.8], [0.0033333333333333335, 0.05, 0.156, -0.035, 0.02, 0.05, 0.238], [0.8619999999999999, 2.4, 0.385, 1.755, 0.5675, 1.8559999999999999, 0.6374999999999998, 2.318]], [[1.7775, 1.7925, 1.866, 1.7259999999999998, 1.67, 1.5950000000000002, 1.8860000000000003], [3.75, 3.5, 3.8, 6.4, 4.4, 1.4], [-0.022500000000000003, 0.030000000000000006, -0.07, -0.11399999999999999, -0.052000000000000005, -0.057999999999999996, -0.10500000000000001], [-0.558, -0.050000000000000024, -0.8459999999999999, -0.24000000000000005, -0.8175, -0.518, -0.2866666666666667, 0.578]]], [[['2013-03-24', '2013-06-02', '2013-09-22', '2013-12-29', '2014-03-23'], ['2013-03-10', '2013-06-02', '2013-10-20', '2013-12-29', '2014-03-23'], ['2013-03-24', '2013-06-16', '2013-10-06', '2013-12-29', '2014-03-23'], ['2013-02-10', '2013-04-21', '2013-07-28', '2013-12-15', '2014-03-23']], [['2013-01-27', '2013-05-05', '2013-09-08', '2013-11-17', '2014-02-09'], ['2013-01-27', '2013-05-05', '2013-07-28', '2013-12-01', '2014-02-23'], ['2013-01-27', '2013-05-05', '2013-07-14', '2013-11-17', '2014-02-09'], ['2013-02-24', '2013-06-16', '2013-09-22', '2014-01-26']], [[1.9130000000000003, 2.0922222222222224, 1.7844444444444447, 1.7844444444444447, 1.9649999999999999], [12.4, 8.88888888888889, 8.666666666666666, 8.666666666666666, 10.2], [0.043000000000000003, 0.13900000000000004, 0.007999999999999998, 0.049999999999999996, 0.215], [0.6225, 1.1749999999999998, 0.687, 1.211, 1.9470000000000003]], [[1.8033333333333335, 1.8155555555555556, 1.7549999999999997, 1.6977777777777776, 1.60375], [4.444444444444445, 4.111111111111111, 4.3, 4.7, 2.7], [-0.010000000000000002, -0.05, -0.10399999999999998, -0.04111111111111111, -0.09999999999999999], [-0.54625, -0.8389999999999999, -0.81, -0.185]]], [[['2013-06-30', '2013-12-31'], ['2013-03-31', '2013-10-31', '2014-03-31'], ['2013-06-30', '2014-03-31'], ['2013-04-30', '2013-12-31']], [['2013-04-30', '2013-08-31', '2014-02-28'], ['2013-07-31', '2014-02-28'], ['2013-07-31', '2014-02-28'], ['2013-06-30', '2014-01-31']], [[2.0220000000000002, 1.7771428571428571], [10.523809523809524, 8.5, 9.666666666666666], [0.05500000000000001, 0.16476190476190475], [0.9104545454545453, 1.0580952380952384]], [[1.8913636363636364, 1.7657894736842108, 1.6321052631578947], [4.695652173913044, 4.2105263157894735], [-0.08695652173913046, -0.06052631578947369], [-0.6950000000000001, 0.11473684210526312]]]], ['2014-04-02', 1.93, 1.92, 7.0, 0.09, 1.5150000000000001], "PADINI,TSS,4,1,(c2000100,m0000001,p3001000,v4010000)"),
# DUFU 2016-01-06 replaced 2015-12-30, TSS,1,1
#   ("DUFU", [[[['2014-11-30', '2015-02-08', '2015-04-19', '2015-07-26', '2015-10-25', '2015-12-27'], ['2014-11-09', '2015-02-15', '2015-05-24', '2015-07-26', '2015-09-13', '2015-10-25', '2015-12-06'], ['2014-11-30', '2015-02-08', '2015-04-19', '2015-06-07', '2015-07-26', '2015-09-27', '2015-12-27'], ['2014-11-30', '2015-02-01', '2015-04-19', '2015-07-26', '2015-10-25', '2015-12-13']], [['2014-10-19', '2014-12-21', '2015-03-08', '2015-05-10', '2015-07-05', '2015-08-23', '2015-10-18'], ['2014-10-19', '2014-12-21', '2015-04-12', '2015-06-28', '2015-08-16', '2015-10-04', '2015-11-15', '2015-12-27'], ['2014-10-19', '2015-01-04', '2015-03-08', '2015-07-05', '2015-08-23', '2015-10-18', '2015-12-20'], ['2014-11-02', '2014-12-28', '2015-03-22', '2015-05-31', '2015-08-09', '2015-10-11', '2015-11-29']], [[0.321, 0.3983333333333334, 0.422, 0.344, 0.32599999999999996, 0.5216666666666666], [10.25, 11.4, 8.4, 9.2, 10.4, 8.8, 11.8], [0.34, 0.4666666666666666, 0.21200000000000002, -0.04, 0.122, 0.14250000000000002, 0.3466666666666667], [20.428, 9.654, 2.962, 0.5860000000000001, 2.0679999999999996, 4.683999999999999]], [[0.227, 0.23899999999999996, 0.305, 0.365, 0.288, 0.27, 0.30625], [6.2, 5.8, 5.4, 3.6, 6.4, 7.0, 7.0, 7.666666666666667], [-0.08399999999999999, -0.09500000000000001, -0.10200000000000001, -0.20599999999999996, -0.16, 0.0, 0.23399999999999999], [-0.8650000000000001, -0.91, -0.8099999999999999, -0.8480000000000001, -0.748, -0.542, 1.624]]], [[['2014-12-07', '2015-02-15', '2015-04-26', '2015-08-02'], ['2014-11-23', '2015-02-15', '2015-05-24', '2015-09-13', '2015-12-06'], ['2014-12-07', '2015-02-15', '2015-04-26', '2015-09-27'], ['2014-12-07', '2015-04-26', '2015-07-05', '2015-09-27', '2015-12-20']], [['2014-10-26', '2015-03-15', '2015-08-30'], ['2014-12-21', '2015-04-12', '2015-07-05', '2015-10-11'], ['2014-10-26', '2015-01-04', '2015-03-15', '2015-07-05', '2015-10-25'], ['2015-01-04', '2015-03-15', '2015-05-24', '2015-08-16', '2015-11-08']], [[0.30200000000000005, 0.3775, 0.421, 0.3283333333333333], [9.6, 11.375, 7.8, 10.222222222222221, 11.2], [0.2560000000000001, 0.35625, 0.18699999999999997, 0.125], [15.305000000000001, 1.5290000000000001, 0.16999999999999996, 0.485, 3.283]], [[0.23062500000000002, 0.3275, 0.27199999999999996], [6.1, 5.9, 4.2, 7.1], [-0.07875, -0.095, -0.06200000000000001, -0.19599999999999998, 0.02444444444444445], [-0.90375, -0.683, -0.6769999999999998, -0.611, 0.638]]], [[['2014-11-30', '2015-04-30'], ['2015-01-31', '2015-05-31', '2015-09-30'], ['2015-02-28', '2015-09-30'], ['2014-11-30', '2015-04-30']], [['2014-12-31', '2015-08-31'], ['2014-12-31', '2015-06-30', '2015-10-31'], ['2014-12-31', '2015-06-30', '2015-10-31'], ['2014-12-31', '2015-05-31']], [[0.2652631578947369, 0.3986363636363635], [10.571428571428571, 7.421052631578948, 9.1], [0.24749999999999997, 0.072], [8.008947368421053, 0.9427272727272729]], [[0.2602272727272727, 0.2825000000000001], [6.7272727272727275, 4.954545454545454, 7.9523809523809526], [0.00954545454545456, -0.1359090909090909, 0.04047619047619049], [2.469090909090909, -0.7057894736842105]]]], ['2015-12-30', 0.5, 0.4685, 9.15, 0.2755, 2.6959999999999993], "DUFU,TSS,1,0,(c4010000,m3000000,p4010000,v3000100)"),
# DUFU 2016-01-06, TSS,4,0
# DUFU 2017-10-02 replaced 2017-05-08, TSS,2,1
# KLSE 2018-09-28 TSS,5,1
# KLSE 2015-03-05 replaced 2015-04-01 TSS,5,0 2015-04-28 TSS,5,1 (posM==0)
# KLSE 2015-07-16 TSS,6,0 2015-08-03 TSS,6,1 (bottomC)
@pytest.mark.parametrize("counter,pnlist,lasttxn,expected", [
    ("PADINI", [[[['2011-07-24', '2011-09-04', '2011-10-30', '2012-01-15', '2012-03-18', '2012-06-03', '2012-07-15', '2012-09-02'], ['2011-07-24', '2011-10-30', '2012-01-15', '2012-03-18', '2012-05-06', '2012-07-01', '2012-08-12'], ['2011-07-31', '2011-10-30', '2011-12-11', '2012-02-05', '2012-05-13', '2012-07-01', '2012-08-19'], ['2011-07-24', '2011-09-04', '2011-11-06', '2012-01-29', '2012-04-29', '2012-07-29']], [['2011-07-10', '2011-10-02', '2011-11-13', '2012-01-22', '2012-03-25', '2012-05-20', '2012-07-08'], ['2011-06-26', '2011-08-28', '2011-11-20', '2012-02-26', '2012-04-08', '2012-05-27', '2012-07-29'], ['2011-07-10', '2011-08-28', '2011-11-27', '2012-01-08', '2012-04-08', '2012-06-10', '2012-07-29'], ['2011-07-03', '2011-08-21', '2011-10-09', '2011-12-25', '2012-02-26', '2012-04-15', '2012-07-01', '2012-08-26']], [[1.09, 0.9275, 1.04, 1.158, 1.498, 1.77, 1.9599999999999997, 2.3], [10.2, 10.5, 9.6, 10.2, 10.75, 9.2, 7.8], [0.016, 0.1925, 0.084, 0.18000000000000002, 0.21799999999999997, 0.11200000000000002, 0.174], [0.5519999999999999, 2.065, 3.902, 4.96, 2.696, 0.954]], [[1.052, 0.841, 1.0, 1.1500000000000001, 1.4099999999999997, 1.608, 1.846], [7.6, 3.4, 5.2, 7.4, 6.2, 6.4, 7.4], [-0.046, -0.15000000000000002, 0.026000000000000002, 0.034999999999999996, -0.016, 0.006, 0.04], [-0.798, 0.06, -0.8219999999999998, -0.6719999999999999, 0.22199999999999998, -0.74, -0.6439999999999999, -0.4633333333333334]]], [[['2011-07-31', '2011-11-06', '2012-03-25', '2012-06-03'], ['2011-07-31', '2011-10-23', '2012-01-15', '2012-05-06', '2012-07-15'], ['2011-07-31', '2011-11-06', '2012-02-12', '2012-05-20', '2012-08-26'], ['2011-08-28', '2011-11-06', '2012-01-29', '2012-05-06', '2012-07-29']], [['2011-07-17', '2011-10-09', '2012-04-08', '2012-06-17'], ['2011-08-28', '2011-11-20', '2012-02-26', '2012-06-03'], ['2011-08-28', '2011-12-04', '2012-04-08', '2012-06-17'], ['2011-07-03', '2011-10-09', '2012-04-22', '2012-08-26']], [[1.0870000000000002, 1.0244444444444445, 1.4540000000000002, 1.7169999999999999], [10.2, 9.5, 9.222222222222221, 10.222222222222221, 8.8], [0.01, 0.17777777777777773, 0.1742857142857143, 0.15500000000000003, 0.17375], [1.0370000000000001, 2.3777777777777778, 3.8362499999999997, 1.6, 0.5199999999999999]], [[1.057, 0.8485000000000001, 1.411, 1.7149999999999999], [4.1, 5.222222222222222, 7.8, 6.5], [-0.128, 0.031111111111111114, 0.009000000000000003, 0.026000000000000002], [-0.7419999999999999, -0.6759999999999999, -0.6022222222222221, -0.24124999999999996]]], [[['2012-08-31'], ['2011-07-31', '2012-03-31', '2012-07-31'], ['2011-10-31', '2012-02-29', '2012-08-31'], ['2011-08-31', '2012-01-31', '2012-07-31']], [['2011-09-30'], ['2011-09-30', '2012-04-30'], ['2011-09-30', '2012-04-30'], ['2011-09-30', '2012-06-30']], [[2.2264999999999997], [9.428571428571429, 9.272727272727273, 8.0], [0.087, 0.1411111111111111, 0.15199999999999997], [0.6733333333333333, 2.586842105263158, 0.21863636363636363]], [[0.8926315789473683], [5.315789473684211, 7.75], [-0.10210526315789475, 0.043000000000000003], [-0.3, -0.4828571428571428]]]], ['2012-09-03', 2.2, 2.2, 5.0, 0.08, 0.02], "PADINI,TSS,1,1,(c3001001,m0010000,p0001000,v0000001)"),
    ("PADINI", [[[['2013-04-14', '2013-06-02', '2013-07-14', '2013-09-22', '2013-12-29', '2014-02-16', '2014-04-20'], ['2013-03-03', '2013-04-14', '2013-06-02', '2013-08-25', '2013-10-20', '2013-12-29', '2014-03-16'], ['2013-03-17', '2013-06-02', '2013-08-11', '2013-09-22', '2013-12-22', '2014-03-23', '2014-05-04'], ['2013-03-03', '2013-04-14', '2013-05-26', '2013-08-11', '2013-10-20', '2013-12-01', '2014-02-02', '2014-03-23', '2014-05-04']], [['2013-05-05', '2013-07-07', '2013-09-01', '2013-11-17', '2014-02-09', '2014-03-30'], ['2013-05-05', '2013-07-21', '2013-09-01', '2013-12-01', '2014-02-16', '2014-04-13'], ['2013-03-31', '2013-05-12', '2013-07-07', '2013-09-01', '2013-11-17', '2014-02-09', '2014-04-27'], ['2013-03-17', '2013-06-09', '2013-08-04', '2013-09-22', '2013-11-03', '2014-01-19', '2014-04-27']], [[1.97, 2.1119999999999997, 1.8820000000000001, 1.8025, 1.7925, 1.6179999999999999, 2.0700000000000003], [12.8, 9.4, 9.0, 8.0, 9.5, 9.0, 10.8], [0.05, 0.156, -0.035, 0.02, 0.05, 0.238, 0.0325], [0.018000000000000016, 2.4, 0.385, 1.755, 0.5675, 1.8559999999999999, 0.6374999999999998, 2.318, -0.405]], [[1.7925, 1.866, 1.7259999999999998, 1.67, 1.5950000000000002, 1.8860000000000003], [3.5, 3.8, 6.4, 4.4, 1.4, 6.8], [0.030000000000000006, -0.07, -0.11399999999999999, -0.052000000000000005, -0.057999999999999996, -0.10500000000000001, 0.024], [-0.386, -0.8459999999999999, -0.24000000000000005, -0.8175, -0.518, -0.2866666666666667, -0.458]]], [[['2013-03-24', '2013-06-02', '2013-09-22', '2013-12-29', '2014-04-20'], ['2013-03-10', '2013-06-02', '2013-10-20', '2013-12-29', '2014-03-23'], ['2013-03-24', '2013-06-16', '2013-10-06', '2013-12-29', '2014-03-23'], ['2013-04-21', '2013-07-28', '2013-12-15', '2014-03-23']], [['2013-05-05', '2013-09-08', '2013-11-17', '2014-02-09'], ['2013-05-05', '2013-07-28', '2013-12-01', '2014-02-23'], ['2013-05-05', '2013-07-14', '2013-11-17', '2014-02-09'], ['2013-03-24', '2013-06-16', '2013-09-22', '2014-01-26']], [[1.9130000000000003, 2.0922222222222224, 1.7844444444444447, 1.7844444444444447, 2.032], [12.4, 8.88888888888889, 8.666666666666666, 8.666666666666666, 10.2], [0.043000000000000003, 0.13900000000000004, 0.007999999999999998, 0.049999999999999996, 0.215], [1.1749999999999998, 0.687, 1.211, 1.9470000000000003]], [[1.8155555555555556, 1.7549999999999997, 1.6977777777777776, 1.60375], [4.111111111111111, 4.3, 4.7, 2.7], [-0.05, -0.10399999999999998, -0.04111111111111111, -0.09999999999999999], [-0.356, -0.8389999999999999, -0.81, -0.185]]], [[['2013-06-30', '2013-12-31', '2014-04-30'], ['2013-10-31', '2014-03-31'], ['2013-06-30', '2014-03-31'], ['2013-04-30', '2014-03-31']], [['2013-04-30', '2013-08-31', '2014-02-28'], ['2013-07-31', '2014-02-28'], ['2013-07-31', '2014-02-28'], ['2013-06-30', '2014-01-31']], [[2.0220000000000002, 1.7771428571428571, 2.011818181818182], [8.5, 9.666666666666666], [0.05500000000000001, 0.16476190476190475], [0.9104545454545453, 1.319047619047619]], [[1.8913636363636364, 1.7657894736842108, 1.6321052631578947], [4.695652173913044, 4.2105263157894735], [-0.08695652173913046, -0.06052631578947369], [-0.6950000000000001, 0.11473684210526312]]]], ['2014-05-08', 1.98, 1.9899999999999998, 6.6, 0.016, -0.49799999999999994], "PADINI,TSS,4,1,(c3000001,m0001001,p0001000,v0001000)"),
    ("DUFU", [[[['2014-11-30', '2015-02-08', '2015-04-19', '2015-07-26', '2015-10-25', '2015-12-27'], ['2014-11-09', '2015-02-15', '2015-05-24', '2015-07-26', '2015-09-13', '2015-10-25', '2015-12-06'], ['2014-11-30', '2015-02-08', '2015-04-19', '2015-06-07', '2015-07-26', '2015-09-27', '2015-12-27'], ['2014-11-30', '2015-02-01', '2015-04-19', '2015-07-26', '2015-10-25', '2015-12-13']], [['2014-11-16', '2015-03-08', '2015-05-10', '2015-07-05', '2015-08-23', '2015-10-18', '2016-01-03'], ['2014-12-21', '2015-04-12', '2015-06-28', '2015-08-16', '2015-10-04', '2015-11-15', '2015-12-27'], ['2014-11-09', '2015-01-04', '2015-03-08', '2015-07-05', '2015-08-23', '2015-10-18', '2015-12-20'], ['2014-11-02', '2014-12-28', '2015-03-22', '2015-05-31', '2015-08-09', '2015-10-11', '2015-11-29']], [[0.321, 0.3983333333333334, 0.422, 0.344, 0.32599999999999996, 0.5216666666666666], [10.25, 11.4, 8.4, 9.2, 10.4, 8.8, 11.8], [0.34, 0.4666666666666666, 0.21200000000000002, -0.04, 0.122, 0.14250000000000002, 0.3466666666666667], [20.428, 9.654, 2.962, 0.5860000000000001, 2.0679999999999996, 4.683999999999999]], [[0.22999999999999998, 0.305, 0.365, 0.288, 0.27, 0.30625, 0.5062500000000001], [5.8, 5.4, 3.6, 6.4, 7.0, 7.0, 7.666666666666667], [-0.06, -0.09500000000000001, -0.10200000000000001, -0.20599999999999996, -0.16, 0.0, 0.23399999999999999], [-0.8650000000000001, -0.91, -0.8099999999999999, -0.8480000000000001, -0.748, -0.542, 1.624]]], [[['2014-11-30', '2015-02-08', '2015-04-19', '2015-07-26', '2015-10-04'], ['2014-11-16', '2015-02-08', '2015-05-31', '2015-09-20', '2015-12-13'], ['2014-11-30', '2015-02-08', '2015-04-19', '2015-07-26', '2015-10-04', '2015-12-27'], ['2014-11-30', '2015-02-08', '2015-04-19', '2015-07-26', '2015-10-04', '2015-12-13']], [['2014-11-16', '2015-03-08', '2015-05-17', '2015-08-23'], ['2014-12-28', '2015-04-19', '2015-06-28', '2015-11-15'], ['2014-12-28', '2015-03-22', '2015-06-28', '2015-10-18'], ['2014-11-02', '2015-03-22', '2015-05-31', '2015-08-09', '2015-10-18']], [[0.2925, 0.36437499999999995, 0.4065, 0.3355555555555555, 0.3133333333333333], [10.11111111111111, 11.25, 7.8, 9.88888888888889, 10.9], [0.22400000000000003, 0.38, 0.188, 0.06555555555555556, 0.12222222222222223, 0.27625], [15.744, 8.62875, 2.159, 0.11888888888888888, 0.2644444444444445, 3.225]], [[0.235, 0.32449999999999996, 0.36999999999999994, 0.27749999999999997], [6.222222222222222, 6.3, 3.9, 7.222222222222222], [-0.08888888888888889, -0.019999999999999997, -0.186, 0.026666666666666665], [-0.8200000000000001, -0.7550000000000001, -0.836, -0.6844444444444444, -0.3911111111111112]]], [[['2014-11-30', '2015-04-30'], ['2015-01-31', '2015-05-31', '2015-09-30'], ['2015-02-28', '2015-07-31', '2015-12-31'], ['2014-11-30', '2015-04-30', '2015-12-31']], [['2014-12-31', '2015-08-31'], ['2014-12-31', '2015-06-30', '2015-10-31'], ['2014-12-31', '2015-06-30', '2015-10-31'], ['2014-12-31', '2015-05-31']], [[0.2652631578947369, 0.3986363636363635], [10.571428571428571, 7.421052631578948, 9.1], [0.24749999999999997, -0.025714285714285717, 0.27142857142857146], [8.008947368421053, 0.9427272727272729, 2.5480952380952377]], [[0.2602272727272727, 0.2825000000000001], [6.7272727272727275, 4.954545454545454, 7.9523809523809526], [0.00954545454545456, -0.1359090909090909, 0.04047619047619049], [2.469090909090909, -0.7057894736842105]]]], ['2016-01-06', 0.535, 0.5133333333333333, 7.0, 0.21333333333333335, 0.023333333333333317], "DUFU,TSS,1,1,(c4100000,m0000000,p0001000,v0000001)"),
    ("DUFU", [[[['2016-08-14', '2016-10-02', '2016-12-25', '2017-02-12', '2017-03-26', '2017-05-28', '2017-07-30', '2017-09-10'], ['2016-09-04', '2016-10-30', '2016-12-25', '2017-03-12', '2017-05-21', '2017-08-27'], ['2016-10-02', '2016-12-04', '2017-02-12', '2017-03-26', '2017-05-21', '2017-09-10'], ['2016-07-24', '2016-09-11', '2016-11-27', '2017-01-15', '2017-03-12', '2017-05-07', '2017-07-09', '2017-08-20', '2017-10-01']], [['2016-09-04', '2016-11-06', '2017-01-01', '2017-02-19', '2017-04-02', '2017-06-04', '2017-07-16'], ['2016-08-07', '2016-10-09', '2016-12-11', '2017-01-22', '2017-04-02', '2017-07-02'], ['2016-09-04', '2016-11-06', '2017-01-08', '2017-02-19', '2017-04-30', '2017-07-16', '2017-09-03'], ['2016-07-31', '2016-09-18', '2016-11-06', '2017-01-01', '2017-02-19', '2017-04-23', '2017-07-02', '2017-09-17']], [[0.635, 0.6319999999999999, 0.7, 0.8325, 1.186, 1.5340000000000003, 1.3799999999999997, 1.5225], [7.75, 7.2, 10.4, 9.4, 10.0, 10.4], [0.038000000000000006, 0.17200000000000001, 0.1625, 0.394, 0.32199999999999995, 0.1125], [-0.10400000000000001, -0.184, 3.9259999999999997, 1.134, 3.6759999999999997, 0.595, -0.278, 1.36, -0.44399999999999995]], [[0.59, 0.571, 0.68875, 0.818, 1.094, 1.418, 1.332], [6.6, 5.5, 7.8, 6.8, 5.2, 4.666666666666667], [-0.0675, -0.07, 0.030000000000000002, 0.10399999999999998, 0.0125, -0.098, 0.09999999999999999], [-0.46399999999999997, -0.6566666666666666, -0.728, -0.655, -0.51, -0.788, -0.73, -0.6439999999999999]]], [[['2016-09-25', '2016-12-04', '2017-03-26', '2017-06-18', '2017-09-10'], ['2016-09-11', '2017-01-01', '2017-03-12', '2017-05-21', '2017-08-27'], ['2016-12-04', '2017-03-26', '2017-09-10'], ['2016-08-14', '2016-12-04', '2017-03-12', '2017-06-04', '2017-08-27']], [['2016-11-06', '2017-04-09', '2017-07-16'], ['2016-08-14', '2016-10-23', '2017-01-29', '2017-04-09', '2017-07-02'], ['2016-08-28', '2016-11-06', '2017-04-23', '2017-07-16'], ['2016-08-28', '2016-11-06', '2017-04-23', '2017-07-02', '2017-09-24']], [[0.6181249999999999, 0.6854999999999999, 1.1489999999999998, 1.5022222222222221, 1.5185714285714287], [7.555555555555555, 10.333333333333334, 9.0, 9.666666666666666, 10.3], [0.16499999999999998, 0.36700000000000005, 0.10714285714285714], [-0.20500000000000002, 3.1409999999999996, 2.298, 0.379, 1.0910000000000002]], [[0.5824999999999999, 1.1320000000000001, 1.36], [6.8, 5.7, 7.4, 5.9, 5.625], [-0.049, -0.056999999999999995, 0.042, -0.08299999999999999], [-0.5269999999999999, -0.642, -0.766, -0.72875, -0.5833333333333334]]], [[['2017-06-30'], ['2016-12-31', '2017-08-31'], ['2016-09-30', '2017-03-31', '2017-08-31'], ['2016-11-30', '2017-03-31', '2017-08-31']], [['2016-10-31', '2017-07-31'], ['2016-10-31', '2017-06-30'], ['2016-08-31', '2017-01-31', '2017-07-31'], ['2016-10-31', '2017-04-30']], [[1.4689473684210526], [9.4, 9.045454545454545], [-0.0070000000000000045, 0.29043478260869565, 0.04363636363636363], [1.3154545454545454, 1.5491304347826087, 0.47727272727272735]], [[0.59575, 1.3680952380952383], [6.15, 6.2631578947368425], [-0.03500000000000001, 0.099, -0.06666666666666668], [-0.4495, -0.6784210526315788]]]], ['2017-10-02', 1.35, 1.35, 2.0, -0.1, -0.74], "DUFU,TSS,2,1,(c3000010,m0010000,p0010000,v0010000)"),
    ("KLSE", [[[['2017-07-09', '2017-09-17', '2017-11-12', '2018-02-04', '2018-04-22', '2018-06-10', '2018-09-02'], ['2017-08-13', '2017-10-15', '2018-01-14', '2018-03-25', '2018-06-17', '2018-07-29'], ['2017-08-20', '2017-11-12', '2018-01-14', '2018-02-25', '2018-04-22', '2018-06-17', '2018-08-05', '2018-09-23'], ['2017-08-06', '2017-10-01', '2017-12-03', '2018-02-11', '2018-04-22', '2018-06-03', '2018-07-22', '2018-09-23']], [['2017-07-16', '2017-09-03', '2017-12-03', '2018-02-11', '2018-05-13', '2018-07-01', '2018-08-19'], ['2017-07-23', '2017-10-08', '2017-11-26', '2018-02-25', '2018-05-20', '2018-07-01', '2018-08-26'], ['2017-07-23', '2017-09-03', '2017-10-29', '2018-01-28', '2018-03-11', '2018-05-13', '2018-07-01', '2018-09-16'], ['2017-07-16', '2017-10-15', '2017-12-31', '2018-02-18', '2018-04-08', '2018-05-27', '2018-07-08', '2018-08-26']], [[1765.8739999999998, 1785.274, 1744.9275, 1869.86, 1884.3, 1770.3139999999999, 1819.7], [9.25, 4.0, 9.8, 9.6, 5.0, 12.6], [0.01, -0.0075, 0.05399999999999999, 0.018, 0.014000000000000002, -0.0475, 0.057999999999999996, 0.0075], [-0.142, 0.462, 0.895, 0.5625, 0.08399999999999999, 1.9675, -0.264, 0.5175000000000001]], [[1755.636, 1767.93, 1718.1299999999999, 1830.5049999999999, 1837.355, 1675.4440000000002, 1782.7599999999998], [5.0, 3.2, 3.0, 5.6, 4.0, 2.6, 9.75], [-0.018, 0.0, -0.018, 0.048, 0.0, -0.01, -0.068, 0.0033333333333333335], [-0.30400000000000005, -0.15799999999999997, -0.26, -0.3025, -0.31399999999999995, 0.8220000000000001, -0.522, -0.135]]], [[['2017-09-24', '2018-02-11', '2018-04-22', '2018-09-09'], ['2017-08-27', '2018-01-14', '2018-03-25', '2018-07-29'], ['2017-08-27', '2018-01-14', '2018-04-22', '2018-08-12'], ['2017-09-24', '2017-12-17', '2018-03-11', '2018-06-03', '2018-09-23']], [['2017-07-16', '2017-12-03', '2018-02-25', '2018-07-15'], ['2017-07-30', '2017-12-03', '2018-02-25', '2018-07-01'], ['2017-07-30', '2017-12-03', '2018-04-08', '2018-07-01'], ['2017-07-16', '2017-10-22', '2018-01-28', '2018-04-08', '2018-07-15']], [[1781.2566666666664, 1847.3714285714286, 1874.417, 1810.9311111111112], [9.0, 9.777777777777779, 8.9, 11.6], [0.009, 0.05111111111111111, 0.011000000000000001, 0.05777777777777778], [0.2955555555555555, 0.6839999999999999, -0.054000000000000006, 1.3311111111111111, 0.47285714285714286]], [[1760.7550000000003, 1719.2888888888892, 1847.1611111111108, 1688.2410000000004], [5.2, 3.4444444444444446, 6.0, 3.4], [-0.011999999999999999, -0.014444444444444446, -0.002, -0.06700000000000002], [-0.30399999999999994, -0.11666666666666667, -0.09900000000000002, -0.27799999999999997, -0.47800000000000004]]], [[['2017-09-30', '2018-04-30'], ['2017-08-31', '2018-01-31', '2018-08-31'], ['2017-08-31', '2018-01-31', '2018-08-31'], ['2017-12-31', '2018-05-31']], [['2017-07-31', '2017-11-30', '2018-07-31'], ['2017-11-30', '2018-06-30'], ['2017-10-31', '2018-06-30'], ['2017-07-31', '2018-03-31', '2018-07-31']], [[1774.9394444444447, 1863.1485714285711], [8.380952380952381, 8.571428571428571, 10.3], [0.006190476190476189, 0.050000000000000024, 0.04250000000000001], [0.3463157894736842, 1.0833333333333333]], [[1760.8680952380957, 1729.1942857142858, 1726.722272727273], [3.5238095238095237, 4.2], [-0.013333333333333329, -0.05800000000000002], [-0.22380952380952368, -0.17818181818181822, -0.3281818181818182]]]], ['2018-09-28', 1793.15, 1799.6664705882354, 6.294117647058823, 0.006470588235294117, 0.17647058823529413], "KLSE,TSS,5,1,(c2000110,m0001000,p0000001,v0000110)"),
    ("KLSE", [[[['2014-01-05', '2014-04-13', '2014-05-25', '2014-07-13', '2014-08-24', '2014-10-05', '2014-11-30', '2015-02-08'], ['2014-01-19', '2014-03-02', '2014-04-13', '2014-07-06', '2014-08-24', '2014-11-09', '2015-01-04', '2015-02-15'], ['2014-04-13', '2014-05-25', '2014-09-14', '2014-11-23', '2015-02-22'], ['2014-02-02', '2014-04-06', '2014-06-01', '2014-07-20', '2014-09-07', '2014-10-19', '2014-12-21', '2015-02-08']], [['2014-02-02', '2014-03-23', '2014-05-11', '2014-07-06', '2014-08-17', '2014-10-19', '2014-12-21', '2015-02-15'], ['2014-01-26', '2014-03-23', '2014-06-15', '2014-08-03', '2014-10-19', '2014-12-21', '2015-03-01'], ['2014-02-02', '2014-03-23', '2014-06-08', '2014-08-17', '2014-10-19', '2014-12-21', '2015-02-15'], ['2014-03-09', '2014-05-11', '2014-07-27', '2014-09-28', '2014-11-16', '2015-01-04', '2015-02-22']], [[1856.7925, 1856.628, 1876.47, 1889.205, 1871.72, 1843.2939999999999, 1833.06, 1806.493333333333], [6.0, 10.0, 10.6, 9.0, 9.2, 9.0, 9.5, 5.75], [0.018000000000000002, 0.011666666666666667, 0.0016666666666666668, 0.006, 0.04], [0.8125, 0.26999999999999996, 0.922, -0.21400000000000002, 0.51, 0.426, 0.632, 0.48666666666666664]], [[1788.3475, 1818.39, 1862.1920000000002, 1884.4540000000002, 1855.5149999999999, 1787.3, 1693.818, 1805.6499999999999], [4.4, 7.4, 5.8, 6.25, 4.8, 5.4, 5.4], [-0.0325, 0.0, 0.0, -0.015000000000000001, -0.036000000000000004, -0.07200000000000001, 0.035], [-0.29333333333333333, -0.28400000000000003, -0.3466666666666667, -0.19999999999999998, -0.32199999999999995, -0.2625, -0.3233333333333333]]], [[['2014-03-09', '2014-07-13', '2014-11-16'], ['2014-04-06', '2014-08-24', '2015-01-11'], ['2014-04-20', '2014-07-13', '2014-11-30', '2015-02-22'], ['2014-02-09', '2014-06-01', '2014-09-07', '2015-02-08']], [['2014-02-09', '2014-06-15', '2014-10-19', '2014-12-28'], ['2014-01-26', '2014-06-15', '2014-10-19', '2015-02-22'], ['2014-02-09', '2014-05-18', '2014-08-10', '2014-10-19', '2014-12-28'], ['2014-03-09', '2014-05-18', '2014-07-27', '2014-11-30', '2015-02-22']], [[1830.5245454545452, 1887.045454545455, 1829.3020000000001], [9.7, 8.777777777777779, 8.88888888888889], [0.016000000000000004, 0.00909090909090909, 0.006, 0.037142857142857144], [0.7775000000000001, 0.43818181818181823, 0.39699999999999996, 0.38249999999999995]], [[1790.5737500000002, 1870.2990000000002, 1803.6633333333332, 1719.5966666666666], [5.111111111111111, 6.3, 5.222222222222222, 5.714285714285714], [-0.028749999999999998, 0.007777777777777778, -0.011000000000000001, -0.030000000000000002, -0.05444444444444444], [-0.20272727272727276, -0.22000000000000006, -0.2863636363636364, -0.145, -0.0814285714285714]]], [[['2014-07-31', '2014-11-30'], ['2014-04-30', '2014-08-31', '2015-01-31'], ['2014-04-30', '2014-09-30', '2015-02-28'], ['2014-01-31', '2014-05-31', '2014-10-31']], [['2014-01-31', '2014-12-31'], ['2014-01-31', '2014-06-30', '2014-10-31', '2015-02-28'], ['2014-01-31', '2014-08-31', '2014-12-31'], ['2014-07-31', '2014-11-30']], [[1881.2482608695648, 1826.9495000000002], [9.5, 7.869565217391305, 7.095238095238095], [0.015000000000000003, -0.005909090909090909, 0.03533333333333333], [0.23550000000000004, 0.12190476190476193, 0.2219047619047619]], [[1815.721, 1741.100869565218], [5.15, 6.666666666666667, 5.9523809523809526, 5.6], [-0.0105, -0.008260869565217394, -0.044347826086956525], [-0.24826086956521742, -0.11499999999999999]]]], ['2015-03-05', 1806.09, 1817.5025, 6.25, 0.017499999999999998, -0.0325], "KLSE,TSS,5,1,(c2000100,m0000000,p3001001,v0000000)"),
    ("KLSE", [[[['2014-04-13', '2014-05-25', '2014-07-13', '2014-08-24', '2014-10-05', '2014-11-30', '2015-03-01'], ['2014-01-19', '2014-03-02', '2014-04-13', '2014-07-06', '2014-08-24', '2014-11-09', '2015-01-04', '2015-03-08'], ['2014-04-13', '2014-05-25', '2014-09-14', '2014-11-23', '2015-02-22'], ['2014-02-02', '2014-04-06', '2014-06-01', '2014-07-20', '2014-09-07', '2014-10-19', '2014-12-21', '2015-02-08']], [['2014-02-02', '2014-03-23', '2014-05-11', '2014-07-06', '2014-08-17', '2014-10-19', '2014-12-21', '2015-02-15'], ['2014-01-26', '2014-03-23', '2014-06-15', '2014-08-03', '2014-10-19', '2014-12-21', '2015-03-01'], ['2014-02-02', '2014-03-23', '2014-06-08', '2014-08-17', '2014-10-19', '2014-12-21', '2015-02-15'], ['2014-03-09', '2014-05-11', '2014-07-27', '2014-09-28', '2014-11-16', '2015-01-04', '2015-02-22']], [[1856.628, 1876.47, 1889.205, 1871.72, 1843.2939999999999, 1833.06, 1817.202], [6.0, 10.0, 10.6, 9.0, 9.2, 9.0, 9.5, 6.4], [0.018000000000000002, 0.011666666666666667, 0.0016666666666666668, 0.006, 0.04], [0.8125, 0.26999999999999996, 0.922, -0.21400000000000002, 0.51, 0.426, 0.632, 0.48666666666666664]], [[1788.3475, 1818.39, 1862.1920000000002, 1884.4540000000002, 1855.5149999999999, 1787.3, 1693.818, 1805.6499999999999], [4.4, 7.4, 5.8, 6.25, 4.8, 5.4, 5.4], [-0.0325, 0.0, 0.0, -0.015000000000000001, -0.036000000000000004, -0.07200000000000001, 0.035], [-0.29333333333333333, -0.28400000000000003, -0.3466666666666667, -0.19999999999999998, -0.32199999999999995, -0.2625, -0.3233333333333333]]], [[['2014-03-02', '2014-07-06', '2014-11-09', '2015-03-01'], ['2014-04-13', '2014-08-31', '2015-01-04'], ['2014-04-27', '2014-07-06', '2014-09-14', '2014-11-23', '2015-02-15'], ['2014-02-02', '2014-06-08', '2014-08-31', '2015-02-01']], [['2014-02-02', '2014-06-08', '2014-08-17', '2014-12-21'], ['2014-02-02', '2014-06-22', '2014-10-26', '2015-03-01'], ['2014-02-02', '2014-05-11', '2014-08-17', '2014-12-21'], ['2014-04-27', '2014-08-03', '2014-11-23', '2015-03-01']], [[1829.3020000000001, 1885.9009999999998, 1838.2469999999998, 1814.1075], [10.4, 8.727272727272727, 8.875], [0.016, 0.009999999999999998, 0.001, 0.003, 0.03571428571428571], [0.7155555555555556, 0.584, 0.35545454545454547, 0.36600000000000005]], [[1800.1444444444446, 1868.5729999999999, 1859.1529999999998, 1720.3727272727272], [4.444444444444445, 6.0, 4.888888888888889, 5.5], [-0.024444444444444446, 0.007777777777777778, -0.014000000000000002, -0.058181818181818196], [-0.24500000000000002, -0.27599999999999997, -0.27299999999999996, -0.17125]]], [[['2014-07-31', '2014-11-30'], ['2014-04-30', '2014-08-31', '2015-01-31'], ['2014-04-30', '2014-09-30', '2015-02-28'], ['2014-05-31', '2014-10-31']], [['2014-12-31'], ['2014-06-30', '2014-10-31', '2015-02-28'], ['2014-08-31', '2014-12-31'], ['2014-07-31', '2014-11-30']], [[1881.2482608695648, 1826.9495000000002], [9.5, 7.869565217391305, 7.095238095238095], [0.015000000000000003, -0.005909090909090909, 0.03533333333333333], [0.12190476190476193, 0.2219047619047619]], [[1741.100869565218], [6.666666666666667, 5.9523809523809526, 5.6], [-0.008260869565217394, -0.044347826086956525], [-0.24826086956521742, -0.11499999999999999]]]], ['2015-03-11', 1778.16, 1804.575, 6.25, 0.008749999999999999, -0.03125], "KLSE,TSS,5,2,(c2000100,m0000100,p0001001,v0000010)"),
    ("KLSE", [[[['2014-05-25', '2014-07-13', '2014-08-24', '2014-10-05', '2014-11-30', '2015-03-01', '2015-04-26', '2015-06-28'], ['2014-07-06', '2014-08-24', '2014-11-09', '2015-01-04', '2015-02-15', '2015-04-12', '2015-05-24', '2015-07-05'], ['2014-05-25', '2014-09-14', '2014-11-23', '2015-02-22', '2015-04-26'], ['2014-06-01', '2014-07-20', '2014-09-07', '2014-10-19', '2014-12-21', '2015-02-08', '2015-04-19', '2015-05-31']], [['2014-06-08', '2014-08-17', '2014-10-19', '2014-12-21', '2015-03-15', '2015-05-17', '2015-07-12'], ['2014-06-15', '2014-08-03', '2014-10-19', '2014-12-21', '2015-03-01', '2015-06-14'], ['2014-06-08', '2014-08-17', '2014-10-19', '2014-12-21', '2015-03-15', '2015-06-07'], ['2014-06-15', '2014-07-27', '2014-09-28', '2014-11-16', '2015-01-04', '2015-02-22', '2015-04-12', '2015-06-14']], [[1876.47, 1889.205, 1871.72, 1843.2939999999999, 1833.06, 1817.202, 1854.9779999999998, 1723.716], [9.0, 9.2, 9.0, 9.5, 5.75, 9.0, 4.4, 7.2], [0.011666666666666667, 0.0016666666666666668, 0.006, 0.04, 0.028000000000000004], [0.922, -0.21400000000000002, 0.51, 0.426, 0.632, 0.48666666666666664, -0.033999999999999996, 0.284]], [[1866.7400000000002, 1855.5149999999999, 1787.3, 1693.818, 1785.65, 1804.76, 1708.4599999999998], [5.8, 6.25, 4.8, 5.4, 5.4, 2.6], [0.0, -0.015000000000000001, -0.036000000000000004, -0.07200000000000001, -0.006, -0.05], [-0.052000000000000005, -0.3466666666666667, -0.19999999999999998, -0.32199999999999995, -0.2625, -0.3233333333333333, -0.264, -0.156]]], [[['2014-07-13', '2014-11-16', '2015-05-03'], ['2014-06-01', '2014-08-24', '2015-01-11', '2015-04-19'], ['2014-07-13', '2014-11-30', '2015-02-22'], ['2014-06-01', '2014-09-07', '2015-02-08', '2015-05-31']], [['2014-06-15', '2014-10-19', '2014-12-28', '2015-03-22', '2015-07-12'], ['2014-06-15', '2014-10-19', '2015-03-22', '2015-06-14'], ['2014-08-10', '2014-10-19', '2014-12-28', '2015-03-22', '2015-06-14'], ['2014-07-27', '2014-11-30', '2015-04-05', '2015-06-14']], [[1887.045454545455, 1829.3020000000001, 1850.081111111111], [7.7272727272727275, 8.777777777777779, 8.88888888888889, 8.3], [0.00909090909090909, 0.006, 0.037142857142857144], [0.43818181818181823, 0.39699999999999996, 0.38249999999999995, 0.14500000000000002]], [[1870.2990000000002, 1803.6633333333332, 1719.5966666666666, 1790.7010000000002, 1713.6940000000002], [6.3, 5.222222222222222, 5.6, 2.9], [-0.011000000000000001, -0.030000000000000002, -0.05444444444444444, -0.005, -0.047999999999999994], [-0.2863636363636364, -0.145, -0.194, -0.06499999999999999]]], [[['2014-07-31', '2014-11-30', '2015-04-30'], ['2014-08-31', '2015-04-30'], ['2014-09-30', '2015-02-28'], ['2014-10-31', '2015-05-31']], [['2014-12-31'], ['2014-06-30', '2014-10-31', '2015-05-31'], ['2014-08-31', '2014-12-31', '2015-06-30'], ['2014-07-31', '2014-11-30', '2015-04-30']], [[1881.2482608695648, 1826.9495000000002, 1845.5731818181814], [7.869565217391305, 7.590909090909091], [-0.005909090909090909, 0.03533333333333333], [0.2219047619047619, 0.09722222222222222]], [[1741.100869565218], [6.666666666666667, 5.9523809523809526, 4.333333333333333], [-0.008260869565217394, -0.044347826086956525, -0.04136363636363637], [-0.24826086956521742, -0.11499999999999999, -0.11999999999999998]]]], ['2015-07-16', 1726.73, 1719.1316666666664, 7.416666666666667, -0.010833333333333334, -0.1375], "KLSE,TSS,6,1,(c0010000,m0000100,p0000010,v0000000)"),
    ("KLSE", [[[['2014-07-13', '2014-08-24', '2014-10-05', '2014-11-30', '2015-03-01', '2015-04-26', '2015-07-26'], ['2014-07-06', '2014-08-24', '2014-11-09', '2015-01-04', '2015-02-15', '2015-04-12', '2015-05-24', '2015-07-19'], ['2014-06-29', '2014-09-14', '2014-11-23', '2015-02-22', '2015-04-26', '2015-07-26'], ['2014-06-22', '2014-09-07', '2014-10-19', '2014-12-21', '2015-02-08', '2015-04-19', '2015-05-31', '2015-08-02']], [['2014-06-08', '2014-08-17', '2014-10-19', '2014-12-21', '2015-03-15', '2015-06-21', '2015-08-02'], ['2014-06-15', '2014-08-03', '2014-10-19', '2014-12-21', '2015-03-01', '2015-06-14', '2015-08-02'], ['2014-06-08', '2014-08-17', '2014-10-19', '2014-12-21', '2015-03-15', '2015-06-07', '2015-08-02'], ['2014-06-15', '2014-07-27', '2014-09-28', '2014-11-16', '2015-01-04', '2015-02-22', '2015-04-12', '2015-06-14', '2015-07-26']], [[1889.205, 1871.72, 1843.2939999999999, 1833.06, 1817.202, 1854.9779999999998, 1726.6100000000001], [9.0, 9.2, 9.0, 9.5, 5.75, 9.0, 4.4, 7.75], [0.01, 0.0016666666666666668, 0.006, 0.04, 0.028000000000000004, 0.002], [-0.046, 0.51, 0.426, 0.632, 0.48666666666666664, -0.033999999999999996, 0.284, -0.09000000000000001]], [[1866.7400000000002, 1855.5149999999999, 1787.3, 1693.818, 1785.65, 1722.23, 1706.3020000000001], [5.8, 6.25, 4.8, 5.4, 5.4, 2.6, 6.4], [0.0, -0.015000000000000001, -0.036000000000000004, -0.07200000000000001, -0.006, -0.05, -0.008], [-0.052000000000000005, -0.3466666666666667, -0.19999999999999998, -0.32199999999999995, -0.2625, -0.3233333333333333, -0.264, -0.156, -0.24000000000000005]]], [[['2014-07-13', '2014-11-16', '2015-05-03', '2015-07-26'], ['2014-08-24', '2015-01-11', '2015-04-19', '2015-07-26'], ['2014-07-13', '2014-11-30', '2015-02-22', '2015-07-26'], ['2014-09-07', '2015-02-08', '2015-05-31']], [['2014-06-15', '2014-10-19', '2014-12-28', '2015-03-22', '2015-07-12'], ['2014-06-15', '2014-10-19', '2015-03-22', '2015-06-14'], ['2014-08-10', '2014-10-19', '2014-12-28', '2015-03-22', '2015-06-14'], ['2014-07-27', '2014-11-30', '2015-04-05', '2015-07-26']], [[1887.045454545455, 1829.3020000000001, 1850.081111111111, 1724.916666666667], [8.777777777777779, 8.88888888888889, 8.3, 7.666666666666667], [0.00909090909090909, 0.006, 0.037142857142857144, -0.0011111111111111111], [0.39699999999999996, 0.38249999999999995, 0.14500000000000002]], [[1870.2990000000002, 1803.6633333333332, 1719.5966666666666, 1790.7010000000002, 1713.6940000000002], [6.3, 5.222222222222222, 5.6, 2.9], [-0.011000000000000001, -0.030000000000000002, -0.05444444444444444, -0.005, -0.047999999999999994], [-0.2863636363636364, -0.145, -0.194, -0.21333333333333332]]], [[['2014-07-31', '2014-11-30', '2015-04-30'], ['2014-08-31', '2015-04-30'], ['2014-09-30', '2015-02-28'], ['2014-10-31', '2015-05-31']], [['2014-12-31', '2015-07-31'], ['2014-06-30', '2014-10-31', '2015-05-31'], ['2014-08-31', '2014-12-31', '2015-06-30'], ['2014-07-31', '2014-11-30', '2015-04-30']], [[1881.2482608695648, 1826.9495000000002, 1845.5731818181814], [7.869565217391305, 7.590909090909091], [-0.005909090909090909, 0.03533333333333333], [0.2219047619047619, 0.09722222222222222]], [[1741.100869565218, 1717.9154545454542], [6.666666666666667, 5.9523809523809526, 4.333333333333333], [-0.008260869565217394, -0.044347826086956525, -0.04136363636363637], [-0.24826086956521742, -0.11499999999999999, -0.11999999999999998]]]], ['2015-08-03', 1744.19, 1744.19, 7.0, 0.02, -0.4], "KLSE,TSS,6,1,(c1000100,m0000100,p3000010,v0010000)"),
])
@pytest.mark.tss
def test_top_success(counter, pnlist, lasttxn, expected):
    result = scanSignals(0, counter, "", pnlist, lasttxn)
    assert result.replace('\t', '') == expected, "*** Input = " + counter + "," + lasttxn[0]


# DUFU 2014-06-17 prevbottomM
# DUFU 2014-09-10 TSS if without prevbottomC check
@pytest.mark.parametrize("counter,pnlist,lasttxn,expected", [
    ("DUFU", [[[['2013-05-26', '2013-07-14', '2013-09-29', '2013-11-17', '2014-01-05', '2014-02-16', '2014-05-18'], ['2013-07-14', '2013-09-22', '2013-12-01', '2014-01-19', '2014-03-30', '2014-05-18'], ['2013-06-09', '2013-07-28', '2013-09-08', '2013-10-27', '2014-01-19', '2014-03-02', '2014-05-18'], ['2013-05-26', '2013-07-21', '2013-10-13', '2014-01-19', '2014-04-06', '2014-06-15']], [['2013-05-05', '2013-06-30', '2013-09-15', '2013-12-15', '2014-02-02', '2014-04-20', '2014-06-08'], ['2013-05-19', '2013-06-30', '2013-10-06', '2013-12-08', '2014-02-09', '2014-04-13', '2014-06-08'], ['2013-05-05', '2013-06-30', '2013-09-15', '2013-12-15', '2014-02-09', '2014-04-06', '2014-06-08'], ['2013-04-07', '2013-07-14', '2013-09-08', '2013-11-10', '2013-12-22', '2014-03-16', '2014-06-08']], [[0.23625, 0.21200000000000002, 0.197, 0.20600000000000002, 0.1975, 0.195, 0.21375], [10.4, 11.0, 11.2, 12.666666666666666, 12.333333333333334, 10.5], [0.022000000000000002, 0.0, -0.054000000000000006, 0.06000000000000001, 0.006666666666666667, 0.004000000000000001, 0.14500000000000002], [3.515, 3.4379999999999997, 37.116, 3.046666666666667, 2.84, 4.618]], [[0.2125, 0.205, 0.1875, 0.194, 0.19, 0.186, 0.20800000000000002], [3.75, 7.2, 8.0, 10.2, 9.5, 11.6, 8.4], [-0.1775, -0.10999999999999999, -0.0725, -0.054000000000000006, -0.025, -0.042, 0.06799999999999999], [-0.736, -0.164, -0.8620000000000001, -0.75, -0.898, -0.6875, -0.8]]], [[['2013-06-02', '2013-08-25', '2013-11-17', '2014-02-23'], ['2013-07-14', '2013-09-22', '2014-01-12', '2014-04-06'], ['2013-06-16', '2013-11-03', '2014-01-26', '2014-06-01'], ['2013-03-24', '2013-07-28', '2013-10-20', '2014-01-26', '2014-04-06', '2014-06-15']], [['2013-06-30', '2013-09-22', '2013-12-29', '2014-04-06'], ['2013-05-19', '2013-08-11', '2013-10-20', '2014-02-09', '2014-06-15'], ['2013-05-05', '2013-09-08', '2013-12-15', '2014-04-06', '2014-06-15'], ['2013-04-07', '2013-09-08', '2013-12-29', '2014-03-23', '2014-06-01']], [[0.2327777777777778, 0.20166666666666666, 0.20500000000000002, 0.19500000000000003], [9.8, 10.625, 12.555555555555555, 12.125], [0.0010000000000000015, 0.06000000000000001, 0.0025, 0.12500000000000003], [-0.21100000000000002, 2.2369999999999997, 21.60888888888889, 2.02875, 1.5525, 1.909]], [[0.20750000000000002, 0.19, 0.1942857142857143, 0.18625000000000003], [4.0, 7.571428571428571, 8.666666666666666, 9.666666666666666, 9.1], [-0.16, -0.06300000000000001, -0.046, -0.04125, 0.07899999999999999], [-0.54875, -0.8240000000000001, -0.8228571428571428, -0.5875, 0.09899999999999998]]], [[['2013-11-30'], ['2013-09-30', '2014-01-31'], ['2013-10-31', '2014-05-31'], ['2013-05-31', '2013-10-31', '2014-04-30']], [['2013-09-30', '2014-04-30'], ['2013-05-31', '2013-10-31', '2014-02-28'], ['2013-04-30', '2013-08-31', '2013-12-31'], ['2013-04-30', '2013-08-31', '2013-12-31', '2014-05-31']], [[0.20325000000000007], [10.38888888888889, 11.764705882352942], [0.041904761904761924, 0.10450000000000001], [1.6010000000000002, 9.526190476190475, 1.398181818181818]], [[0.1927777777777778, 0.18795454545454549], [5.45, 8.952380952380953, 10.421052631578947], [-0.09333333333333332, -0.04833333333333334, -0.04157894736842107], [-0.3538888888888889, -0.5650000000000001, -0.7699999999999999, 0.6945000000000002]]]], ['2014-06-17', 0.24, 0.21791666666666668, 9.416666666666666, 0.08749999999999998, 1.7300000000000002], "DUFU,Dbg,0,0,(c4010100,m0000010,p3001000,v3000000)"),
    ("DUFU", [[[['2013-07-14', '2013-09-29', '2013-11-17', '2014-01-05', '2014-02-16', '2014-06-22', '2014-08-10'], ['2013-07-14', '2013-09-22', '2013-12-01', '2014-01-19', '2014-03-30', '2014-06-22', '2014-08-10'], ['2013-07-28', '2013-09-08', '2013-10-27', '2014-01-19', '2014-03-02', '2014-06-22', '2014-08-10'], ['2013-07-21', '2013-10-13', '2014-01-19', '2014-04-06', '2014-06-15', '2014-08-10']], [['2013-06-30', '2013-09-15', '2013-12-15', '2014-02-02', '2014-04-20', '2014-06-08'], ['2013-06-30', '2013-10-06', '2013-12-08', '2014-02-09', '2014-04-13', '2014-06-08', '2014-09-07'], ['2013-06-30', '2013-09-15', '2013-12-15', '2014-02-09', '2014-04-06', '2014-06-08', '2014-08-03'], ['2013-07-14', '2013-09-08', '2013-11-10', '2013-12-22', '2014-03-16', '2014-06-08', '2014-08-31']], [[0.21200000000000002, 0.197, 0.20600000000000002, 0.1975, 0.195, 0.24299999999999997, 0.292], [10.4, 11.0, 11.2, 12.666666666666666, 12.333333333333334, 11.6, 7.8], [0.0, -0.054000000000000006, 0.06000000000000001, 0.006666666666666667, 0.004000000000000001, 0.156, 0.22000000000000003], [3.4379999999999997, 37.116, 3.046666666666667, 2.84, 4.618, 0.6259999999999999]], [[0.205, 0.1875, 0.194, 0.19, 0.186, 0.20800000000000002], [7.2, 8.0, 10.2, 9.5, 11.6, 8.4, 5.5], [-0.10999999999999999, -0.0725, -0.054000000000000006, -0.025, -0.042, 0.06799999999999999, 0.17666666666666667], [-0.164, -0.8620000000000001, -0.75, -0.898, -0.6875, -0.8, -0.8240000000000001]]], [[['2013-07-21', '2013-11-24', '2014-03-02', '2014-05-25', '2014-08-17'], ['2013-09-15', '2014-01-19', '2014-04-27', '2014-08-17'], ['2013-08-04', '2013-10-27', '2014-03-02', '2014-05-25', '2014-08-17'], ['2013-07-21', '2013-10-13', '2014-01-19', '2014-04-13', '2014-06-22']], [['2013-07-07', '2013-09-15', '2013-12-22', '2014-04-13'], ['2013-08-18', '2013-11-10', '2014-02-16', '2014-08-03'], ['2013-07-07', '2013-09-15', '2013-12-22', '2014-03-30', '2014-06-08'], ['2013-07-07', '2013-09-15', '2013-12-22', '2014-03-30', '2014-06-08', '2014-08-31']], [[0.21000000000000002, 0.20500000000000002, 0.1945, 0.21333333333333335, 0.2885000000000001], [10.555555555555555, 12.625, 11.9, 7.5], [-0.0044444444444444444, 0.060000000000000005, -1.7347234759768072e-19, 0.14, 0.18899999999999997], [1.6369999999999998, 23.681250000000002, 1.4837500000000001, 1.9499999999999997, 3.585]], [[0.2065, 0.19055555555555556, 0.194, 0.1865], [7.875, 9.11111111111111, 9.666666666666666, 7.0], [-0.097, -0.062222222222222213, -0.051000000000000004, -0.03428571428571429, 0.091], [0.6, -0.7733333333333334, -0.883, -0.5328571428571428, -0.58, -0.792]]], [[['2013-11-30', '2014-08-31'], ['2013-09-30', '2014-01-31', '2014-06-30'], ['2013-10-31', '2014-02-28', '2014-07-31'], ['2013-10-31', '2014-06-30']], [['2013-09-30', '2014-04-30'], ['2013-08-31', '2014-05-31'], ['2013-08-31', '2013-12-31'], ['2013-08-31', '2013-12-31', '2014-05-31']], [[0.20325000000000007, 0.2769047619047618], [10.38888888888889, 11.764705882352942, 10.19047619047619], [0.041904761904761924, -0.006315789473684211, 0.14], [9.526190476190475, 2.163333333333333]], [[0.1927777777777778, 0.18795454545454549], [8.777777777777779, 9.85], [-0.04833333333333334, -0.04157894736842107], [-0.5650000000000001, -0.7699999999999999, 0.6945000000000002]]]], ['2014-09-10', 0.245, 0.24500000000000005, 5.714285714285714, -0.1457142857142857, -0.6814285714285714], "DUFU,Dbg,0,0,(c3001001,m0100000,p0101000,v0000000)"),
])
@pytest.mark.skip
def test_top_fail(counter, pnlist, lasttxn, expected):
    result = scanSignals(1, counter, "", pnlist, lasttxn)
    assert result.replace('\t', '') == expected, "*** Input = " + counter + "," + lasttxn[0]


# CARLSBG 2017-05-04 RTR,-1,1
# KESM 2017-08-09 RTR,-3,1
# PETRONM 2017-12-04 replaced 2018-01-02 RTR,-3,-1 final leg of rebound before reversal
@pytest.mark.parametrize("counter,pnlist,lasttxn,expected", [
    ("CARLSBG", [[[['2016-04-03', '2016-06-12', '2016-08-21', '2016-10-09', '2016-11-27', '2017-01-15', '2017-02-26', '2017-04-09'], ['2016-02-28', '2016-05-01', '2016-07-17', '2016-10-16', '2016-11-27', '2017-01-15', '2017-02-26', '2017-04-09'], ['2016-03-27', '2016-06-12', '2016-07-24', '2016-10-30', '2017-01-15', '2017-02-26', '2017-04-09'], ['2016-03-06', '2016-05-15', '2016-07-10', '2016-08-28', '2016-10-23', '2016-12-04', '2017-01-22', '2017-03-26']], [['2016-05-08', '2016-07-03', '2016-09-25', '2016-12-04', '2017-02-05', '2017-04-23'], ['2016-03-13', '2016-05-08', '2016-06-26', '2016-08-07', '2016-09-18', '2016-11-20', '2017-02-05', '2017-03-19'], ['2016-03-20', '2016-05-08', '2016-07-03', '2016-09-25', '2016-12-04', '2017-01-29', '2017-03-12'], ['2016-04-03', '2016-07-03', '2016-09-11', '2016-10-30', '2017-01-01', '2017-02-19', '2017-04-02']], [[13.996, 13.392000000000001, 15.164000000000001, 14.770000000000001, 14.34, 13.991999999999999, 14.5, 15.088], [9.4, 5.0, 11.8, 8.4, 6.0, 7.4, 8.8, 12.0], [0.134, 0.04, 0.11199999999999999, 0.014000000000000002, 0.006, 0.036, 0.05], [0.696, 0.858, 1.7033333333333334, -0.20800000000000002, 0.6799999999999999, 2.7860000000000005, 1.542, -0.48200000000000004]], [[12.595, 13.136000000000001, 14.3, 13.848000000000003, 13.966666666666669, 14.963999999999999], [8.4, 3.5, 7.75, 6.6, 7.0, 3.0, 4.666666666666667, 6.2], [0.128, -0.09, -0.004, -0.05, -0.048, 0.0, 0.022], [-0.458, -0.8039999999999999, -0.752, -0.33199999999999996, -0.685, 0.45999999999999996, -0.7825]]], [[['2016-04-03', '2016-06-12', '2016-08-21', '2016-10-30', '2017-01-22', '2017-04-16'], ['2016-03-06', '2016-07-24', '2016-10-16', '2017-01-22', '2017-04-16'], ['2016-03-20', '2016-07-24', '2016-10-30', '2017-01-22', '2017-04-16'], ['2016-05-15', '2016-07-24', '2016-12-11', '2017-03-05']], [['2016-05-15', '2016-10-02', '2016-12-11', '2017-03-19'], ['2016-05-15', '2016-08-07', '2016-12-25', '2017-03-19'], ['2016-05-15', '2016-10-02', '2016-12-11', '2017-03-19'], ['2016-06-12', '2016-09-18', '2017-01-08', '2017-04-02']], [[13.884, 13.315999999999999, 15.097999999999999, 14.675999999999998, 13.984, 15.043999999999997], [9.2, 11.2, 8.333333333333334, 6.9, 11.5], [0.12999999999999998, 0.10400000000000001, 0.008999999999999998, 0.003, 0.04499999999999999], [0.42777777777777776, 0.8329999999999999, 1.4680000000000004, 0.976]], [[12.68888888888889, 14.409999999999997, 13.890000000000004, 14.39], [4.0, 7.0, 4.111111111111111, 6.5], [-0.0811111111111111, -0.042, -0.039, 0.023], [-0.5860000000000001, -0.5637500000000001, -0.685, -0.6155555555555555]]], [[['2016-04-30', '2016-08-31', '2017-04-30'], ['2016-07-31', '2017-04-30'], ['2016-03-31', '2016-07-31', '2017-04-30'], ['2016-07-31', '2017-02-28']], [['2016-05-31', '2016-12-31'], ['2016-05-31', '2016-11-30'], ['2016-05-31', '2016-11-30'], ['2016-06-30', '2017-03-31']], [[13.730476190476192, 14.93181818181818, 15.026315789473685], [10.052631578947368, 10.157894736842104], [0.12347826086956522, 0.08894736842105265, 0.034736842105263156], [0.6436842105263157, 0.9888888888888889]], [[12.91047619047619, 13.922000000000002], [4.9523809523809526, 4.681818181818182], [-0.05571428571428573, -0.02681818181818182], [-0.4614285714285714, -0.3027272727272728]]]], ['2017-05-04', 14.44, 14.706666666666665, 6.666666666666667, -0.01333333333333333, 1.4600000000000002], "CARLSBG,RTR,-1,1,(c3001000,m0001001,p0000000,v4100000)"),
    ("KESM", [[[['2016-07-10', '2016-09-04', '2016-12-04', '2017-01-29', '2017-04-09', '2017-07-16'], ['2016-07-24', '2016-09-04', '2016-10-16', '2017-01-08', '2017-04-09', '2017-05-21', '2017-07-02'], ['2016-07-10', '2016-08-21', '2016-10-30', '2016-12-11', '2017-01-29', '2017-04-09', '2017-06-11'], ['2016-06-12', '2016-08-21', '2016-10-16', '2016-11-27', '2017-01-08', '2017-02-19', '2017-04-16', '2017-06-11']], [['2016-05-29', '2016-07-17', '2016-09-18', '2016-11-13', '2017-02-19', '2017-04-23', '2017-06-25'], ['2016-06-05', '2016-07-31', '2016-09-18', '2016-11-13', '2017-02-19', '2017-04-30', '2017-07-30'], ['2016-05-29', '2016-07-17', '2016-10-02', '2016-11-27', '2017-01-08', '2017-03-05', '2017-05-07', '2017-06-25'], ['2016-06-19', '2016-07-31', '2016-09-11', '2016-10-30', '2017-01-01', '2017-02-12', '2017-04-09', '2017-05-28', '2017-07-23']], [[5.63, 7.91, 9.842, 10.212, 12.527999999999999, 16.140000000000004], [10.4, 9.0, 11.4, 11.5, 10.8, 11.8, 11.0], [0.24333333333333332, 0.32799999999999996, 0.24, 0.062, 0.04, 0.238, 0.156], [8.212, 0.8719999999999999, 0.8540000000000001, -0.382, 0.42750000000000005, 0.8979999999999999, 0.168, 1.4499999999999997]], [[4.106, 5.612, 7.7, 8.978, 9.690000000000001, 12.171999999999999, 14.952000000000002], [4.8, 9.8, 5.0, 6.0, 7.6, 7.25, 3.0], [-0.024, 0.17600000000000002, 0.008, 0.018, 0.0175, -0.03, 0.0575, 0.11399999999999999], [3.06, -0.324, -0.788, -0.686, -0.7, -0.83, -0.092, -0.5700000000000001, -0.674]]], [[['2016-11-06', '2017-02-12', '2017-07-30'], ['2016-07-31', '2016-10-23', '2017-01-15', '2017-05-21'], ['2016-08-28', '2016-11-06', '2017-01-29', '2017-04-09', '2017-06-18'], ['2016-06-19', '2016-10-23', '2017-01-15', '2017-03-26', '2017-06-18']], [['2016-06-05', '2016-09-25', '2017-02-26'], ['2016-06-05', '2016-09-25', '2016-12-18', '2017-02-26', '2017-05-07'], ['2016-06-05', '2016-10-09', '2017-02-26', '2017-05-07'], ['2016-09-11', '2017-02-12', '2017-05-07', '2017-07-30']], [[9.592, 10.151428571428571, 15.998000000000001], [10.1, 11.3, 10.222222222222221, 11.444444444444445], [0.282, 0.215, 0.03, 0.215, 0.14888888888888893], [5.636, 0.4619999999999999, 0.18000000000000005, 0.38700000000000007, 1.1288888888888886]], [[4.157, 7.8, 9.738], [5.4, 5.875, 8.444444444444445, 7.6, 7.625], [-0.012000000000000002, 0.008888888888888889, -0.028000000000000004, 0.065], [-0.5744444444444444, -0.7314285714285713, -0.1925, -0.554]]], [[['2017-01-31', '2017-07-31'], ['2016-10-31', '2017-06-30'], ['2016-08-31', '2017-04-30'], ['2016-06-30', '2016-10-31', '2017-06-30']], [['2017-02-28'], ['2016-09-30', '2017-02-28'], ['2016-09-30', '2017-02-28'], ['2016-12-31', '2017-07-31']], [[10.053999999999998, 15.97904761904762], [10.65, 10.368421052631579], [0.2490909090909091, 0.13999999999999999], [5.311904761904762, 0.02649999999999996, 0.9215789473684212]], [[9.874444444444444], [6.85, 7.944444444444445], [0.08400000000000005, -0.012222222222222225], [-0.5229999999999999, -0.515238095238095]]]], ['2017-08-09', 14.36, 15.14857142857143, 3.5714285714285716, -0.037142857142857144, 0.6271428571428571], "KESM,RTR,-3,1,(c3001001,m0010000,p0010000,v0000000)"),
    ("PETRONM", [[[['2016-10-23', '2017-03-05', '2017-05-21', '2017-08-06', '2017-09-24', '2017-11-12'], ['2016-10-23', '2016-12-04', '2017-02-19', '2017-05-14', '2017-06-25', '2017-08-06', '2017-09-24', '2017-11-26'], ['2016-10-23', '2016-12-18', '2017-03-05', '2017-05-21', '2017-08-06', '2017-10-15'], ['2016-10-09', '2016-12-11', '2017-02-26', '2017-05-28', '2017-08-13', '2017-10-08', '2017-11-26']], [['2016-10-02', '2016-12-25', '2017-03-26', '2017-07-02', '2017-09-03', '2017-10-22'], ['2016-09-25', '2016-11-13', '2016-12-25', '2017-03-26', '2017-07-02', '2017-09-03', '2017-11-05'], ['2016-10-02', '2016-11-20', '2017-01-15', '2017-04-09', '2017-07-02', '2017-09-03', '2017-11-05'], ['2016-11-20', '2017-01-01', '2017-03-26', '2017-05-21', '2017-07-02', '2017-08-27', '2017-10-22', '2017-12-03']], [[4.41, 6.220000000000001, 8.648, 9.23, 10.305, 12.336], [9.8, 8.4, 11.8, 11.75, 4.8, 8.6, 7.75, 7.2], [0.076, 0.0, 0.418, 0.346, 0.22000000000000003, 0.196], [0.6525, 0.538, 24.059999999999995, 2.2540000000000004, 1.754, 0.8059999999999998, 1.544]], [[4.018, 4.1080000000000005, 5.795999999999999, 7.260000000000001, 8.590000000000002, 11.22], [4.0, 6.4, 6.2, 3.4, 4.333333333333333, 4.0, 4.0], [-0.055999999999999994, -0.032, -0.016, 0.066, -0.14333333333333334, -0.03, 0.096], [-0.748, -0.6975, -0.836, 1.082, -0.65, -0.168, -0.74, 1.475]]], [[['2016-10-30', '2017-05-28', '2017-08-20', '2017-11-26'], ['2016-10-30', '2017-02-19', '2017-05-14', '2017-08-06', '2017-11-26'], ['2016-10-30', '2017-03-05', '2017-05-28', '2017-08-06', '2017-10-15'], ['2016-10-16', '2017-03-05', '2017-05-28', '2017-08-20']], [['2016-10-02', '2016-12-25', '2017-07-09'], ['2016-10-02', '2017-01-08', '2017-04-02', '2017-06-25', '2017-09-03', '2017-11-12'], ['2016-10-02', '2017-01-08', '2017-04-16', '2017-07-09'], ['2017-01-08', '2017-04-16', '2017-07-09', '2017-10-29']], [[4.342, 8.629999999999999, 9.138000000000002, 12.093999999999998], [9.2, 11.666666666666666, 11.375, 8.0, 6.6], [0.06400000000000002, 0.31799999999999995, 0.33199999999999996, 0.165, 0.19099999999999998], [0.3066666666666667, 13.088999999999999, 1.668, 1.091]], [[4.029999999999999, 4.141111111111111, 7.5825000000000005], [4.4, 6.375, 3.7, 4.666666666666667, 4.5, 5.3], [-0.041999999999999996, -0.014999999999999998, 0.071, -0.09875000000000003], [-0.5175, -0.579, -0.46749999999999997, -0.6477777777777778]]], [[['2017-05-31', '2017-11-30'], ['2016-10-31', '2017-02-28', '2017-07-31', '2017-11-30'], ['2016-10-31', '2017-05-31', '2017-10-31'], ['2016-10-31', '2017-02-28', '2017-08-31']], [['2016-12-31', '2017-06-30'], ['2016-11-30', '2017-03-31', '2017-10-31'], ['2016-12-31', '2017-06-30'], ['2016-11-30', '2017-04-30', '2017-10-31']], [[8.156666666666666, 12.056363636363637], [8.25, 10.666666666666666, 7.142857142857143, 6.045454545454546], [0.039000000000000014, 0.2671428571428572, 0.15571428571428572], [0.23999999999999994, 8.432777777777778, 0.7681818181818183]], [[4.1530000000000005, 7.897368421052632], [7.136363636363637, 4.478260869565218, 5.857142857142857], [-0.011000000000000001, -0.00578947368421053], [-0.33454545454545453, -0.5610526315789472, -0.3119047619047619]]]], ['2017-12-04', 11.24, 11.24, 4.0, -0.05, 3.04], "PETRONM,RTL,-3,-1,(c3001000,m0010000,p0010000,v3000000)"),
])
@pytest.mark.tss
def test_retrace_success(counter, pnlist, lasttxn, expected):
    result = scanSignals(0, counter, "", pnlist, lasttxn)
    assert result.replace('\t', '') == expected, "*** Input = " + counter + "," + lasttxn[0]
